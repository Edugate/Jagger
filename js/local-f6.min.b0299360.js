function nl2br(e,t){"use strict";var a=t||"undefined"==typeof t?"<br />":"<br>";return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+a+"$2")}function revealAlert(e,t){"use strict";var a='<div class="row text-right"><button class="button" data-close>'+t+"</button></div>",i=$("#malert");i.empty().append('<div class="row text-center"><p><h4>'+e+"</h4></p></div>").append(a).foundation("open")}function go_to_private_page(){window.location.reload()}function mapInitialize(){window.console.log("map init");var e=[],t={zoom:4,center:new google.maps.LatLng(50.019036,13.007813),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DEFAULT}};map=new google.maps.Map(document.getElementById("map-canvas"),t),google.maps.event.addListener(map,"click",function(e){$("#latlng").val(e.latLng.lat().toFixed(6)+","+e.latLng.lng().toFixed(6))}),mapSearchInput=document.getElementById("map-search"),map.controls[google.maps.ControlPosition.TOP_LEFT].push(mapSearchInput);var a=new google.maps.places.SearchBox(mapSearchInput);google.maps.event.addListener(a,"places_changed",function(){var t=a.getPlaces();if(0!==t.length){for(var i,n=0;i=e[n];n++)i.setMap(null);e=[];for(var s,r=new google.maps.LatLngBounds,o=0;s=t[o];o++){var l={url:s.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};i=new google.maps.Marker({map:map,icon:l,title:s.name,position:s.geometry.location}),e.push(i),r.extend(s.geometry.location)}map.fitBounds(r);var d=google.maps.event.addListener(map,"idle",function(){map.getZoom()>16&&map.setZoom(16),google.maps.event.removeListener(d)})}}),google.maps.event.addListener(map,"bounds_changed",function(){var e=map.getBounds();a.setBounds(e)})}$.fn.dataTable.ext.search.push(function(e,t,a){var i=$("#entityc").val(),n=t[0];return void 0===i||""===i||"1"===n&&"local"===i||"0"===n&&"external"===i}),function(){var e;e=this.jQuery,e.fn.extend({confirmWithReveal:function(t){var a,i,n,s;return null===t&&(t={}),a={modal_class:"small",title:"Are you sure?",title_class:"",body:"This action cannot be undone.",body_class:"",password:!1,prompt:"Type <strong>%s</strong> to continue:",footer_class:"",ok:"Confirm",ok_class:"button small",cancel:"Cancel",cancel_class:"button small alert"},s=e.extend({},a,t),i=function(t){var a,i,n,r,o,l,d,c;return r=t.data("confirm"),null===t.attr("data-confirm")?!0:"string"==typeof r&&r.length>0?((null!==(c=e.rails)?c.confirm:void 0)||window.confirm).call(window,r):(l=function(e){return r[e]||s[e]},o=e("<div data-reveal class='reveal "+l("modal_class")+"'>\n  <h2 data-confirm-title class='"+l("title_class")+"'></h2>\n  <p data-confirm-body class='"+l("body_class")+"'></p>\n  <div data-confirm-footer class='"+l("footer_class")+"'>\n    <a data-confirm-cancel class='"+l("cancel_class")+"'></a>\n  </div>\n</div>"),a=t.is("a")?t.clone():e("<a/>"),a.removeAttr("data-confirm").attr("class",l("ok_class")).html(l("ok")).on("click",function(a){return e(this).prop("disabled")?!1:(t.trigger("confirm.reveal",a),t.is("form, :input")?t.closest("form").removeAttr("data-confirm").submit():void 0)}),o.find("[data-confirm-title]").html(l("title")),o.find("[data-confirm-body]").html(l("body")),o.find("[data-confirm-cancel]").html(l("cancel")).on("click",function(e){return o.foundation("reveal","close"),t.trigger("cancel.reveal",e)}),o.find("[data-confirm-footer]").append(a),d===l("password")&&(n=l("prompt").replace("%s",d),i="<label>\n  "+n+"\n  <input data-confirm-password type='text'/>\n</label>",o.find("[data-confirm-body]").after(e(i)),o.find("[data-confirm-password]").on("keyup",function(t){var i;return i=e(this).val()!==d,a.toggleClass("disabled",i).prop("disabled",i)}).trigger("keyup")),o.appendTo(e("body")).foundation().foundation("reveal","open").on("closed.fndtn.reveal",function(e){return o.remove()}),!1)},e.rails?(e.rails.allowAction=function(t){return i(e(t))},e(this)):(n=function(t){return i(e(this))?void 0:(t.preventDefault(),t.stopImmediatePropagation())},this.each(function(){var t;return t=e(this),t.on("click","a[data-confirm], :input[data-confirm]",n),t.on("submit","form[data-confirm]",n),t}))}})}.call(this),jQuery.uiTableFilter=function(e,t,a,i){"use strict";var n,s,r,o,l,d,c,u,p=!1;if(this.last_phrase===t)return!1;if(r=t.length,l=t.toLowerCase().split(" "),d=function(e){e.show()},c=function(e){e.hide(),p=!0},u=function(e){return e.text()},a){if(s=null,e.find("thead > tr:last > th").each(function(e){return $(this).text()===a?(s=e,!1):void 0}),null===s)throw"given column: "+a+" not found";u=function(e){return jQuery(e.find("td:eq("+s+")")).text()}}if(l.size>1&&t.substr(0,r-1)===this.last_phrase){if(" "===t[-1])return this.last_phrase=t,!1;l=l[-1],d=function(e){},n=e.find("tbody > tr:visible")}else p=!0,n=e.find("tbody > tr");return n.each(function(){var e=jQuery(this);jQuery.uiTableFilter.has_words(u(e),l,!1)?d(e):c(e)}),o=t,i&&p&&i(),e},jQuery.uiTableFilter.last_phrase="",jQuery.uiTableFilter.has_words=function(e,t,a){"use strict";var i,n=a?e:e.toLowerCase();for(i=0;i<t.length;i++)if(-1===n.indexOf(t[i]))return!1;return!0};var jlettersdigits="abcdefghijklmnopqrstuvwxyz0123456789",jLetters="abcdefghijklmnopqrstuvwxyz",jDigits="0123456789",genRandomStr=function(e){"use strict";var t,a="",i=jlettersdigits.length;for(t=0;e>t;t++)a+=jlettersdigits.charAt(Math.floor(Math.random()*i));return a},map,mapSearchInput;jQuery.fn.toggleOption=function(e){if(jQuery(this).toggle(e),e)for(;jQuery(this).parent("span.toggleOption").length;)jQuery(this).unwrap();else jQuery(this).wrap('<span class="toggleOption" style="display: none;" />')};var createRowWithLangRm=function(e,t,a,i){return console.log("createRowWithLangRm fired"),$('<div class="large-12 small-12 columns"><div class="small-3 columns"><label for="'+a+'" class="right inline">'+t+'</label></div><div class="small-6 large-7 columns"><input id="'+a+'" name="'+a+'" type="text" class="validurl"/></div><div class="small-3 large-2 columns"> <button type="button" class="btn langinputrm button inline  left alert" name="langrm" value="'+e+'">'+i+"</button></div></div>")},createRowTaskParams=function(e,t){for(var a="z",i="0123456789",n=0;5>n;n++)a+=i.charAt(Math.floor(Math.random()*i.length));return $('<div class="row"><div class="small-6 column"><label>'+e+'<input name="params['+a+'][name]" type="text" value=""/></label></div><div class="small-6 column"><label>'+t+'<input name="params['+a+'][value]" type="text"  value=""/></label></div></div>')},spinImage=$("#spinner"),BINIT={initFvalidators:function(){console.log("BININT"),$("ul.validatorbuttons button").on("click",function(e){var t=$(this).attr("value"),a=$("#fvform");$.ajax({type:"GET",url:t,timeout:2500,cache:!0,dataType:"json",success:function(e){if(spinImage.hide(),e){var t=e.fedid,i=e.id,n=e.name,s=e.desc;a.find('input[name="fedid"]').first().val(t),a.find('input[name="fvid"]').first().val(i),$("#fvalidesc").replaceWith('<div id="fvalidesc"><b>'+n+"</b><p>"+s+"</p></div>"),a.show()}},beforeSend:function(){$("#fvresult").hide()},error:function(){spinImage.hide(),a.hide(),$("#fvresult").hide()}})})}},GINIT={initialize:function(){"use strict";var e=$(".pjagger");if(e.length>0){var t,a;e.each(function(){if(t=$(this),t.hasClass("piegraph")&&t.hasClass("fedgraph")){a=t.attr("data-jagger-link");var e=[];e.idp=0,e.sp=0,e.both=0,$.ajax({url:a,type:"GET",cache:!0,dataType:"json",success:function(e){if(e){var a=[{value:e.idp,color:"#F7464A",highlight:"#FF5A5E",label:e.definitions.idp},{value:e.sp,color:"#46BFBD",highlight:"#5AD3D1",label:e.definitions.sp},{value:e.both,color:"#FDB45C",highlight:"#FFC870",label:e.definitions.both}],i=t.find("canvas").get(0).getContext("2d");if(i){var n=new Chart(i).Pie(a,{responsive:!0,legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><div><span style="background-color:<%=segments[i].fillColor%>">&nbsp;&nbsp;&nbsp;</span> <%if(segments[i].label){%><%=segments[i].label%><%}%></div><%}%></div>'}),s=n.generateLegend();t.find("div.plegend").first().html(s)}}}})}})}var i=$("#membership2").first();if(void 0!==i&&i.length>0){var n,s=$(i).attr("data-jagger-link"),r=["idp","sp","both"],o=[];o.idp=0,o.sp=0,o.both=0,$.ajax({url:s,type:"GET",cache:!0,dataType:"json",success:function(e){if(e){var t,a=e.definitions.preurl,s=[],l=-1;s[++l]="<table><tbody>";for(var d=0,c=r.length;c>d;d++)if(n=r[d],e[n]){s[++l]='<tr><td colspan="2" class="highlight">'+e.definitions[n]+"</td></tr>",s[++l]='<tr><td colspan="2"><div class="zebramembers">',t=0,o[n]=e[n].length;var u;$.each(e[n],function(e,i){u="",i.penabled===!1&&(u+='<span class="label alert">disabled</span> '),1!==i.mdisabled&&1!==i.mbanned||(u+='<span class="label alert">membership suspended</span> '),++t,t%2?s[++l]='<div class="small-12 column odd">':s[++l]='<div class="small-12 column even">',s[++l]='<div class="large-5 column">'+t+'. <a href="'+a+i.pid+'">'+i.pname+"</a></div>",s[++l]='<div class="large-5 column">'+i.entityid+"</div>",s[++l]='<div class="large-2 column">'+u+"</div>",s[++l]="</div>"}),s[++l]="</div></td></tr>"}s[++l]="</tbody></table>",i.hasClass("fake")||$(i).html(s.join(""));var p=[{value:o.idp,color:"#F7464A",highlight:"#FF5A5E",label:e.definitions.idp},{value:o.sp,color:"#46BFBD",highlight:"#5AD3D1",label:e.definitions.sp},{value:o.both,color:"#FDB45C",highlight:"#FFC870",label:e.definitions.both}],f=document.getElementById("fedpiechart").getContext("2d");if(f&&(o.idp>0||o.sp>0||o.both>0)){var m=new Chart(f).Pie(p,{responsive:!0,legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><div><span style="background-color:<%=segments[i].fillColor%>">&nbsp;<%=segments[i].value %>&nbsp;</span> <%if(segments[i].label){%><%=segments[i].label%><%}%></div><%}%></div>'}),v=m.generateLegend();$("#fedpiechartlegend").html(v)}}}})}$("div[data-jagger-getmoreajax]").each(function(e){var t=$(this).attr("data-jagger-getmoreajax"),a=$(this).attr("data-jagger-response-msg"),i=$(this).attr("data-jagger-refreshurl"),n="";if(void 0===a||null===a)return console.log('attribute data-jagger-response-msg not found in element with data-jagger-getmoreajax="'+t+'" - exiting'),!1;console.log('attribute data-jagger-response-msg="'+a+'" in element data-jagger-getmoreajax="'+t+'"');var s=$("div#"+a);return void 0===s||null===s||0===$(s).length?(console.log('div with id="'+a+'" not found'),!1):(console.log('div with id="'+a+'" found'),void $.ajax({dataType:"json",type:"GET",url:t,cache:!0,success:function(e){if(!e)return console.log("no json got from "+t),!1;var a=e.length;if(1>a)return!1;var r,o=$("<div/>");$.each(e,function(e,t){r="<div>"+t.msg+"</div>",o.append(r)}),null!==i&&(n='<a class="refreshurl float-right" href="#"  data-jagger-getmoreajaxonclick= "'+i+'" data-jagger-response-msg="prdetails"><i class="fa fa-refresh" ></i></a>'),s.empty().append(n).append(o).show()}}))}),$("#taskformaddparam").on("click",function(e){var t=$(this).closest("div.row"),a=createRowTaskParams("","");return a.insertBefore(t),!1}),$("#password").on("keypress",function(e){var t=e.keyCode?e.keyCode:e.which,a=e.shiftKey?e.shiftKey:16===t;t>=65&&90>=t&&!a||t>=97&&122>=t&&a?$("#capswarn").show():$("#capswarn").hide()}),$("table.sortable").tablesorter();var l=$("[name='baseurl']").val();void 0===l&&(l=""),$("#loginbtn").on("click",function(e){var t=$(this).attr("data-jagger-link"),a=$("#loginform"),i=$(a).find(":submit").first(),n=$(a).find("div.usernamerow").first(),s=$(a).find("div.passwordrow").first(),r=$(a).find("div.secondfactorrow").first(),o=$("#loginresponse");return $.ajax({type:"GET",url:t,dataType:"json",cache:!1,success:function(e){if(1!==e.logged){if(0===e.partiallogged)return i.prop("disabled",!1),n.show(),s.show(),o.hide(),a.foundation("open"),!1;if(1===e.twofactor&&null!==e.secondfactor)return i.prop("disabled",!0),n.show(),$("#password").val(null),s.show(),o.hide(),e.html&&r.html(e.html).show(),a.foundation("open"),!1}else{var t=$("[name='baseurl']").val();void 0!==t&&(window.location.href=t)}n.show(),s.show(),o.hide(),a.foundation("open")}}),!1}),$(document).on("click",".modal-close",function(e){$(this).foundation("reveal","close")}),$("#providerdetail-tabs[data-tabs]").on("change.zf.tabs",function(e){console.log("Those tabs sure did change!");var t=$('div[data-tabs-content="'+$(this).attr("id")+'"]').children(".tabs-panel.is-active"),a=t.attr("data-reveal-ajax-tab");void 0!==a&&$.ajax({cache:!0,type:"GET",url:a,success:function(e){var a;try{a=JSON.parse(e)}catch(i){a=e,t.empty().append(a)}return t.foundation(),!1}})}),$("#newusermodal").on("submit","form",function(e){e.preventDefault();var t=$(this),a=t.attr("action"),i=t.find("div.message").first();$.ajax({url:a,type:"POST",data:t.serializeArray(),beforeSend:function(){i.hide().empty()},success:function(e){e&&"OK"===e.trim()?($("#newusermodal").foundation("close"),i.hide().empty(),location.reload()):i.html(e).show()}})}),$(".cleartarget").on("click",function(e){e.preventDefault();var t=$(this).attr("data-jagger-textarea"),a=$(this).attr("data-jagger-input");return void 0!==t&&$("textarea[name='"+t+"']").val(""),void 0!==a&&$("input[name='"+a+"']").val(""),!1}),$(".postajax").on("click",function(e){e.preventDefault();var t=$(this).closest("form"),a=$(this).attr("data-jagger-response-msg"),i=$("div#"+a),n=t.attr("action");return $.ajax({type:"POST",url:n,data:t.serializeArray(),beforeSend:function(){i.empty()},success:function(e){e?i.append(e):i.append("no result")},error:function(e,t,a){var n="<div>"+a+"</div>";return i.append(n),!1}}),!1}),$(".policymembers").on("click",function(e){var t=$(this).attr("data-jagger-jsource"),a=$("#regpolmembers"),i=a.find(".datacontent").first();$.ajax({type:"GET",url:t,beforeSend:function(){i.empty()},success:function(e){if(e){var t=$("<ul/>");t.addClass("no-bullet");var n=[],s=0;$.each(e,function(e,t){n[s++]='<li><a href="'+l+"providers/detail/show/"+t.provid+'">'+t.name+" </a><small>("+t.entityid+")</small></li>"}),t.append(n.join("")),i.append(t),a.foundation("open")}}})}),$(document).on("click",".ecmembers",function(e){var t=$(this).attr("data-jagger-jsource"),a=$("#ecmembers"),i=a.find(".datacontent").first();$.ajax({type:"GET",url:t,beforeSend:function(){i.empty()},success:function(e){if(e){var t=$("<ul/>");t.addClass("no-bullet");var n=[],s=0;$.each(e,function(e,t){n[s++]='<li><a href="'+l+"providers/detail/show/"+t.provid+'">'+t.name+" </a><small>("+t.entityid+")</small></li>"}),t.append(n.join("")),i.append(t),a.foundation("open")}}})}),$(".rmusericon").on("click",function(e){var t=$("#removeusermodal"),a=t.find("#removeusermodalmsg").first(),i=$(this).attr("data-jagger-username"),n=$(this).attr("data-jagger-encodeduser"),s=t.find("#usernameval").first(),r=t.find("#encodedusr").first(),o=t.find("button[name='close']"),l=t.find("button[name='cancel']"),d=t.find("button[name='remove']"),c=t.find("input[name='username']");return c.val(""),r.val(n),s.html(i),a.html("").hide().removeClass("alert").removeClass("success"),d.show(),l.show(),o.hide(),t.foundation("open"),!1}),$("#removeusermodal").on("submit",function(e){e.preventDefault();var t=$(this),a=t.find("form").first(),i=a.serializeArray(),n=t.find("#removeusermodalmsg").first(),s=t.find("#encodedusr").first(),r=a.attr("action"),o=t.find("button[name='close']"),l=t.find("button[name='cancel']"),d=t.find("button[name='remove']");$.ajax({type:"POST",url:r,data:i,beforeSend:function(){n.html("").hide().removeClass("alert").removeClass("success"),d.show(),l.show(),o.hide()},success:function(e){var t=$(document).find('a[data-jagger-encodeduser="'+s.val()+'"]');return t&&t.closest("tr").hide(),n.html(e).addClass("success").show(),d.hide(),l.hide(),o.show(),!1},error:function(e,t,a){return n.html(e.responseText).addClass("alert").show(),!1}})}),$("#confirmremover").on("click",".yes",function(e){e.preventDefault();var t=$(this).closest("form"),a=t.attr("action"),i=t.attr("data-jagger-regpolicy"),n=t.attr("data-jagger-ec");$.ajax({type:"POST",url:a,data:t.serializeArray(),success:function(e){void 0!==i&&null!==i?$('a[data-jagger-regpolicy="'+i+'"]').closest("tr").hide():$('a[data-jagger-ec="'+n+'"]').closest("tr").hide(),$("#confirmremover").foundation("close")},error:function(e,t,a){var i=""+a;return window.alert(i),!1}})}),$("a.withconfirm").on("click",function(e){e.preventDefault();var t=$(this).attr("href"),a=$(this).attr("data-jagger-regpolicy"),i=$(this).attr("data-jagger-ec"),n=$(this).attr("data-jagger-counter"),s=$(this).attr("data-jagger-fieldname");if(void 0===t)return!1;var r=$("#confirmremover"),o=r.find("span.data-fieldname").first(),l=r.find("span.data-counter").first();o.html(s),l.html(n);var d=r.find("form").first();d.attr("action",t),void 0!==i&&null!==i?d.attr("data-jagger-ec",i):d.attr("data-jagger-regpolicy",a),r.foundation("open")}),$(".dhelp").click(function(){var e=parseInt($(this).css("font-size"));10>=e?$(this).css("font-size",e+5).removeClass("zoomin").addClass("zoomout"):$(this).css("font-size",e-5).removeClass("zoomout").addClass("zoomin")}),$("form#availablelogos input[name='filename']").click(function(){$(this).after($("form#availablelogos div.buttons").show())}),$("button.reqattrrm").click(function(){var e=$(this).closest("fieldset");e.remove()}),$("form#availablelogos").on("submit",function(e){e.preventDefault();var t=$("div.uploadresult"),a=$("div.assignedlogosgrid").text();$("#uploadlogo").unbind(),$.ajax({type:"POST",url:$(this).attr("action"),data:$("form#availablelogos").serializeArray(),dataType:"html",cache:!1,beforeSend:function(){$("form#availablelogos div.buttons").hide().appendTo("form#availablelogos")},success:function(e){$("form#availablelogos #filename").prop("checked",!1),$.ajax({type:"GET",url:a,cache:!1,success:function(e){$("#uploadlogo").unbind(),$("div#t1").empty().append(e),$("#assignedlogos").unbind(),$("#availablelogos").unbind(),GINIT.initialize()}}),spinImage.hide(),revealAlert(e,"OK")},error:function(e,a,i){spinImage.hide(),t.css("color","red"),revealAlert('<div data-alert class="alert-box alert">'+e.responseText+"</div>","OK")}})}),$("#uploadlogo").on("submit",function(e){e.preventDefault();var t=new FormData(document.forms.namedItem("uploadlogo")),a=$("div.uploadresult"),i=$("div.availablelogosgrid").text(),n=$("div.assignedlogosgrid").text();$.ajax({type:"POST",url:$(this).attr("action"),data:t,dataType:"html",cache:!1,processData:!1,contentType:!1,beforeSend:function(){a.html(""),a.css("color","black"),$("form#availablelogos div.buttons").hide().appendTo("form#availablelogos"),spinImage.show()},success:function(e){spinImage.hide(),a.html(e),revealAlert($("div.uploadresult").text(),"OK"),$.ajax({type:"GET",url:n,cache:!1,success:function(e){var t=$("form#assignedlogos");t.replaceWith(e),$("#availablelogos").unbind(),t.unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),$("form#availablelogos input[name='filename']").unbind("click"),GINIT.initialize()},error:function(e,t,a){spinImage.hide(),$("#availablelogos").unbind(),$("#assignedlogos").unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),$("form#availablelogos input[name='filename']").unbind("click"),GINIT.initialize()}}),$.ajax({type:"GET",url:i,cache:!1,success:function(e){$("form#availablelogos").replaceWith(e),$("form#availablelogos").unbind(),$("form#assignedlogos").unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),$("form#availablelogos input[name='filename']").unbind("click"),GINIT.initialize()},error:function(e,t,a){spinImage.hide(),$("#availablelogos").unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),$("form#availablelogos input[name='filename']").off("click"),revealAlert('<div data-alert class="alert-box alert">'+e.responseText+"</div>","OK"),GINIT.initialize()}})},error:function(e,t,a){spinImage.hide(),revealAlert('<div data-alert class="alert-box alert">'+e.responseText+"</div>","OK")}}).done(function(){})}),$("li.fromprevtoright").each(function(){var e=$(this).prev(),t=e.offset().left,a=$(this).prev().find("input,textarea").last(),i=a.offset().left,n=a.width(),s=i+n-t;$(this).css("text-align","right").width(s)}),$("form#assignedlogos input[name='logoid']").click(function(){$(this).after($("div#unsignlogosbtn").show())}),$("form#applyforaccount").on("submit",function(e){e.preventDefault();var t=$("div.result"),a=$("form#applyforaccount").serializeArray();$.ajax({type:"POST",url:$(this).attr("action"),data:a,dataType:"html",cache:!1,beforeSend:function(){t.html(""),spinImage.show()},success:function(e){spinImage.hide(),t.html(e),$("form#applyforaccount").remove()},error:function(e,a,i){spinImage.hide(),t.html(e.responseText),t.css("color","red"),$("form#applyforaccount").remove()}})}),$("form#assignedlogos").on("submit",function(e){e.preventDefault();var t=$("div.uploadresult"),a=$("form#assignedlogos").serializeArray(),i=$("input[name=logoid]:radio:checked"),n=$("#messagereveal"),s=n.find("p.infomsg");$.ajax({type:"POST",url:$(this).attr("action"),data:a,dataType:"html",cache:!1,beforeSend:function(){$("div#unsignlogosbtn").hide().appendTo("form#assignedlogos"),t.html(""),spinImage.show()},success:function(e){spinImage.hide(),s.html(e),n.foundation("open"),i.parent().remove()},error:function(e,t,a){spinImage.hide(),s.html(e.responseText),n.foundation("open")}})}),$(".updatenotifactionstatus").click(function(e){e.preventDefault();var t=$("#notificationupdateform"),a=$(this).attr("value"),i=($(this).closest("tbody"),$(this).closest("tr")),n=(i.find("div.subscrstatus:first"),l+"notifications/subscriber/updatestatus/"+a);t.attr("action",n),t.find("#noteid").first().val(a)}),$("#fvform").submit(function(e){e.preventDefault();var t=$(this),a=t.serializeArray(),i=t.attr("action");t.find("button:focus").attr("id");$.ajax({type:"POST",url:i,cache:!1,data:a,dataType:"json",timeout:12e4,success:function(e){if(spinImage.hide(),e){if(e.returncode&&($("span#fvreturncode").append(e.returncode),$("div#fvresult").show()),"success"===e.returncode?(t.find("button:focus").css("background-color","#00aa00"),t.find("button:focus").data("passed","true"),t.find("button:focus").attr("disabled","true")):"error"===e.returncode&&(t.find("button:focus").css("background-color","#aa0000"),t.find("button:focus").data("passed","false")),e.message){var a;$.each(e.message,function(e,t){$.each(t,function(t,i){a="<div>"+e+": "+i+"</div>",$("div#fvmessages").append(a)})})}}else alert("no data received from upstream server")},beforeSend:function(){$("span#fvreturncode").text(""),$("div#fvmessages").text(""),spinImage.show()},error:function(e,t,a){spinImage.hide(),"timeout"===t?window.alert("got timeout from validation server"):window.alert("unknown problem with receiving data")}})}),$("#rejectqueue").on("submit",function(e){var t=$(this).serializeArray(),a=$(this).attr("action");return $.ajax({type:"POST",url:a,data:t,dataType:"json",success:function(e){e&&(alert(e.message),window.location.href=l)},error:function(e,t,a){window.alert("Error occured: "+a)}}),!1}),$("#approvequeue").submit(function(e){var t=0,a=0;$("button[name='mandatory']").each(function(e){"true"===$(this).data("passed")&&(t+=1),a+=1}),a!==t&&(window.alert("All mandatory validations have to pass successfully!"),e.preventDefault())}),$(document).on("click",".fmembers","a",function(){var e=$(this),t=e.attr("href"),a=e.parent().parent();if($(a).hasClass("opened")===!0)$(a).next().remove(),$(a).removeClass("opened").removeClass("highlight");else{var i=$("<ul/>");$.ajax({url:t,timeout:9500,cache:!0,success:function(e){spinImage.hide();var t,n,s;if($(a).addClass("opened").addClass("highlight"),e)if(e.idp||e.sp||e.both){var r=e.definitions.preurl;e.idp&&(t=$("<div>"+e.definitions.idp+"</div>"),n=$("<ol/>"),$.each(e.idp,function(e,t){s='<li class="homeorg"><a href="'+r+t.pid+'">'+t.pname+"</a> ("+t.entityid+") </li>",n.append(s)}),t.append(n),i.append(t)),e.sp&&(t=$("<div>"+e.definitions.sp+"</div>"),n=$("<ol/>"),$.each(e.sp,function(e,t){s='<li class="resource"><a href="'+r+t.pid+'">'+t.pname+"</a> ("+t.entityid+") </li>",n.append(s)}),t.append(n),i.append(t)),e.both&&(t=$("<div>"+e.definitions.both+"</div>"),n=$("<ol/>"),$.each(e.both,function(e,t){s='<li class="both"><a href="'+r+t.pid+'">'+t.pname+"</a> ("+t.entityid+") </li>",n.append(s)}),t.append(n),i.append(t))}else s="<div>"+e.definitions.nomembers+"</div>",i.append(s);else window.alert("no data")},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("problem with loading data")}}).done(function(){var e='<tr class="feddetails"><td colspan="7"><ul class="feddetails">'+i.html()+"</ul></td></tr>";$(e).insertAfter(a)})}return!1}),$("#getmembers").click(function(){var e=$(this),t=e.attr("href"),a=$("<ul/>");return $.ajax({url:t,timeout:22500,cache:!0,dataType:"json",success:function(e){if(spinImage.hide(),e){var t=$("<div/>");t.addClass("zebralist row"),t.css("list-style-type","decimal");var i,n=1,s=1;$.each(e,function(e,a){var r=$("<span/>");$.each(a.feds,function(e,t){var a='<span class="label">'+t+"</span>&nbsp;";r.append(a)}),i='<div class="large-12 columns" style="margin-top: 2px; margin-bottom: 2px"><div class="large-9 columns">'+s+'. <a href="'+a.url+'">'+a.name+"</a> <i> ("+a.entityid+') </i></div><div class="fedlbl large-3 end text-right columns">'+r.html()+"</div></div>",t.append(i),n+=1,s+=1}),a.append(t)}else window.alert("no data")},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("problem with loading data")}}).done(function(){var e=a.html();$("div#membership").replaceWith(e)}),!1}),$(".accordionButton").addClass("off").mouseover(function(){$(this).addClass("over")}).mouseout(function(){$(this).removeClass("over")}).click(function(){$(this).removeClass("on").addClass("off"),$(".accordionContent").slideUp("fast"),$(this).next().is(":hidden")===!0&&($(this).addClass("on"),$(this).removeClass("off"),$(this).next().slideDown("fast"))}),$(".accordionContent").hide()}};$(document).ready(function(){$("fieldset").addClass("fieldset"),$("pre code").each(function(e,t){hljs.highlightBlock(t)}),$(window).scroll(function(){$(this).scrollTop()>=100?$("#return-to-top").fadeIn(200):$("#return-to-top").fadeOut(200)}),$("#return-to-top").click(function(){$("body,html").animate({scrollTop:0},400)}),GINIT.initialize();var e,t=$("#accessmngmt");if(t.length){e=t.closest("form");var a=t.attr("data-jagger-jsource");$.ajax({type:"GET",url:a,dataTypa:"json",beforeSend:function(){spinImage.show()},success:function(e){var a=e.definitions.admin,i=e.definitions.dictionary.allow,n=e.definitions.dictionary.deny,s=e.definitions.dictionary.hasaccess,r=e.definitions.dictionary.hasnoaccess,o=e.definitions.dictionary.username,l="Administrator",d="You";spinImage.hide();var c=[];c.push("<table><thead><tr><th>"+o+"</th>"),$.each(e.definitions.actions,function(e,t){c.push("<th>"+t+"</th>")}),c.push("</tr></thead>"),c.push("<tbody>"),$.each(e.data,function(t,o){c.push("<tr><td>");var u="",p="",f="";o.isyou===!0&&(u=u+' <span class="label warning">'+d+"</span>",p=' disabled="disabled" '),o.isadmin===!0&&(u=u+' <span class="label">'+l+"</span>"),c.push(""+t+" ("+o.fullname+")"+u),c.push("</td>"),$.each(e.definitions.actions,function(e,l){f="",o.isadmin===!0?c.push("<td>"+s+"</td>"):("approve"===l&&a!==!0&&(p=' disabled="disabled" ',f="secondary"),o.perms[l]===!0?c.push("<td>"+s+" <div><button "+p+' class="button small alert '+f+'" value="'+t+"$|$"+l+'$|$deny" name="changeaccess" type="submit" >'+n+"</button></div></td>"):c.push("<td>"+r+" <div><button "+p+' class="button small '+f+'" value="'+t+"$|$"+l+'$|$allow" name="changeaccess" type="submit">'+i+"</button></div></td>"))}),c.push("</tr>")}),c.push("</tbody>"),c.push("</table>");var u=c.join("");t.html(u)},error:function(e,t,a){spinImage.hide(),window.alert(e.responseText)}}),e.on("click","button",function(t){var a=$(this),i=e.serializeArray();return i.push({name:a.attr("name"),value:a.val()}),console.log(i),$.ajax({method:"POST",data:i,url:e.attr("action"),success:function(e){window.location.href=window.location.href},error:function(e,t,a){}}),!1})}var i=/^-?([0-8]?[0-9]|90)\.[0-9]{1,6},-?((1?[0-7]?|[0-9]?)[0-9]|180)\.[0-9]{1,6}$/,n=$("#providereditform");if(n.length){var s=($("#uihints"),$("#addlatlng")),r=[],o=[],l=n.find("#map-canvas");if(l.length)if("object"==typeof google&&"object"==typeof google.maps){google.maps.event.addDomListener(window,"load",mapInitialize);var d=$("#geogroup").first();r=[],d.find("input").each(function(e){var t=$(this).val().split(",");r.push(t)});var c=!1;n.on("change.zf.tabs","[data-tabs]",function(e){for(var t=new google.maps.LatLngBounds,a=0,i=r.length;i>a;a++){var n=new google.maps.LatLng(r[a][0],r[a][1]),s=new google.maps.Marker({position:n,map:map,title:""});s.setMap(map),o.push(s),t.extend(s.position)}c=!0;var l=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(l),r.length>0&&map.fitBounds(t);var d=google.maps.event.addListener(map,"idle",function(){map.getZoom()>16&&map.setZoom(16),google.maps.event.removeListener(d)})})}else l.append('<div data-alert class="alert-box alert">Map could not be loaded</div>');n.on("click","a.rmgeo",function(e){for(var t=$(this).closest("div.georow").find("input").first().val(),a=t.split(","),i=0,n=o.length;n>i;i++){var s=o[i];console.log(s.position.lat()+" ?? "+a[0]),parseFloat(s.position.lat())===parseFloat(a[0])&&(s.setMap(null),o.splice(i,1))}return $(this).closest("div.georow").remove(),!1}),s.on("click",function(e){e.preventDefault();var t=$("#latlng").val();if(i.test(t)){for(var a="z",n="0123456789",s=0;5>s;s++)a+=n.charAt(Math.floor(Math.random()*n.length));var r='<div class="small-12 column collapse georow"><div class="small-11 column"><input name="f[uii][idpsso][geo]['+a+']" type="text" value="'+t+'" readonly="readonly"></div><div class="small-1 column"><a href="#" class="rmgeo"><i class="fa fa-trash alert" style="color: red"></i></a></div></div>';if($(r).appendTo($("#geogroup")),"object"==typeof google&&"object"==typeof google.maps){var l=new google.maps.LatLngBounds,d=t.split(","),c=new google.maps.LatLng(d[0],d[1]),u=new google.maps.Marker({position:c,map:map,title:""});u.setMap(map),o.push(u),l.extend(u.position)}}else window.alert("incorrect value")});var u;n.find("div.group").each(function(){var e=$(this).find("select").first();$(this).find("button.langinputrm").each(function(){u=$(this).attr("value"),e.find("option[value="+u+"]").each(function(){$(this).toggleOption(!0),$(this).attr("disabled",!0)})})}),$("button#idpssoadddomainhint").click(function(){for(var e="",t="0123456789",a=0;5>a;a++)e+=t.charAt(Math.floor(Math.random()*t.length));var i=$("button#helperbutttonrm").html(),n=($(this).attr("value"),"f[uii][idpsso][domainhint][n"+e+"]"),s=createRowWithLangRm("Domain Hint","Domain Hint",n,i);s.insertBefore($(this).closest("span").parent())}),$("button#idpssoaddiphint").click(function(){for(var e="",t="0123456789",a=0;5>a;a++)e+=t.charAt(Math.floor(Math.random()*t.length));var i=$("button#helperbutttonrm").html(),n=($(this).attr("value"),"f[uii][idpsso][iphint][n"+e+"]"),s=createRowWithLangRm("IP Hint","IP Hint",n,i);s.insertBefore($(this).closest("span").parent())}),$("button#addlhelpdesk").click(function(){var e=$("span.lhelpdeskadd option:selected").first(),t=e.val(),a=$("button#helperbutttonrm").html();if("undefined"==typeof t)return!1;var i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1);var n="f[lhelpdesk]["+t+"]",s=createRowWithLangRm(t,i,n,a);s.insertBefore($(this).closest("span").parent())}),$("button#addldisplayname").click(function(){var e=$("span.ldisplaynameadd option:selected").first(),t=e.val(),a=$("button#helperbutttonrm").html();if("undefined"==typeof t)return!1;var i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1);var n="f[ldisplayname]["+t+"]",s=createRowWithLangRm(t,i,n,a);s.insertBefore($(this).closest("span").parent())}),$("button#idpadduiidisplay").click(function(){
var e=$("span.idpuiidisplayadd option:selected").first(),t=e.val(),a=$("button#helperbutttonrm").html();if("undefined"==typeof t)return!1;var i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1);var n="f[uii][idpsso][displayname]["+t+"]",s=createRowWithLangRm(t,i,n,a);s.insertBefore($(this).closest("span").parent())}),$("button#idpadduiihelpdesk").click(function(){var e=$("span.idpuiihelpdeskadd option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=$("button#helperbutttonrm").html(),i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1);var n="f[uii][idpsso][helpdesk]["+t+"]",s=createRowWithLangRm(t,i,n,a);s.insertBefore($(this).closest("span").parent())}),$("button#spadduiidisplay").click(function(){var e=$("span.spuiidisplayadd option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();e.attr("disabled",!0).attr("selected",!1);var n="f[uii][spsso][displayname]["+t+"]",s=createRowWithLangRm(t,a,n,i);s.insertBefore($(this).closest("span").parent())}),$("button#spadduiihelpdesk").click(function(){var e=$("span.spuiihelpdeskadd option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();e.attr("disabled",!0).attr("selected",!1);var n="f[uii][spsso][helpdesk]["+t+"]",s=createRowWithLangRm(t,a,n,i);s.insertBefore($(this).closest("span").parent())}),$("button#spadduiidesc").click(function(){var e=$("span.spuiidescadd option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();e.attr("disabled",!0).attr("selected",!1),$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][spsso][desc]['+t+']" class="right inline">'+a+'</label></div><div class="small-6 large-7 columns"><textarea id="f[uii][spsso][desc]['+t+']" name="f[uii][spsso][desc]['+t+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"><button type="button" class="btn langinputrm button left inline alert" name="uiispdescrm" value="'+t+'">'+i+"</button></div></div>").insertBefore($(this).closest("span").parent())}),$("#spadduiikeywords").click(function(){var e=$("span.spuiikeywordsadd option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();e.attr("disabled",!0).attr("selected",!1),$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][spsso][keywords]['+t+']" class="right inline">'+a+'</label></div><div class="small-6 large-7 columns"><textarea id="f[uii][spsso][keywords]['+t+']" name="f[uii][spsso][keywords]['+t+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"><button type="button" class="langinputrm button  left inline alert" name="uiispkeywordsrm" value="'+t+'">'+i+"</button></div></div>").insertBefore($(this).closest("span").parent())}),$("button#addlname").click(function(){var e=$("span.lnameadd option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=$("button#helperbutttonrm").html(),i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1);var n="f[lname]["+t+"]",s=createRowWithLangRm(t,i,n,a);s.insertBefore($(this).closest("span").parent())});var p=$("button[name='addinnewlang']");p.on("click",function(e){var t=$(this),a=(t.closest("fieldset"),t.closest("span"));if(0===a.length)return!1;var i=a.find(":selected").first();if(0===i.length)return!1;var n=i.attr("disabled");if(null!==n&&"disabled"===n)return!1;var s=i.val(),r=i.text();if("undefined"==typeof s||""===s)return!1;var o=$("button#helperbutttonrm").html(),l=t.attr("value").replace("XXX",s);i.attr("disabled",!0).attr("selected",!1);var d=createRowWithLangRm(s,r,l,o);d.insertBefore($(this).closest("span").parent())}),$("button#idpadduiidesc").click(function(){var e=$("span.idpuiidescadd option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=$("button#helperbutttonrm").html(),i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][idpsso][desc]['+t+']" class="right inline">'+i+' </label></div><div class="small-6 large-7 columns"><textarea id="f[uii][idpsso][desc]['+t+']" name="f[uii][idpsso][desc]['+t+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"> <button type="button" class=" langinputrm button  left inline alert" name="ldesc" value="'+t+'">'+a+"</button></div></div>").insertBefore($(this).closest("span").parent())}),$("button#idpadduiikeywords").click(function(){var e=$("span.idpuiikeywordsadd option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=$("button#helperbutttonrm").html(),i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][idpsso][keywords]['+t+']" class="right inline">'+i+' </label></div><div class="small-6 large-7 columns"><textarea id="f[uii][idpsso][keywords]['+t+']" name="f[uii][idpsso][keywords]['+t+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"> <button type="button" class="langinputrm button  left inline alert" name="lkeywords" value="'+t+'">'+a+"</button></div></div>").insertBefore($(this).closest("span").parent())}),$("button#addlprivacyurlspsso").click(function(){var e=$("span.addlprivacyurlspsso option:selected").first(),t=e.val();if("undefined"==typeof t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1);var n="f[prvurl][spsso]["+t+"]",s=createRowWithLangRm(t,a,n,i);s.insertBefore($(this).closest("span").parent())}),$("button#addlprivacyurlidpsso").click(function(){var e=$("span.addlprivacyurlidpsso option:selected").first(),t=e.val(),a=$("button#helperbutttonrm").html();if("undefined"==typeof t)return!1;var i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1);var n="f[prvurl][idpsso]["+t+"]",s=createRowWithLangRm(t,i,n,a);s.insertBefore($(this).closest("span").parent())}),$("#ncontactbtn").click(function(){var e=genRandomStr(5),t=$(this).attr("value").split("|"),a='<div class="group"><div class="small-12 columns"><fieldset><legend>'+t[5]+'</legend><div><div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+e+'][type]" class="right inline">'+t[1]+'</label></div><div class="small-8 large-7 columns inline"><select name="f[contact][n_'+e+'][type]"> <option value="administrative">Administrative</option> <option value="technical">Technical</option> <option value="support" selected="selected">Support</option> <option value="billing">Billing</option> <option value="other">Other</option> <option value="other-sirfti">Security (Sirfty)</option> </select></div><div class="small-1 large-2 columns"></div></div> <div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+e+'][fname]" class="right inline">'+t[2]+'</label></div><div  class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+e+'][fname]" value="" id="f[contact][n_'+e+'][fname]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div> <div class="small-12 columns"><div  class="small-3 columns"><label for="f[contact][n_'+e+'][sname]" class="right inline">'+t[3]+'</label></div><div class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+e+'][sname]" value="" id="f[contact][n_'+e+'][sname]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+e+'][email]" class="right inline ">'+t[4]+'</label></div><div class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+e+'][email]" value="" id="f[contact][n_'+e+'][email]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div><div class="rmelbtn small-12 columns"><div class="small-9 large-10 columns"><button type="button" class="btn contactrm  alert button inline right" name="contact" value="'+e+'">'+t[0]+'</button></div><div class="small-3 large-2 columns"></div></div></div></fieldset></div></div>';$(this).parent().before(a)}),$("#nidpssocert").click(function(){var e="newx"+genRandomStr(5),t='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][idpsso]['+e+'][type]" class="inline right">Certificate type</label></div><div class="small-6 large-7 columns"><select name="f[crt][idpsso]['+e+'][type]"> <option value="x509">x509</option> </select></div><div class="small-3 large-2 columns"></div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][idpsso]['+e+'][usage]" class="inline right">Certificate use</label></div><div class="small-6 large-7 columns"><select name="f[crt][idpsso]['+e+'][usage]"> <option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][idpsso]['+e+'][keyname]" class="inline right">KeyName</label></div><div class="small-6 large-7 columns"><input type="text" name="f[crt][idpsso]['+e+'][keyname]" value="" id="f[crt][idpsso]['+e+'][keyname]" class=""  /> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][idpsso]['+e+'][certdata]" class="inline right">Certificate</label></div><div class="small-6 large-7 columns"><textarea name="f[crt][idpsso]['+e+'][certdata]" cols="65" rows="20" id="f[crt][idpsso]['+e+'][certdata]" class="certdata notice" ></textarea></div><div class="small-3 large-2 columns"></div></div>';$(this).parent().before(t)}),$("#naacert").click(function(){var e="newx"+genRandomStr(5),t='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][aa]['+e+'][type]" class="inline right">Certificate type</label></div><div class="small-6 large-7 columns"><select name="f[crt][aa]['+e+'][type]"> <option value="x509">x509</option> </select> </div><div class="small-3 large-2 columns"></div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][aa]['+e+'][usage]" class="inline right">Usage</label></div><div class="small-6 large-7 columns"><select name="f[crt][aa]['+e+'][usage]"> <option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][aa]['+e+'][keyname]" class="inline right">KeyName</label></div><div class="small-6 large-7 columns"><input type="text" name="f[crt][aa]['+e+'][keyname]" value="" id="f[crt][aa]['+e+'][keyname]" class=""  /> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][aa]['+e+'][certdata]" class="inline right">Certificate</label></div><div class="small-6 large-7 columns"><textarea name="f[crt][aa]['+e+'][certdata]" cols="65" rows="20" id="f[crt][aa]['+e+'][certdata]" class="certdata notice" ></textarea> </div><div class="small-3 large-2 columns"></div></div> ';$(this).parent().before(t)}),$("#nspssocert").click(function(){var e="newx"+genRandomStr(5),t='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][spsso]['+e+'][type]" class="right inline">Certificate type</label></div><div class="small-8 large-7 columns"><select name="f[crt][spsso]['+e+'][type]"><option value="x509">x509</option></select> </div><div class="small-1 large-2 columns end"></div></div><div class="small-12  columns"><div class="small-3 columns"><label for="f[crt][spsso]['+e+'][usage]" class="right inline">Certificate use</label></div><div class="small-8 large-7 columns"><select name="f[crt][spsso]['+e+'][usage]"><option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select></div><div class="small-1 large-2 columns end"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][spsso]['+e+'][keyname]" class="right inline">KeyName</label></div><div class="small-8 large-7 columns"><input type="text" name="f[crt][spsso]['+e+'][keyname]" value="" id="f[crt][spsso]['+e+'][keyname]" class=""  /></div><div class="small-1 large-2 columns end"></div> </div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][spsso]['+e+'][certdata]" class="right inline">Certificate</label></div><div class="small-8 large-7 columns"><textarea name="f[crt][spsso]['+e+'][certdata]" cols="65" rows="20" id="f[crt][spsso]['+e+'][certdata]" class="certdata" ></textarea></div><div class="small-1 large-2 columns end"></div></div><div class="small-12 columns"><div class="small-3 columns">&nbsp;</div><div class="small-6 large-7 columns"><button class="certificaterm button alert  right" value="'+e+'" name="certificate" type="button">Remove certificate</button></div><div class="small-3 large-2 columns"></div></div></div>';$(this).parent().before(t)}),$("#nacsbtn").click(function(){var e=genRandomStr(5),t='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][AssertionConsumerService][n_'+e+'][bind]" class="right inline">Binding Name</label></div><div class="small-5 columns inline"><select name="f[srv][AssertionConsumerService][n_'+e+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST-SimpleSign">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST-SimpleSign</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:PAOS">urn:oasis:names:tc:SAML:2.0:bindings:PAOS</option> <option value="urn:oasis:names:tc:SAML:2.0:profiles:browser-post">urn:oasis:names:tc:SAML:2.0:profiles:browser-post</option> <option value="urn:oasis:names:tc:SAML:1.0:profiles:browser-post">urn:oasis:names:tc:SAML:1.0:profiles:browser-post</option> <option value="urn:oasis:names:tc:SAML:1.0:profiles:artifact-01">urn:oasis:names:tc:SAML:1.0:profiles:artifact-01</option> </select></div> <div class="small-4 columns"><div class="small-6 columns"><input type="text" name="f[srv][AssertionConsumerService][n_'+e+'][order]" value="" id="f[srv][AssertionConsumerService][n_'+e+'][order]" size="2" maxlength="2" class="acsindex "  /></div><div class="small-6 columns"><label for="f[srv][AssertionConsumerService][n_'+e+'][default]">Is default</label><input type="radio" name="f[srv][AssertionConsumerService][n_'+e+'][default]" value="1" id="f[srv][AssertionConsumerService][n_'+e+'][default]" class="acsdefault"/></div></div> </div>          <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][AssertionConsumerService][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-8 large-7 columns inline"><input name="f[srv][AssertionConsumerService][n_'+e+'][url]" id="f[srv][AssertionConsumerService][n_'+e+'][url]" type="text"></div><div class="small-3 large-2 columns"><button class="inline left button  alert rmfield"  name="rmfield" type="button">Remove</button></div></div></div>';$(this).parent().before(t)}),$("#nidpartifactbtn").click(function(){var e=genRandomStr(5),t='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][IDPArtifactResolutionService][n_'+e+'][bind]" class="right inline">Binding Name</label></div><div class="small-6 large-7 columns inline"><select name="f[srv][IDPArtifactResolutionService][n_'+e+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:SOAP" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</option> <option value="urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding">urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding</option></select></div> <div class="small-2 large-1 columns end"><input type="text" name="f[srv][IDPArtifactResolutionService][n_'+e+'][order]" value="" id="f[srv][IDPArtifactResolutionService][n_'+e+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div> <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][IDPArtifactResolutionService][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns inline"><input name="f[srv][IDPArtifactResolutionService][n_'+e+'][url]" id="f[srv][IDPArtifactResolutionService][n_'+e+'][url]" type="text"></div><div class="small-3 large-2 columns"><button class="inline left button  alert rmfield" value="" name="rmfield" type="button">Remove</button></div></div>';$(this).parent().before(t)}),$("#nspartifactbtn").click(function(){var e=genRandomStr(5),t='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][SPArtifactResolutionService][n_'+e+'][bind]" class="right inline">Binding Name</label></div><div class="small-8 large-7 columns inline"><select name="f[srv][SPArtifactResolutionService][n_'+e+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:SOAP" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</option> <option value="urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding">urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding</option></select> </div> <div class="small-1  columns left"><input type="text" name="f[srv][SPArtifactResolutionService][n_'+e+'][order]" value="" id="f[srv][SPArtifactResolutionService][n_'+e+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div>           <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][SPArtifactResolutionService][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns inline"><input name="f[srv][SPArtifactResolutionService][n_'+e+'][url]" id="f[srv][SPArtifactResolutionService][n_'+e+'][url]" type="text"> </div><div class="small-3 large-2 columns"><button class="inline left button  alert rmfield"  name="rmfield" type="button">Remove</button></div></div>';$(this).parent().before(t)}),$("#ndrbtn").click(function(){var e=genRandomStr(5),t='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][DiscoveryResponse][n_'+e+'][bind]" class="right inline">Binding Name</label></div><div class="small-6 large-7 columns"><select name="f[srv][DiscoveryResponse][n_'+e+'][bind]"><option value="urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol">urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol</option></select> </div><div class="small-1 columns end"><input type="text" name="f[srv][DiscoveryResponse][n_'+e+'][order]" value="" id="f[srv][DiscoveryResponse][n_'+e+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][DiscoveryResponse][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns"><input name="f[srv][DiscoveryResponse][n_'+e+'][url]" id="f[srv][DiscoveryResponse][n_'+e+'][url]" type="text"></div><div class="small-1 columns end"><button class="rmfield button alert  left" name="rmfield">Remove</button></div></div></div>';$(this).parent().before(t)}),$("#nribtn").click(function(){var e=genRandomStr(5),t='<div class="small-12 columns srvgroup"><div class="small-3 columns"><label for="f[srv][RequestInitiator][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns"><input name="f[srv][RequestInitiator][n_'+e+'][url]" id="f[srv][RequestInitiator][n_'+e+'][url]" type="text"></div><div class="small-3 large-2 columns"><button type="button" class="inline left button  alert rmfield" name="rmfield" value="">remove</button></div></div>';$(this).parent().before(t)}),$("button.addnewlogo").click(function(){var e,t=$(this).closest("div.reviewlogo"),a=t.attr("id"),i=genRandomStr(5),n="sp";"idpreviewlogo"===a&&(n="idp");var s=t.find("input[name='"+n+"inputurl']").attr("value"),r=t.find("input[name='"+n+"inputsize']").attr("value"),o=t.find("select[name='"+n+"logolang']").val(),l=t.find("input[name='"+n+"embedded']").first(),d=t.find("input[name='"+n+"logoraw']").attr("value");e="0"===o?"unspec":o;var c,u='<input type="hidden" name="f[uii]['+n+"sso][logo][n"+i+'][size]" value="'+r+'">',p='<input type="hidden" name="f[uii]['+n+"sso][logo][n"+i+'][lang]" value="'+o+'">',f=$("li#nlogo"+n+"row"),m=f.clone(!0);m.removeAttr("id"),null!==l&&l.is(":checked")&&"embedded"===l.val()&&void 0!==d&&null!==d&&""!==d?(c='<input type="hidden" name="f[uii]['+n+"sso][logo][n"+i+'][url]" value="'+d+'">',m.find("img").first().attr("src",d).append(c).append(u).append(p),m.find("div.logoinfo").first().append(""+e+"<br />").append(r+"<br />")):(c='<input type="hidden" name="f[uii]['+n+"sso][logo][n"+i+'][url]" value="'+s+'">',m.find("img").first().attr("src",s).append(c).append(u).append(p),m.find("div.logoinfo").first().append(""+e+"<br />").append(s+"<br />").append(r+"<br />")),m.insertBefore(f).show()}),$("button.getlogo").click(function(){var e,t,a,i,n=$(this).attr("name"),s=$(this).attr("value");"idpgetlogo"===n?(i=$("#idpreviewlogo"),i.hide(),e=$("small.idplogoretrieve"),e.empty().hide(),a=$("[name='idplogoretrieve']").val(),t=$("#idpreviewlogo").find("div.imgsource").first()):(i=$("#spreviewlogo"),i.hide(),e=$("small.splogoretrieve"),e.empty().hide(),a=$("[name='splogoretrieve']").val(),t=$("#spreviewlogo").find("div.imgsource").first());var r=$("[name='csrfname']").val(),o=$("[name='csrfhash']").val(),l=[{name:r,value:o},{name:"logourl",value:a}];$.ajax({type:"POST",url:s,cache:!1,data:l,dataType:"json",success:function(a){if(a)if(a.error)e.append(a.error).show();else if(a.data){var s=a.data,r=new Image;r.onload=function(){},r.src=s.url;var o,l,d,c,u=s.width+"x"+a.data.height;genRandomStr(5);"idpgetlogo"===n?(d='<input type="hidden" name="logotype" value="idp">',o='<input type="hidden" name="idpinputurl" value="'+a.data.url+'">',l='<input type="hidden" name="idpinputsize" value="'+u+'">',c='<input type="hidden" name="idplogoraw" value="'+a.data.raw+'">',t.empty().append(r).append(o).append(l).append(d).append(c),$("div#idpreviewlogo div.logoinfo").empty().append(u),i.show()):"spgetlogo"===n&&(d='<input type="hidden" name="logotype" value="idp">',o='<input type="hidden" name="spinputurl" value="'+a.data.url+'">',l='<input type="hidden" name="spinputsize" value="'+u+'">',c='<input type="hidden" name="splogoraw" value="'+a.data.raw+'">',t.empty().append(r).append(o).append(l).append(d).append(c),$("div#spreviewlogo div.logoinfo").empty().append(u),i.show())}}})}),n.on("click","button.contactrm",function(e){var t=($(this).attr("value"),$(this).attr("name"),$(this).closest("div.group"));t.remove()}),n.on("click","button.certificaterm",function(e){var t=($(this).attr("value"),$(this).attr("name"),$(this).closest("div.certgroup"));t.remove()}),n.on("click","input.acsdefault",function(e){$(this).is(":checked")&&$(".acsdefault").not(this).removeAttr("checked")}),n.on("click","button.rmfield",function(e){var t=$(this).closest("div.srvgroup");$(this).attr("value"),$(this).attr("name");t.find("input").each(function(){$(this).attr("value","")}),t.find("textarea").each(function(){$(this).val("")}),t.remove()}),n.on("click","button.langinputrm",function(e){var t=$(this).closest("div").parent(),a=$(this).attr("value"),i=$(this).closest("div.group").find("select").first();return t.find("input").each(function(){$(this).attr("value","")}),t.find("textarea").each(function(){$(this).val("")}),i.find("option[value="+a+"]").each(function(){$(this).toggleOption(!0),$(this).attr("disabled",!1)}),t.remove(),!1})}$("#spmatrixload").on("click",function(e){var t=$(this),a=$(this).attr("data-jagger-ajaxurl"),i=$(document).find("#spmatrixdiv").first();$.ajax({type:"GET",url:a,cache:!1,dataType:"json",beforeSend:function(){spinImage.show()},success:function(e){if(spinImage.hide(),e){var a=e.attrs,n=e.data,s=e.providerprefurl,r='<div><span class="den">&nbsp;&nbsp;&nbsp;</span> <span>denied</span></div><div><span class="perm">&nbsp;&nbsp;&nbsp;</span><span>permitted</span></div><div><span class="dis">&nbsp;&nbsp;&nbsp;</span><span>not supported</span></div><div><span>R</span>-<span>required</span></div><div><span>D</span>-<span>desired</span></div>',o=0,l='<table class="table table-header-rotated" id="idpmatrixresult"><thead><tr>';l+='<th style="background: white">'+r+"</th>",$.each(a,function(e,t){l+='<th class="rotate"><div><span>'+e+"</span></div></th>",o++}),o>52&&$("#container").css({"max-width":"100%"});var d,c,u;l+="</tr></thead><tbody>",$.each(n,function(e,t){l+='<tr><td data-jagger-entidlink="'+t.idpid+'" class="searchcol"><a href="'+s+"/"+t.idpid+'" title="'+t.entityid+'" >'+t.name+'</a><span class="hidden">'+e+"</span></td>",$.each(a,function(e,a){u="",c=t.data.attributes[""+e],d=a[0].toUpperCase(),void 0===c?u="dis":0===c?u="den":1===c?u="R"===d?"perm":"den":2===c&&(u="perm"),l+='<td class="'+u+'">',l+=d+"</td>"})}),l+="</tbody></table>",t.hide(),i.html(l)}},error:function(){spinImage.hide()}})});var f;if($("#attrpols").length>0){var m=$("#attrpols").first(),v=$("#attrpolstab").first(),h=function(){v.foundation("_handleTabChange",$("li.tabs-title.is-active"))},g=$("#arpmaddspecattr").first();f=m.attr("data-jagger-providerdetails");var b;v.on("change.zf.tabs",function(e,t){var a='<div class="progress"><span class="meter" style="width: 10%"></span></div>',i=$($.parseHTML(a)),n=i.find("span.meter").first(),s=$("#addattrsupport").clone(!0),r=$("#addentcatattr").clone(!0),o=$("#addespecattr").clone(!0);console.log(e,t);var l=$(t).attr("data-reveal-ajax-tab");if(void 0===l)return!1;var d,c=m.find("section.is-active").first();$.ajax({url:l,method:"GET",dataType:"json",beforeSend:function(){spinImage.show()},success:function(e){spinImage.hide(),n.css("width","100%");var t,a,i,l=[];if("supported"===e.type)$.each(e.data.support,function(e,t){l.push(t)}),d='<div class="small-12 column"><table class="table"><thead><tr>',$.each(e.definitions.columns,function(e,t){d+="<th>"+t+"</th>"}),d+="</tr></thead>",$.each(e.data.global,function(n,s){i=parseInt(s),a="",d+="<tr><td>"+e.definitions.attrs[n]+"</td><td>",d+=0===i?'<span class="label alert">'+e.definitions.policy[s]+"</span>":1===i?'<span class="label warning">'+e.definitions.policy[s]+"</span>":2===i?'<span class="label success">'+e.definitions.policy[s]+"</span>":'<span class="label">'+e.definitions.policy[s]+"</span>",t=l.indexOf(parseInt(n));var r="1";-1===t&&(a='&nbsp;<span class="label alert">'+e.definitions.policy[1e3]+"</span>",r="0"),d+=a,d+="</td><td>",d+='<a href="#" class="modalconfirm" data-jagger-attrpolicy="'+s+'" data-jagger-attrsupport="'+r+'" data-jagger-attrname="'+e.definitions.attrs[n]+'" data-jagger-attrid="'+n+'" data-jagger-action="edit" data-jagger-arp="global"><i class="fa fa-pencil"></i></a>',-1===t&&(d+='&nbsp;&nbsp;&nbsp;<a href="#" class="modalconfirm" data-jagger-attrsupport="'+r+'" data-jagger-attrname="'+e.definitions.attrs[n]+'" data-jagger-attrid="'+n+'" data-jagger-action="delete" data-jagger-arp="global"><i class="fa fa-trash alert"></i></a>'),d+="</td></tr>"}),d+="</table></div>",s.show().prependTo(c.html(d));else if("federation"===e.type){$.each(e.data.support,function(e,t){l.push(t)});var u,p,f=0,m=e.definitions.lang.federation;d='<div class="small-12 column"><table class="table"><thead><tr>',$.each(e.definitions.columns,function(e,t){f+=1,d+="<th>"+t+"</th>"}),d+="</tr></thead>";var v,h=f-2,g=e.definitions.statusstr;$.each(e.data.fedpols,function(a,i){var n=l.slice(0);b=parseInt(a),v=e.data.activefeds.indexOf(b),d+=-1===v?'<tr><td colspan="'+f+'" class="highlight">'+m+": "+e.definitions.feds[a]+' <span class="label alert">'+g.inactive+"</span></td></tr>":'<tr><td colspan="'+f+'" class="highlight">'+m+": "+e.definitions.feds[a]+"</td></tr>",$.each(i,function(i,s){p="",u=parseInt(s),t=n.indexOf(parseInt(i)),0===u?p="alert":1===u?p="warning":2===u&&(p="success"),d+="<tr><td>"+e.definitions.attrs[i]+'</td><td><span class="label '+p+'">'+e.definitions.policy[s]+"</span>",-1===t?d+='&nbsp;<span class="label alert">'+e.definitions.lang.unsupported+"</span>":n.splice(t,1),d+='</td><td></td><td colspan="'+h+'"><a href="#" class="modalconfirm" data-jagger-attrpolicy="'+s+'" data-jagger-arp="fed" data-jagger-action="edit" data-jagger-fedid="'+a+'" data-jagger-attrid="'+i+'" data-jagger-attrname="'+e.definitions.attrs[i]+'"><i class="fa fa-pencil"></i></a></td></tr>'}),$.each(n,function(t,i){d+="<tr><td>"+e.definitions.attrs[i]+'</td><td><span class="label secondary">'+e.definitions.policy[100]+'</span></td><td></td><td colspan="'+h+'"><a href="#" class="modalconfirm" data-jagger-arp="fed" data-jagger-attrname="'+e.definitions.attrs[i]+'" data-jagger-attrpolicy="100" data-jagger-fedid="'+a+'" data-jagger-action="edit" data-jagger-attrid="'+i+'"><i class="fa fa-pencil"></i></a></td></tr>'})}),d+="</table></div>",c.html(d)}else if("entcat"===e.type){f=0,p="";var y,t,w,x=e.definitions.ecmembers;$.each(e.data.support,function(e,t){l.push(t)}),d='<div class="small-12 column"><table class="table"><thead><tr>',$.each(e.definitions.columns,function(e,t){f+=1,d+="<th>"+t+"</th>"}),d+="</tr></thead>",$.each(e.data.entcats,function(a,i){d+='<tr><td colspan="'+f+'" class="highlight">EntityCategory: '+e.definitions.entcats[a].name+"  "+e.definitions.entcats[a].value+' <i class="ecmembers fa fa-list"  data-jagger-jsource="'+x+"/"+a+'"></i></td></tr>',$.each(i,function(i,n){w="",t=l.indexOf(parseInt(i)),-1===t&&(w='&nbsp;<span class="label alert">'+e.definitions.policy[1e3]+"</span>"),p="",y=parseInt(n),0===y?p="alert":1===y?p="warning":2===y&&(p="success"),d+="<tr>",d+="<td>"+e.definitions.attrs[i]+'</td><td><span class="label '+p+'">'+e.definitions.policy[n]+"</span>"+w+'</td><td><a href="#" class="modalconfirm" data-jagger-arp="entcat" data-jagger-entcatid="'+a+'" data-jagger-attrid="'+i+'" data-jagger-arp="entcat" data-jagger-action="edit" data-jagger-attrname="'+e.definitions.attrs[i]+'" data-jagger-attrpolicy="'+n+'"><i class="fa fa-pencil"></i></a></td>',d+="</tr>"})}),d+="</table></div>",r.show().prependTo(c.html(d))}else if("sp"===e.type){f=1,d='<div class="small-12 column"><table class="table"><thead><tr>',$.each(e.definitions.columns,function(e,t){f+=1,d+="<th>"+t+"</th>"}),d+="</tr></thead>",$.each(e.data.supported,function(e,t){l.push(t)});var j,k,T,S,C=(e.data.sps,{0:"alert",1:"warning",2:"success",100:"secondary"}),I='<span class="label alert">'+e.definitions.policy[1e3]+"</span>";$.each(e.data.sps,function(a,i){var n=[];if(void 0!==i.req&&$.each(i.req,function(e,t){n[e]=t}),!$.isEmptyObject(i.spec)){void 0!==i.entityid?d+='<tr><td data-jagger-entidlink="'+a+'" colspan="'+f+'" class="highlight" >'+i.entityid+"</td></tr>":e.definitions.sps.hasOwnProperty(a)?d+='<tr><td data-jagger-entidlink="'+a+'" colspan="'+f+'" class="highlight">'+e.definitions.sps[a].entityid+' <span class="label alert">disabled</span></td></tr>':console.log("undefined "+a+" in data.definitions.sps"),$.each(i.spec,function(s,r){S="",T="",t=l.indexOf(parseInt(s)),-1===t&&(T=I),k=e.data.definitions.attrs[s],j="100",void 0!==n[s]&&(j=n[s],delete n[s]),void 0!==i.custom&&void 0!==i.custom[s]&&(void 0!==i.custom[s].deny?(S+='<span class="label alert">denied values:  ',
$.each(i.custom[s].deny,function(e,t){S+=t+", "}),S+="</span>"):(S+='<span class="label success">permited values: ',$.each(i.custom[s].permit,function(e,t){S+=t+", "}),S+="</span>")),d+="<tr><td>"+k+'</td><td><span class="label '+C[r]+'">'+e.definitions.policy[r]+"</span>  "+T+" "+S+"</td><td>"+e.definitions.req[j]+'</td><td><a href="#" class="modalconfirm" data-jagger-attrpolicy="'+r+'" data-jagger-entityid="'+e.definitions.sps[a].entityid+'" data-jagger-attrname="'+k+'" data-jagger-spid="'+a+'" data-jagger-arp="sp" data-jagger-action="edit" data-jagger-attrid="'+s+'"><i class="fa fa-pencil"></i></a></td></tr>'});for(var s in n)S="",void 0!==i.custom&&void 0!==i.custom[s]&&(void 0!==i.custom[s].deny?(S+='<span class="label alert">denied values:  ',$.each(i.custom[s].deny,function(e,t){S+=t+", "}),S+="</span>"):(S+='<span class="label success">permited values: ',$.each(i.custom[s].permit,function(e,t){S+=t+", "}),S+="</span>")),T="",t=l.indexOf(parseInt(s)),-1===t&&(T=I),k=e.data.definitions.attrs[s],n.hasOwnProperty(s)&&(d+="<tr><td>"+k+'</td><td><span class="label '+C[100]+'">'+e.definitions.policy[100]+"</span>  "+T+" "+S+"</td><td>"+e.definitions.req[n[s]]+'</td><td><a href="#" class="modalconfirm" data-jagger-attrpolicy="100" data-jagger-entityid="'+e.definitions.sps[a].entityid+'" data-jagger-attrname="'+k+'" data-jagger-spid="'+a+'" data-jagger-arp="sp" data-jagger-action="edit" data-jagger-attrid="'+s+'"><i class="fa fa-pencil"></i></i></td></tr>')}}),d+="</table></div>",o.show().prependTo(c.html(d))}},error:function(e,t,a){spinImage.hide(),c.html('<div data-aler class="alert-box alert">'+e.responseText+"</div>")}})}),m.on("click","td.highlight",function(e){var t=$(this).attr("data-jagger-entidlink");return void 0!==t?(document.location.href=f+"/"+t,!1):void 0}),m.on("click","a.modalconfirm",function(e){e.preventDefault();var t,a=$(this),i=a.attr("data-jagger-arp"),n=a.attr("data-jagger-action"),s=a.attr("data-jagger-attrname"),r=a.attr("data-jagger-attrid"),o=a.attr("data-jagger-fedid"),l=a.attr("data-jagger-entcatid"),d=a.attr("data-jagger-attrsupport"),c=a.attr("data-jagger-attrpolicy"),u=a.attr("data-jagger-spid"),p=a.attr("data-jagger-entityid");$("[name='baseurl']").val();if(void 0!==i&&void 0!==n)if("global"===i&&"delete"===n)t=$("#arpmdelattr"),t.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find('input[name="attrname"]').first().val(s),t.find('input[name="attrid"]').first().val(r),t.find("span.attributename").first().html(s),t.foundation("open");else if("global"===i&&"edit"===n){t=$("#arpmeditglobalattr"),t.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find("span.attributename").first().html(s),t.find('input[name="attrname"]').first().val(s),t.find('input[name="attrid"]').first().val(r);var f=t.find('input[name="support"]').first();"1"===d?f.prop("checked",!0):f.prop("checked",!1),t.find('[name="policy"] option').prop("selected",!1).filter('[value="'+c+'"]').prop("selected",!0),t.foundation("open")}else if("fed"===i&&"edit"===n)t=$("#arpmeditfedattr"),t.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find("span.attributename").first().html(s),t.find('input[name="attrid"]').first().val(r),t.find('input[name="fedid"]').first().val(o),t.find('[name="policy"] option').prop("selected",!1).filter('[value="'+c+'"]').prop("selected",!0),t.foundation("open");else if("entcat"===i&&"edit"===n)t=$("#arpmeditentcatattr"),t.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find("span.attributename").first().html(s),t.find('input[name="attrid"]').first().val(r),t.find('input[name="entcatid"]').first().val(l),t.find('[name="policy"] option').prop("selected",!1).filter('[value="'+c+'"]').prop("selected",!0),t.foundation("open");else if("sp"===i&&"edit"===n){t=$("#arpmeditspattr"),t.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find("span.attributename").first().html(s),t.find("span.requestersp").first().html(p),t.find('input[name="attrid"]').first().val(r),t.find('input[name="spid"]').first().val(u),t.find('[name="policy"] option').prop("selected",!1).filter('[value="'+c+'"]').prop("selected",!0);var m=t.attr("data-jagger-getdata"),v=t.find("form").first(),h=v.serializeArray(),g=(v.find('[name="custompolicy"]').first(),v.find('[name="customvals"]').first()),b=v.find('[name="customenabled"]').first();g.empty();var y="";b.prop("checked",!1),$.ajax({url:m,method:"POST",dataType:"json",data:h,success:function(e){e.data&&void 0!==e.data.customsp&&(e.data.customsp.deny?(b.prop("checked",!0),v.find('[name="custompolicy"] option').prop("selected",!1).filter('[value="deny"]').prop("selected",!0),$.each(e.data.customsp.deny,function(e,t){y+=t+", "})):e.data.customsp.permit&&(b.prop("checked",!0),v.find('[name="custompolicy"] option').prop("selected",!1).filter('[value="permit"]').prop("selected",!0),$.each(e.data.customsp.permit,function(e,t){y+=t+", "})),g.text(y))}}),t.foundation("open")}}),$("#arpmdelattr").on("click","div.yes",function(e){var t=$("#arpmdelattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmdelattr").foundation("close"),h()}})}),$("#arpmeditglobalattr").on("click","div.yes",function(e){var t=$("#arpmeditglobalattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmeditglobalattr").foundation("close"),h()},error:function(e,t,a){$("#arpmeditglobalattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),m.on("click","#addattrsupport button",function(e){var t=$("#addattrsupport").attr("data-jagger-link");$.ajax({url:t,method:"GET",dataType:"json",success:function(e){if(e.data.support){var t=$("#arpmaddattr").find("select[name='attrid']");t.find("option").removeAttr("disabled"),$.each(e.data.global,function(e,a){t.find("option[value="+e+"]").prop("disabled","disabled")})}}}),$("#arpmaddattr").foundation("open")}),m.on("click","#addentcatattr button",function(e){var t=$("#addentcatattr").attr("data-jagger-link");$.ajax({url:t,method:"GET",dataType:"json",success:function(e){var t=$("#arpmaddentcatattr").find("select[name='attrid']");t.empty();var a=$("#arpmaddentcatattr").find("select[name='entcatid']");a.empty(),e.data.support&&$.each(e.data.support,function(a,i){t.append($("<option></option>").attr("value",i).text(e.definitions.attrs[i]))}),e.data.entcats&&$.each(e.data.entcats,function(e,t){a.append($("<option></option>").attr("value",t.entcatid).text(t.value))})}}),$("#arpmaddentcatattr").foundation("open")}),m.on("click","#addespecattr button",function(e){var t=$("#addespecattr").attr("data-jagger-link"),a=g,i=a.find('[name="customvals"]').first();i.empty(),a.find("div.response").first().removeClass("alert").removeClass("alert-box").empty().hide();var n=a.find("select[name='attrid']");n.empty().append($("<option></option>").attr("value","0").text(""));var s=a.find("select[name='spid']");s.empty().append($("<option></option>").attr("value","0").text("")),$.ajax({url:t,method:"GET",dataType:"json",success:function(e){e.members&&$.each(e.members,function(e,t){s.append($("<option></option>").attr("value",t.pid).text(t.name+" ("+t.entityid+")"))}),e.attrs&&$.each(e.attrs,function(e,t){n.append($("<option></option>").attr("value",t.attrid).text(t.name))})}}),a.foundation("open"),s.select2({width:"100%"}),n.select2({width:"100%"})}),$("#arpmaddattr").on("click","div.yes",function(e){var t=$("#arpmaddattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmaddattr").foundation("close"),h()},error:function(e,t,a){$("#arpmaddattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),$("#arpmeditfedattr").on("click","div.yes",function(e){var t=$("#arpmeditfedattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmeditfedattr").foundation("close"),h()},error:function(e,t,a){$("#arpmeditfedattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),g.on("change","select",function(e){var t=$(this).attr("name");(void 0===t||"spid"!==t&&"attrid"!==t)&&console.log("TT"),"spid"===t&&console.log("DDDDDDDDDDDD")}),g.on("click","div.yes",function(e){var t=g,a=t.find(".response").first();a.empty().removeClass("alert").removeClass("alert-box").hide();var i=t.find("form").first(),n=i.serializeArray(),s=i.attr("action");$.ajax({url:s,method:"POST",dataType:"json",data:n,success:function(e){a.empty().removeClass("alert").removeClass("alert-box").hide(),t.foundation("close"),h()},error:function(e,t,i){a.html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),$("#arpmeditspattr").on("click","div.yes",function(e){var t=$("#arpmeditspattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmeditspattr").foundation("close"),h()},error:function(e,t,a){$("#arpmeditspattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),$("#arpmeditentcatattr").on("click","div.yes",function(e){var t=$("#arpmeditentcatattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmeditentcatattr").foundation("close"),h()},error:function(e,t,a){$("#arpmeditentcatattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),$("#arpmaddentcatattr").on("click","div.yes",function(e){var t=$("#arpmaddentcatattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmaddentcatattr").foundation("close"),h()},error:function(e,t,a){$("#arpmaddentcatattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})})}var y=$("#matrixloader").first(),w=$("#idpmatrixdiv").first(),x=$("#policyupdater").first();if(1===y.length){var j,k=x.attr("data-jagger-link"),T=x.find("form").first(),f=y.attr("data-jagger-providerdetails"),S=x.find("span.mrequester").first(),C=x.find("span.mattribute").first(),I=(x.find("div.yes").first(),x.find("div.attrflow").first());x.on("click",".yes",function(e){e.preventDefault();var t=T.attr("action");$.ajax({type:"POST",url:t,data:T.serializeArray(),success:function(e){if(x.foundation("close"),!j.hasClass("dis")){var t=$.trim(j.text());"2"===e&&("R"===t||"D"===t)||"1"===e&&"R"===t?j.attr("class","perm"):"2c"===e&&("R"===t||"D"===t)||"1c"===e&&"R"===t?j.attr("class","spec"):"1"===e&&"D"===t||"0"===e?j.attr("class","den"):("1c"===e&&"D"===t||"0c"===e)&&j.attr("class","den")}}})}),w.on("click","td",function(e){spinImage.show(),j=$(this);var t=j.attr("data-jagger-entidlink");if(void 0!==t)return document.location.href=f+"/"+t,!1;var a=j.attr("data-jagger-spid"),i=j.attr("data-jagger-attrid");void 0!==a&&void 0!==i&&$.ajax({type:"GET",url:k+"/"+a+"/"+i,cache:!1,dataType:"json",success:function(e){T.find("select[name='policy']").prop("selected",!1).filter('[value=""]').prop("selected",!0),T.find("input[name='attribute']").first().val(e.attributename),T.find("input[name='requester']").first().val(e.requester),S.html(e.requester),C.html(e.attributename);var t=$("<tbody></tbody>"),a='<thead><tr><th colspan="2">Current attribute flow</th></tr></thead>';$.each(e.details,function(e,a){var i="<tr><td>"+a.name+"</td><td>"+a.value+"</td></tr>";t.append(i)});var i=$("<table/>").css({"font-size":"smaller"}).addClass("detailsnosort").addClass("small-12").addClass("columns"),n=$("<div/>");i.append(a),i.append(t),n.append(i),I.html(n.html()),x.foundation("open"),spinImage.hide()}})});var A=y.attr("data-jagger-link");if("undefined"==typeof A)return!1;$.ajax({type:"GET",url:A,cache:!1,dataType:"json",success:function(e){if(spinImage.hide(),e){var t,a=new Date,i='<div><span class="den">&nbsp;&nbsp;&nbsp;</span> <span>denied</span></div><div><span class="perm">&nbsp;&nbsp;&nbsp;</span> <span>permitted</span></div><div><span class="dis">&nbsp;&nbsp;&nbsp;</span> <span>not supported</span></div><div><span>R</span> <span>required</span></div><div><span>D</span> <span>desired</span></div>',n=e.attributes,s=e.policies,r=e.total,o=e.message;if(void 0!==r&&0===r&&void 0!==o){var l='<div class="small-12 medium-11 columns small-centered"><div data-alert class="alert-box warning">'+o+"</div></div>";return w.html(l),!1}var d=0,c='<table class="table table-header-rotated" id="idpmatrixresult"><thead><tr>';c+='<th style="background: white">'+i+"</th>",$.each(n,function(e,t){c+='<th class="rotate"><div><span>'+e+"</span></div></th>",d++}),d>52&&$("#container").css({"max-width":"100%"});var u,p,f;c+="</tr></thead><tbody>",$.each(s,function(e,a){c+='<tr><td data-jagger-entidlink="'+a.spid+'" class="searchcol"><span data-tooltip aria-haspopup="true" class="has-tip" data-options="disable_for_touch:true" title="'+e+'" >'+a.name+'</span><span class="hidden">'+e+"</span></td>",$.each(n,function(e,i){p=null,f=void 0!==a.attributes[e]?a.attributes[e]:null,void 0!==a.req[e]&&(p=a.req[e]),u=null!==p?p[0].toUpperCase():"",t=null!==f?0===f?"den":1===f?void 0!==a.custom[e]?"spec":"perm":"dis":"dis",c+='<td data-jagger-spid="'+a.spid+'" data-jagger-attrid="'+i+'" class="'+t+'" title="'+e+'">',c+=u+"</td>"})}),c+="</tbody></table>";var m=new Date,v=m-a;console.log("time of generating matrix: "+v),w.html(c);var h=new Date;v=h-m,console.log("time of input matrinx into DOM: "+v),$("#idpmatrixresult").searcher({inputSelector:"#tablesearchinput",textSelector:".searchcol"})}},beforeSend:function(){spinImage.show()},error:function(e,t,a){spinImage.hide();var i='<div class="small-12 medium-11 columns small-centered"><div data-alert class="alert-box error">'+a+"</div></div>";return w.html(i),!1}})}if($("#fedarptab").length>0){var R,D=$("#fedarptab").find("table").first(),O=$("#fedpolicyupdater"),z=$("#fedpolicyupdater").find("form").first(),_=O.find("input[name='attribute']").first(),P=O.find("input[name='fedid']").first(),L=O.find("select[name='policy']").first(),E=O.attr("data-jagger-link"),M=O.find("span.dynamicval").first();D.on("click","a",function(e){e.preventDefault();var t=$(this).closest("tr");R=t.find("span.dynstate").first();var a=$(this).attr("data-jagger-attrid"),i=$(this).attr("data-jagger-attrname"),n=$(this).attr("data-jagger-fedid");_.val(a),P.val(n),$.ajax({type:"GET",url:E+"/"+n+"/"+a,cache:!1,dataType:"json",success:function(e){L.find("option:selected").prop("selected",!1),L.find("option[value="+e.policy+"]").prop("selected",!0),M.html(i),O.foundation("open")},error:function(){alert("error")}})}),O.on("click",".yes",function(e){e.preventDefault();var t=z.attr("action"),a=z.serializeArray();$.ajax({type:"POST",url:t,data:a,dataType:"json",success:function(e){modal.foundation("close"),R.html(e.policystr)}})})}var q=$("#showhelps");q.length&&(q.hasClass("helpactive")?$(".dhelp").show():$(".dhelp").hide());var B=$("#fedlogin").first(),G=B.attr("href"),F=new Date,N=-F.getTimezoneOffset();if(B.attr("href",""+G+"/"+N),$("#fedcategories li.active").length){var W=$("#fedcategories li.active").find("a").first().attr("href"),K=$("table.fedistpercat");$.ajax({url:W,timeout:2500,cache:!0,dataType:"json",value:$("table.fedistpercat"),success:function(e){spinImage.hide(),e?($("table.fedistpercat tbody tr").remove(),$.each(e,function(e,t){var a="<tr><td>"+t.name+"</td><td>"+t.urn+"</td><td>"+t.labels+"</td><td>"+t.desc+"</td><td>"+t.members+"</td></tr>";K.append(a)})):window.alert("no data in federation category")}})}$(".fedcategory").on("click","",function(e){$(this).closest("ul").find("li").removeClass("active"),$(this).closest("li").addClass("active");var t=$(this).attr("href"),a=$("table.fedistpercat");return $.ajax({url:t,timeout:2500,cache:!0,dataType:"json",value:a,success:function(e){spinImage.hide(),e?($("table.fedistpercat tbody tr").remove(),$.each(e,function(e,t){var i="<tr><td>"+t.name+"</td><td>"+t.urn+"</td><td>"+t.labels+"</td><td>"+t.desc+"</td><td>"+t.members+"</td></tr>";a.append(i)})):window.alert("no data in federation category")},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("problem with loading data")}}).done(function(){a.html()}),!1}),$(".userlogout").on("click",function(e){var t=$("[name='baseurl']").val(),a=$(this).attr("jagger-data-logout"),i=$(this).attr("href"),n=t;return null===t&&(n=i),null!==a&&""!==a&&$.ajax({type:"GET",url:a,cache:!1}),$.ajax({type:"GET",url:i,cache:!1,success:function(){window.location.href=n}}),!1})}),$(function(){var e=$("#filter"),t=$("#filter-form");$("div.floating-menu").addClass("mobilehidden"),$("table.idplist tr td:first-child").addClass("homeorg"),$("table.idplist tr td:first-child span.alert").removeClass("alert").parent().addClass("alert");var a=$("table.filterlist");a.find("tbody > tr").find("td:eq(1)").mousedown(function(){}),e.keyup(function(){$.uiTableFilter(a,this.value)}),t.submit(function(){return a.find("tbody > tr:visible > td:eq(1)").mousedown(),!1}).focus(),$("table.splist tr td:first-child span.alert").removeClass("alert").parent().addClass("alert");var i=$("table.splist");i.find("tbody > tr").find("td:eq(1)").mousedown(function(){}),e.keyup(function(){$.uiTableFilter(i,this.value)}),t.submit(function(){return i.find("tbody > tr:visible > td:eq(1)").mousedown(),!1}).focus(),$(".datepicker").datepicker({dateFormat:"yy-mm-dd"});var n=$("[name='baseurl']").val();void 0===n&&(n=""),$.ajaxSetup({cache:!1});var s=$("#qcounter");if(s.length>0){var r=s.attr("data-jagger-src"),o=sessionStorage.getItem("jaggerqcounter");null!==o&&s.html(parseInt(o));var l=function(){var e=$("#dashresponsecontainer").first();$.ajax({url:r,method:"GET",cache:!1,dataType:"json",success:function(t){var a=0;if(t.data&&$.each(t.data,function(e,t){a+=t.length}),sessionStorage.setItem("jaggerqcounter",a),s.html(a),e){var i=[];if(t.definitions){var r=t.definitions;i.push('<table id="detailsi" class="itablesorter"><thead><tr><th>'+r.date+"</th><th>"+r.requester+"</th><th>"+r.requesttype+"</th><th></th></tr><thead><tbody>")}else i.push('<table id="detailsi" class="itablesorter"><thead><tr><th>Date</th><th>Requester</th><th>Request type</th><th></th></tr><thead><tbody>');t.data.q&&$.each(t.data.q,function(e,t){i.push("<tr><td>"+t.idate+"</td><td>"+t.requesterCN+" "+t.mail+"</td><td>"+t.type+" - "+t.action+'</td><td><a href="'+n+"reports/awaiting/detail/"+t.token+'"><i class="fa fa-arrow-right"></i></a></td></tr>')}),t.data.s&&$.each(t.data.s,function(e,t){i.push("<tr><td>&nbsp;</td><td>"+t.subscriber+" &lt"+t.subscriber_email+"&gt;</td><td>"+t.type+'</td><td><a href="'+t.url+'"><i class="fa fa-arrow-right"></i></a></td></tr>')}),i.push("</tbody></table>");var o=i.join("");e.html(o)}},error:function(){if(e){var t='<div data-alert class="alert-box alert center">Could not refresh queue</div>';e.html(t)}}})};setTimeout(l,1e3);setInterval(l,3e4)}$("#responsecontainer").load(n+"reports/awaiting/ajaxrefresh"),setInterval(function(){$("#responsecontainer").load(n+"reports/awaiting/ajaxrefresh")},172e3),$("#languageset").on("change","select",function(e){var t=$("div#languageset form").attr("action"),a=t+this.value;return $.ajax({url:a,timeout:2500,cache:!1}).done(function(){$("#languageset").foundation("close"),setTimeout(function(){go_to_private_page()},1e3)}),!1}),$("select.nuseraccesstype").on("change",function(){var e=$(this).find("option:selected"),t=e.val();"fed"===t?$("div.passwordrow").hide():$("div.passwordrow").show()}),$("button#idpadduiiprvurl").click(function(){var e=$("span.idpuiiprvurladd option:selected").val(),t=$("span.idpuiiprvurladd option:selected").text();$("span.idpuiiprvurladd option[value="+e+"]").remove(),$(this).parent().prepend('<li class="localized"><label for="f[[uii][idpsso][prvurl]['+e+']">'+t+'</label><input id="f[uii][idpsso][prvurl]['+e+']" name="f[uii][idpsso][prvurl]['+e+']" type="text"/></li>')}),$("button#spadduiiprvurl").click(function(){var e=$("span.spuiiprvurladd option:selected").val(),t=$("span.spuiiprvurladd option:selected").text();$("span.spuiiprvurladd option[value="+e+"]").remove(),$(this).parent().prepend('<li class="localized"><label for="f[[uii][spsso][prvurl]['+e+']">'+t+'</label><input id="f[uii][spsso][prvurl]['+e+']" name="f[uii][spsso][prvurl]['+e+']" type="text"/></li>')}),$("button#addlprivacyurl").click(function(){var e=$("li.addlprivacyurl option:selected").val(),t=$("li.addlprivacyurl option:selected").text();$("li.addlprivacyurl option[value="+e+"]").toggleOption(!1),$(this).parent().append('<li class="localized"><label for="lprivacyurl['+e+']">'+t+'</label><input id="lprivacyurl['+e+']" name="lprivacyurl['+e+']" type="text"/></li>')}),$("a#fedmetasigner").click(function(){var e=$(this),t=e.attr("href");return $.ajax({url:t,timeout:2500,cache:!1,success:function(e){alert(e)}}),!1}),$("a#providermetasigner").click(function(){var e=$(this),t=e.attr("href");return $.ajax({url:t,timeout:2500,cache:!1,success:function(e){window.alert(e)}}),!1}),$("a.downloadstat").click(function(){var e=$(this),t=e.attr("href");return $.ajax({url:t,timeout:2500,cache:!1,dataType:"json",success:function(e){e?window.alert(e.status):window.alert("no data")}}),!1}),$("a.lateststat").click(function(){var e,t=$(this),a=t.attr("href");$('<div id="#statisticdiag">');return $.ajax({url:a,timeout:2500,cache:!0,dataType:"json",success:function(t){e=null,spinImage.hide(),t?($("div#statisticdiag").replaceWith('<div id="statisticdiag"></div>'),$.each(t,function(e,t){e=new Image,e.src=t.url,$("#statisticdiag").append('<div style="text-align:center; font-weight: bold; width: 90%;">'+t.title+"</div>").append('<div style="font-weight: bolder; width: 90%; text-align: right;">'+t.subtitle+"</div>").append(e)})):window.alert("no data")},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("problem with loading data")}}),!1}),$("a.clearcache").click(function(){var e=$(this),t=e.attr("href");return $.ajax({type:"GET",url:t,timeout:2500,cache:!1,success:$(this).remove()}),!1}),$(".updatebookmark").on("click",function(e){var t=$(this).attr("href"),a=$(this),i=$(this).attr("data-jagger-bookmark"),n=$(this).closest("[data-jagger-onsuccess]"),s=n.attr("data-jagger-onsuccess");return void 0===t||void 0===i?!1:($.ajax({url:t+"/"+i,type:"GET",success:function(e){e&&"ok"===e&&(void 0!==s&&"hide"===s?n.hide():a.remove())}}),!1)}),$("table.reqattraddform").addClass("hidden"),$("button.hideform").addClass("hidden"),$("form.reqattraddform").addClass("hidden"),$("button.showform").click(function(){$("table.reqattraddform").removeClass("hidden"),$("form.reqattraddform").removeClass("hidden"),$("button.showform").addClass("hidden"),$("button.hideform").removeClass("hidden")}),$("button.hideform").click(function(){$("table.reqattraddform").addClass("hidden"),$("form.reqattraddform").addClass("hidden"),$("button.showform").removeClass("hidden"),$("button.hideform").addClass("hidden")}),$("#sortable").sortable(),$("div.nsortable").sortable(),$("#sortable").disableSelection()});var ww=document.body.clientWidth;$(document).ready(function(){$(".nav li a").each(function(){$(this).next().length>0&&$(this).addClass("parent")}),$(".toggleMenu").click(function(e){e.preventDefault(),$(this).toggleClass("active"),$(".nav").toggle()})}),$(document).on("click","a.refreshurl",function(e){e.preventDefault();var t=$(this).attr("data-jagger-getmoreajaxonclick"),a=$(this).attr("data-jagger-response-msg"),i=$(this);if(void 0===a||null===a)return console.log('attribute data-jagger-response-msg not found in element with data-jagger-getmoreajax="'+t+'" - exiting'),!1;console.log('attribute data-jagger-response-msg="'+a+'" in element data-jagger-getmoreajax="'+t+'"');var n=$("div#"+a);return void 0===n||null===n||0===$(n).length?(console.log('div with id="'+a+'" not found'),!1):(console.log('div with id="'+a+'" found'),void $.ajax({dataType:"json",type:"GET",url:t,cache:!0,success:function(e){if(!e)return console.log("no json got from "+t),!1;var a=e.length;if(1>a)return!1;var s=$("<div/>");$.each(e,function(e,t){s.append("<div>"+t.msg+"</div>")}),n.empty().append(i).append(s).show()}}))}),$(window).bind("resize orientationchange",function(){ww=document.body.clientWidth,adjustMenu()});var adjustMenu=function(){768>ww?($(".toggleMenu").css("display","inline-block"),$(".toggleMenu").hasClass("active")?$(".nav").show():$(".nav").hide(),$(".nav li").unbind("mouseenter mouseleave"),$(".nav li a.parent").unbind("click").bind("click",function(e){e.preventDefault(),$(this).parent("li").toggleClass("hover")})):ww>=768&&($(".toggleMenu").css("display","none"),$(".nav").show(),$(".nav li").removeClass("hover"),$(".nav li a").unbind("click"),$(".nav li").unbind("mouseenter mouseleave").bind("mouseenter mouseleave",function(){$(this).toggleClass("hover")}))};if($(function(){$("#details").tablesorter({sortList:[[0,0]],widgets:["zebra"]}),$(".userlist#details").tablesorter({sortList:[[4,1],[0,0]],widgets:["zebra"]}),$("#options").tablesorter({sortList:[[0,0]],headers:{3:{sorter:!1},4:{sorter:!1}}}),$("#logotabs").tabs({load:function(e,t){$("#availablelogos").unbind(),$("#assignedlogos").unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),GINIT.initialize()}})}),$("#usepredefined").attr("checked")&&$("fieldset#stadefext").hide(),$("#usepredefined").click(function(){$(this).is(":checked")?($("#usepredefined").not(this).removeAttr("checked"),$("fieldset#stadefext").hide()):($("fieldset#stadefext").show(),$("#usepredefined").not(this).addAttr("checked"))}),$("#nattrreqbtn").click(function(e){var t=genRandomStr(5),a=$('select[name="nattrreq"]'),i=a.find(":selected").text(),n=a.find(":selected").val(),s='<fieldset class="fieldset"><legend>'+i+'</legend><div class="small-12 columns"><div class="medium-3 columns medium-text-right"><select name="f[reqattr]['+t+'][status]"><option value="required">required</option><option value="desired">desired</option></select><input type="hidden" name="f[reqattr]['+t+'][attrname]" value="'+i+'"><input type="hidden" name="f[reqattr]['+t+'][attrid]" value="'+n+'"></div><div class="medium-6 columns"><textarea name="f[reqattr]['+t+'][reason]"></textarea></div><div class="medium-3 column end"><button class="btn reqattrrm inline left button alert" type="button" name="f[reqattr]['+t+']">Remove</button></div></div></fieldset>';return $(this).parent().parent().before(s),!1}),$(".pCookieAccept").on("click",function(){var e=$(this).attr("value");return $.ajax({url:e,timeout:2500}),$("#cookiesinfo").hide(),!1}),$("[id='f[entityid]']").change(function(){if($(this).hasClass("alertonchange")){var e=$("#entitychangealert").text();window.alert(e)}}),$(document).ready(function(){function e(e,t){var a=$("#sconfirm");a.find(".message").html(e+"&nbsp;"),a.on("open.zf.reveal",function(e){var i=a.find(".yes").first(),n=a.find(".no").first();i.off().on("click",function(){t.apply(),a.foundation("close")}),n.off().on("click",function(){a.foundation("close")})}),a.foundation("open")}var t=$("[name='baseurl']").val();void 0===t&&(t=""),$("#eds2").is("*")&&$("#idpSelect").modal({Height:"500px",minHeight:"500px"}),$("#vormversion").click(function(){return $.ajax({cache:!1,type:"GET",url:t+"smanage/reports/vormversion",success:function(e){spinImage.hide(),$("#rvormversion").show(),$("tr#rvormversion td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error occurred")}}),!1}),$("#vschema").click(function(){return $.ajax({cache:!1,type:"GET",url:t+"smanage/reports/vschema",success:function(e){spinImage.hide(),$("#rvschema").show(),$("tr#rvschema td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error ocured")}}),!1}),$("#vschemadb").click(function(){return $.ajax({cache:!1,type:"GET",url:t+"smanage/reports/vschemadb",success:function(e){spinImage.hide(),$("#rvschemadb").show(),$("tr#rvschemadb td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error ocured")}}),!1}),$("#vmigrate").click(function(){return $.ajax({cache:!1,type:"GET",url:t+"smanage/reports/vmigrate",success:function(e){spinImage.hide(),$("#rvmigrate").show(),$("tr#rvmigrate td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error ocured")}}),!1}),$("#vcerts").click(function(){var e,a=$(this).closest("div"),i=a.find("select").first();if(i){var n=i.find("option:selected");e=n.val()}var s="";return"localidp"!==e&&"extidp"!==e&&"localsp"!==e&&"extsp"!==e||(s="/"+e),$.ajax({cache:!1,type:"GET",url:t+"smanage/reports/expiredcerts"+s,dataType:"json",success:function(e){var t=e.data,a=e.definitions.baseurl,i=[],n=[];n.push("<table><tbody>"),$.each(t,function(e,t){t.alerts&&$.each(t.alerts,function(e,t){t.level?i.push('<div class="alert-box '+t.level+'" style="" data-alert="">'+t.msg+"</div>"):i.push("<div>"+t.msg+"</div>")}),n.push('<tr><td><a href="'+a+"providers/detail/show/"+t.id+'">'+t.entityid+"</a></td><td>"+i.join("")+"</td></tr>"),i=[]}),n.push("</tbody></table>");var e=n.join("");spinImage.hide(),$("#rvcerts").show(),$("tr#rvcerts td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error ocured")}}),!1}),$('button[name="fedstatus"]').click(function(t){var a=$(this).attr("value"),i=$(this).attr("title");void 0===i&&(i="");var n=$("[name='csrfname']").val(),s=$("[name='csrfhash']").val(),r=$("[name='baseurl']").val(),o=$("#fednameencoded").text(),l=r+"federations/fedactions/changestatus",d=[{name:"status",value:a},{name:n,value:s},{name:"fedname",value:o}];e(""+i,function(e){$.ajax({type:"POST",url:l,data:d,success:function(e){e&&("deactivated"===e?($('button[value="disablefed"]').hide(),$('button[value="enablefed"]').show(),$('button[value="delfed"]').show(),$("td.fedstatusinactive").show(),$("span.fedstatusinactive").show()):"activated"===e?($('button[value="disablefed"]').show(),$('button[value="enablefed"]').hide(),$('button[value="delfed"]').hide(),$("td.fedstatusinactive").hide(),$("span.fedstatusinactive").hide()):"todelete"===e&&($('button[value="disablefed"]').hide(),$('button[value="enablefed"]').hide(),$('button[value="delfed"]').hide()))},error:function(e){window.alert("Error  ocurred")}})})}),$("#rmstatdef").on("click","button",function(t){var a=$("form#rmstatdef").attr("action"),i=$("#rmstatdef").serialize();e("",function(e){$.ajax({type:"POST",url:a,data:i,success:function(e){revealAlert($("#resultdialog .message").html(),"ok")},error:function(e){window.alert("Error")}})}),t.preventDefault()}),$("#rmfedcategory").click(function(t){var a=$(this).closest("form");a.attr("action"),$(this).serialize();e("",function(e){$("<input>").attr({type:"hidden",id:"formsubmit",name:"formsubmit",value:"remove"}).appendTo("form"),a.submit()}),t.preventDefault()}),$("#rmfedvalidator").click(function(t){var a=$(this).closest("form");a.attr("action"),$(this).serialize();e("",function(e){$("<input>").attr({type:"hidden",id:"formsubmit",name:"formsubmit",value:"remove"}).appendTo("form"),a.submit()}),t.preventDefault()}),$(document).on("submit","#notificationaddform",function(e){e.preventDefault();var t=$(this);t.serializeArray();$.ajax({type:"POST",url:t.attr("action"),data:t.serializeArray(),success:function(e){$(".message").html(e),"OK"===e&&($("#notificationaddmodal").foundation("close"),location.reload())},error:function(e,t,a){window.alert("Error occured: "+a)}})}),$(document).on("open.zf.reveal","#notificationaddmodal",function(){$(this);$("select#sfederation").parent().hide(),
$("select#sprovider").parent().hide(),$("select#type").change(function(){$("select#sfederation").parent().hide(),$("select#sprovider").parent().hide();var e=$(this).find("option:selected"),a=e.val(),i=(e.text(),$("#sfederation")),n=$("#sprovider");i.find("option").remove(),n.find("option").remove(),"joinfedreq"===a||"fedmemberschanged"===a||"fedmembersmodified"===a?$.ajax({type:"GET",url:t+"ajax/getfeds",cache:!0,success:function(e){$.each(e,function(e,t){$("<option>").val(t.id).text(t.name).appendTo(i)}),$("select#sfederation").parent().show()},error:function(e,t,a){$(".message").html(a)}}):"requeststoproviders"!==a&&"providermodified"!==a||$.ajax({type:"GET",url:t+"ajax/getproviders",cache:!1,datatype:"json",success:function(e){$.each(e,function(e,t){$("<option>").val(t.key).text(t.value).appendTo(n)}),$("select#sprovider").parent().show()},error:function(e,t,a){$(".message").html(a)}})})})}),$(".submit").click(function(){return!1}),$("#joinfed").on("change","#fedid",function(e){$("div.validaronotice").hide(),$("ul.validatorbuttons").replaceWith('<ul class="button-group validatorbuttons"></ul>');var t=$("[name='csrfname']").val(),a=$("[name='csrfhash']").val();void 0===t&&(t=""),void 0===a&&(a="");var i=$(this).find("option:selected").val(),n=($(this).find("option:selected").text(),$("#retrfvalidatorjson").text()),s={};s[t]=a,s.fedid=i,0!==i&&$.ajax({type:"POST",url:n,timeout:2500,cache:!0,data:s,dataType:"json",success:function(e){if(spinImage.hide(),e){var t=$("ul.validatorbuttons");$.each(e,function(e,a){t.append('<li><button  value="'+n+"/"+a.fedid+"/"+a.id+'" class="button">'+a.name+"</button></li>")}),$("div.validaronotice").show()}},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),$("#fvform").hide(),$("#fvresult").hide()}}).done(function(){BINIT.initFvalidators()})}),$("#showhelps").click(function(e){e.preventDefault();var t=$(this).attr("href"),a="n";a=$("#showhelps").hasClass("helpactive")?"n":"y",$.ajax({type:"GET",url:t+"/"+a,success:function(){$("#showhelps").toggleClass("helpinactive").toggleClass("helpactive").toggleClass("active"),$(".dhelp").toggle()}})}),$("div.section").parent().addClass("section"),$("#notificationupdateform").on("submit",function(e){e.preventDefault();var t=$(this).serializeArray(),a=$(this).attr("action"),i=parseInt($("input[name=noteid]").val()),n=$('button[type="button"][value="'+i+'"]'),s=$(n).closest("tr"),r=s.find("div.subscrstatus:first");$.ajax({type:"POST",url:a,data:t,dataType:"json",success:function(e){if(e){var t=!1;$.each(e,function(e,a){t===!1&&parseInt(a.id)===i&&(t=!0,r.text(a.langstatus)),t===!1&&s.hide()})}$("#notificationupdatemodal").foundation("close"),location.reload()},error:function(e,t,a){window.alert("Error occured: "+a)}})}),$(document).on("submit","#loginform form",function(e){e.preventDefault();var t=$("#loginform"),a=$(t).find(":submit").first(),i=$(t).find("div.secondfactorrow").first(),n=$("div#loginform form").attr("action"),s=$(this).serializeArray(),r=new Date,o=-r.getTimezoneOffset();s.push({name:"browsertimeoffset",value:""+o});var l=$("[name='baseurl']").val();return $.ajax({type:"POST",cache:!1,timeout:3500,url:n,data:s,beforeSend:function(){$("#loginresponse").html("").hide()},success:function(e){e?e.success===!0&&"OK"===e.result?(t.foundation("close"),spinImage.show(),setTimeout(function(){window.location.href=l},1e3)):"secondfactor"===e.result&&($("#password").val(""),i.empty(),i.append(e.html).show(),a.prop("disabled",!0)):$("#loginresponse").html(e).show()},error:function(e,t,a){$("#loginresponse").html(e.responseText).show()}}),!1}),$("button.advancedmode").click(function(){var e=$("span.modalnotice").text(),t=$("textarea#metadatabody").val().trim();t.length<20&&window.alert(e);var a=$(this),i=a.val();$("[name='csrfname']").val(),$("[name='csrfhash']").val();$(this).closest("form").attr("action",i)}),$("#providerslistresultv2").length){var jnl=$("#providerslistresultv2").first(),url=jnl.attr("data-jagger-src");$.ajax({type:"GET",url:url,timeout:19500,cache:!0,dataType:"json",success:function(e){spinImage.hide();var t=e.definitions.lang,a=$("<table/>"),i=$("<thead/>"),n=$("<tfoot/>");a.append(i),a.append(n);var s=$("<tr/>"),r=$("<tr/>");i.append(s),n.append(r);var o,l=[],d=e.columns,c=0;s.append('<th class="header">s</th>'),r.append('<th class="header">s</th>'),$.each(d,function(e,t){if(o=t.status){var a=[];$.each(t.cols,function(e,t){a.push(t)}),l.push(a),s.append('<th class="header">'+t.colname+"</th>"),r.append('<th class="header">'+t.colname+"</th>"),c+=1}});var u,p=e.data,f=[];$.each(p,function(t,a){u=[],u.push(a.plocal),$.each(l,function(t,i){var n="";$.each(i,function(t,i){null!==a[i]&&("pname"===i?n=n+'<a href="'+e.baseurl+"providers/detail/show/"+a.pid+'">'+a[i]+"</a><br />":"phelpurl"===i?n=n+'<a href="'+a.phelpurl+'">'+a.phelpurl+"</a>":"plocked"===i||"pactive"===i||"plocal"===i||"pstatic"===i||"pvisible"===i||"pavailable"===i?void 0!==e.statedefs[i][a[i]]&&(n=n+' <span class="lbl lbl-'+i+"-"+a[i]+'">'+e.statedefs[i][a[i]]+"</span>"):"contacts"===i?$.each(a.contacts,function(e,t){n=n+'<span class="label">'+t.type.charAt(0).toUpperCase()+"</span> "+t.mail+"<br />"}):n=n+"  "+a[i])}),u.push(n.trim())}),f.push(u)}),jnl.append(a);var m=a.DataTable({dom:'<"text-right"lB><"text-left"i>frtip',buttons:[{text:t.btnexternal,className:"tiny"},{text:t.btnlocal,className:"tiny"},{className:"tiny",extend:"colvis",postfixButtons:["colvisRestore"],columns:":gt(1)"}],columnDefs:[{targets:[0],visible:!1,searchable:!0},{targets:[4],visible:!1}],order:[[1,"asc"]],paging:!0,stateSave:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],data:f,language:{lengthMenu:"Display _MENU_ records per page",zeroRecords:"Nothing found - sorry",infoEmpty:"No records available",infoFiltered:"(filtered from _MAX_ total records)",paginate:{next:t.next,previous:t.previous}},defereRender:!0});m.button(0).action(function(e,t,a,i){a.hasClass("active")?(this.active(!1),$("#entityc").val("").trigger("change")):(this.active(!0),m.button(1).active(!1),$("#entityc").val("external").trigger("change"))}),m.button(1).action(function(e,t,a,i){a.hasClass("active")?(this.active(!1),$("#entityc").val("").trigger("change")):(this.active(!0),m.button(0).active(!1),$("#entityc").val("local").trigger("change"))}),$("#entityc").on("change",function(){console.log("chanmge triggered"),m.draw()})},beforeSend:function(){spinImage.show()},error:function(e,t,a){spinImage.hide(),window.alert(a)}})}$(".afilter").click(function(){var e,t=$(this).attr("href");return e=$(this).hasClass("filterext")?1:$(this).hasClass("filterlocal")?2:0,$("a.initiated").removeClass("initiatied"),$.ajax({type:"GET",url:t,timeout:9500,cache:!0,dataType:"json",success:function(t){if(spinImage.hide(),1===e?$("dd.filterext").addClass("active"):2===e?$("dd.filterlocal").addClass("active"):$("dd.filterall").addClass("active"),t){var a=$("<table/>");a.attr("id","details"),a.addClass("filterlist");var i=$("<thead/>");a.append(i);var n=$("<tr/>");i.append(n);var s,r=[],o=t.columns,l=0;$.each(o,function(e,t){if(s=t.status){var a=[];$.each(t.cols,function(e,t){a.push(t)}),r.push(a),n.append("<th>"+t.colname+"</th>")}});var d=$("<tbody/>");a.append(d);var c=t.data,u=new Date,p=[],f=0;$.each(c,function(a,i){(1===i.plocal&&(2===e||0===e)||0===i.plocal&&2>e)&&(p[f++]="<tr>",$.each(r,function(e,a){var n="";$.each(a,function(e,a){null!==i[a]&&("pname"===a?n=n+'<a href="'+t.baseurl+"providers/detail/show/"+i.pid+'">'+i[a]+"</a><br />":"phelpurl"===a?n=n+'<a href="'+i.phelpurl+'">'+i.phelpurl+"</a>":"plocked"===a||"pactive"===a||"plocal"===a||"pstatic"===a||"pvisible"===a||"pavailable"===a?void 0!==t.statedefs[a][i[a]]&&(n=n+' <span class="lbl lbl-'+a+"-"+i[a]+'">'+t.statedefs[a][i[a]]+"</span>"):n=n+"  "+i[a])}),p[f++]="<td>"+n+"</td>"}),l++,p[f++]="</tr>")}),d.append(p.join(""));var m=new Date,v=m-u;console.log("Providerlist table gen time: "+v);var h=$("div.subtitleprefix").text();$("div.subtitle").empty().append(h+": "+l),$("div#providerslistresult").append(a),l>1&&(a.tablesorter({sortList:[[0,0]]}),$("#filter").keyup(function(){$.uiTableFilter(a,this.value)}),$("#filter-form").submit(function(){return a.find("tbody > tr:visible > td:eq(1)").mousedown(),!1}).focus())}},beforeSend:function(){$("dd.afilter").removeClass("active"),$("div#providerslistresult").empty(),$("div.alert-box").empty().hide(),spinImage.show()},error:function(e,t,a){spinImage.hide(),$("div.subtitle").empty(),$("div.alert-box").append(a).show()}}),!1}),$("a.initiated").trigger("click"),$('button[name="mrolebtn"]').click(function(e){var t=$(this).attr("value");$.ajax({type:"GET",url:t,timeout:2500,cache:!1,dataType:"json",success:function(e){var t=[];$.each(e,function(e,a){t.push(a)}),$("input[name='checkrole[]']").each(function(){var e=$(this).attr("value");$(this).attr("checked");-1===$.inArray(e,t)?$(this).prop("checked",!1):$(this).prop("checked",!0)})}})}),$('button[name="update2f"]').click(function(e){e.preventDefault();var t=$(this).parents("form:first"),a=t.find("div.alert-box"),i=t.attr("action");$.ajax({type:"POST",url:i,cache:!1,data:t.serializeArray(),dataType:"json",success:function(e){if(a.hide(),e){var t="";$.each(e,function(e,a){t=t+a+","}),$("span#val2f").empty().append(t.substring(0,t.length-1))}$("#m2f").foundation("close")},error:function(e,t,i){a.html(i).show()}})});var checkRegpol;$('input[type="radio"].withuncheck').on("hover",function(){checkRegpol=$(this).is(":checked")}).on("click",function(){checkRegpol=!checkRegpol,$(this).attr("checked",checkRegpol)}),$(document).on("click","#resetloginform",function(e){e.preventDefault();var t=$("[name='baseurl']").val();$.ajax({type:"GET",url:t+"authenticate/resetloginform",cache:!1,success:function(e){return $(".secondfactorrow").empty(),$("#loginform").foundation("close"),!1}})}),$(document).on("click","#duo_form",function(e){var t=$(this).attr("action"),a=$(".secondfactorrow");return $.ajax({type:"POST",url:t,cache:!1,data:$(this).serializeArray(),beforeSend:function(){$("#loginresponse").html("").hide()},success:function(e){e?e.success===!0&&"OK"===e.result?($("#loginform").foundation("close"),setTimeout(function(){go_to_private_page()},1e3)):"secondfactor"===e.result&&a.append(e.html).show():$("#loginresponse").html(e).show()},error:function(e,t,a){$("#loginresponse").html(e.responseText).show()}}),!1}),$(document).ready(function(){var e=$("a.autoclick");void 0!==e&&e.click()}),$(".oidclink").on("click",function(e){e.preventDefault();var t=$(this).attr("href"),a=$("[name='csrfname']").val(),i=$("[name='csrfhash']").val(),n=$(this).attr("data-jagger-oidc"),s=[{name:a,value:i},{name:"op",value:n}];$.ajax({type:"POST",url:t,data:s,cache:!1,dataType:"json",success:function(e){window.location.href=e.redirect}})}),$("#updateprefsmodal").on("submit",function(e){e.preventDefault();var t=$(this),a=t.attr("data-jagger-link"),i=t.find("div.alert").first(),n=t.find("form").first();$.ajax({url:a,type:"POST",cache:!1,data:n.serializeArray(),success:function(e){if(e)if("OK"===e.result){var a=$(document).find('[data-jagger-record="'+e.confname+'"]').first(),n=a.closest("tr"),s=e.type;"text"===s&&n.find('span[data-jagger-name="vtext"]').first().html(nl2br(e.vtext,!1));var r=n.find('span[data-jagger-name="status"]').first();e.status?r.removeClass("alert").html(e.statusstring):r.addClass("alert").html(e.statusstring),t.foundation("close")}else e.error&&i.html(e.error).show();else i.html("No data").show()},error:function(e,t,a){i.html(a).show()}})}),$(document).on("click","a.updateprefs",function(e){e.preventDefault();var t=$("#updateprefsmodal"),a=$(this).attr("href");if(void 0===t||void 0===a)return!1;var i=t.find('span[data-jagger-name="displayname"]').first(),n=t.find('input[name="confname"]').first(),s=t.find('div[data-jagger-name="desc"]').first(),r=t.find('input[name="status"]').first(),o=t.find('textarea[data-jagger-name="vtext"]').first(),l=t.find("div.alert").first();return l.html("").hide(),null===o&&window.alert("d"),$.ajax({url:a,type:"GET",cache:!1,success:function(e){if(e){i.html('"'+e.displayname+'"'),n.val(e.confname),s.html("<b>"+e.displayname+":</b> "+e.desc);var t=e.type;"text"===t?(o.val(e.vtext),o.closest("div.row").show()):o.closest("div.row").hide(),e.status===!0?r.prop("checked",!0):r.prop("checked",!1)}}}),t.foundation("open"),!1}),$("#updatemembership").on("click",".yes",function(e){var t=$("#updatemembership").find("form"),a=t.attr("action"),i=t.serializeArray();return $.ajax({url:a,type:"post",data:i,dataType:"json",success:function(e){e.message&&revealAlert(e.message,"OK")},error:function(e,t,a){revealAlert('<div class="alert-box alert ">'+e.responseText+"</div>","OK")}}),!1}),$("button.revealc").on("click",function(){var e=$(this).val(),t=$(this).attr("data-jagger-desc"),a=$("#updatemembership"),i=a.find("div.message").first();i&&i.html(t);var n=a.find('input[name="updatedata"]');n.val(e),a.foundation("open")}),$(".select2").select2(),$("#itestcombo").select2();