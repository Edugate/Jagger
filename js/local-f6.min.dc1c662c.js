function nl2br(e,t){"use strict";return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(t||void 0===t?"<br />":"<br>")+"$2")}function revealAlert(e,t){"use strict";var a='<div class="row text-right"><button class="button" data-close>'+t+"</button></div>";$("#malert").empty().append('<div class="row text-center"><p><h4>'+e+"</h4></p></div>").append(a).foundation("open")}$.fn.dataTable.ext.search.push(function(e,t,a){var i=$("#entityc").val(),n=t[0];return void 0===i||""===i||"1"===n&&"local"===i||"0"===n&&"external"===i}),function(){var d;(d=this.jQuery).fn.extend({confirmWithReveal:function(e){var t,a,i,l;return null===e&&(e={}),t={modal_class:"small",title:"Are you sure?",title_class:"",body:"This action cannot be undone.",body_class:"",password:!1,prompt:"Type <strong>%s</strong> to continue:",footer_class:"",ok:"Confirm",ok_class:"button small",cancel:"Cancel",cancel_class:"button small alert"},l=d.extend({},t,e),a=function(t){var a,e,i,n,s,r,o;return i=t.data("confirm"),null===t.attr("data-confirm")||("string"==typeof i&&0<i.length?((null!==(o=d.rails)?o.confirm:void 0)||window.confirm).call(window,i):(n=d("<div data-reveal class='reveal "+(s=function(e){return i[e]||l[e]})("modal_class")+"'>\n  <h2 data-confirm-title class='"+s("title_class")+"'></h2>\n  <p data-confirm-body class='"+s("body_class")+"'></p>\n  <div data-confirm-footer class='"+s("footer_class")+"'>\n    <a data-confirm-cancel class='"+s("cancel_class")+"'></a>\n  </div>\n</div>"),(a=t.is("a")?t.clone():d("<a/>")).removeAttr("data-confirm").attr("class",s("ok_class")).html(s("ok")).on("click",function(e){return!d(this).prop("disabled")&&(t.trigger("confirm.reveal",e),t.is("form, :input")?t.closest("form").removeAttr("data-confirm").submit():void 0)}),n.find("[data-confirm-title]").html(s("title")),n.find("[data-confirm-body]").html(s("body")),n.find("[data-confirm-cancel]").html(s("cancel")).on("click",function(e){return n.foundation("reveal","close"),t.trigger("cancel.reveal",e)}),n.find("[data-confirm-footer]").append(a),r===s("password")&&(e="<label>\n  "+s("prompt").replace("%s",r)+"\n  <input data-confirm-password type='text'/>\n</label>",n.find("[data-confirm-body]").after(d(e)),n.find("[data-confirm-password]").on("keyup",function(e){var t;return t=d(this).val()!==r,a.toggleClass("disabled",t).prop("disabled",t)}).trigger("keyup")),n.appendTo(d("body")).foundation().foundation("reveal","open").on("closed.fndtn.reveal",function(e){return n.remove()}),!1))},d.rails?(d.rails.allowAction=function(e){return a(d(e))},d(this)):(i=function(e){if(!a(d(this)))return e.preventDefault(),e.stopImmediatePropagation()},this.each(function(){var e;return(e=d(this)).on("click","a[data-confirm], :input[data-confirm]",i),e.on("submit","form[data-confirm]",i),e}))}})}.call(this),jQuery.uiTableFilter=function(e,t,a,i){"use strict";var n,s,r,o,l,d,c,u=!1;if(this.last_phrase===t)return!1;if(r=t.length,o=t.toLowerCase().split(" "),l=function(e){e.show()},d=function(e){e.hide(),u=!0},c=function(e){return e.text()},a){if(s=null,e.find("thead > tr:last > th").each(function(e){if($(this).text()===a)return s=e,!1}),null===s)throw"given column: "+a+" not found";c=function(e){return jQuery(e.find("td:eq("+s+")")).text()}}if(1<o.size&&t.substr(0,r-1)===this.last_phrase){if(" "===t[-1])return this.last_phrase=t,!1;o=o[-1],l=function(e){},n=e.find("tbody > tr:visible")}else u=!0,n=e.find("tbody > tr");return n.each(function(){var e=jQuery(this);jQuery.uiTableFilter.has_words(c(e),o,!1)?l(e):d(e)}),t,i&&u&&i(),e},jQuery.uiTableFilter.last_phrase="",jQuery.uiTableFilter.has_words=function(e,t,a){"use strict";var i,n=a?e:e.toLowerCase();for(i=0;i<t.length;i++)if(-1===n.indexOf(t[i]))return!1;return!0},Jagger.helperModal=$("#helpermodal"),Jagger.confirmFormModal=function(e){e.foundation("open")},Jagger.genFormModal=function(){var e=[];e.push("<form>"),e.push("</form>")},Jagger.dictionary.en={hello:"Hello",close:"Close",cancel:"Cancel",submit:"Submit",accept:"Accept",approve:"Approve",remove:"Remove",areyousure:"Are you sure",uwtremoveattr:"you want to remove attribute"},Jagger.getLangLine=function(e){return Jagger.dictionary[Jagger.lang]&&Jagger.dictionary[Jagger.lang][e]?Jagger.dictionary[Jagger.lang][e]:Jagger.dictionary.en[e]};var map,mapSearchInput,jlettersdigits="abcdefghijklmnopqrstuvwxyz0123456789",jLetters="abcdefghijklmnopqrstuvwxyz",jDigits="0123456789",genRandomStr=function(e){"use strict";var t,a="",i=jlettersdigits.length;for(t=0;t<e;t++)a+=jlettersdigits.charAt(Math.floor(Math.random()*i));return a};function go_to_private_page(){window.location.reload()}function mapInitialize(){window.console.log("map init");var l=[],e={zoom:4,center:new google.maps.LatLng(50.019036,13.007813),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DEFAULT}};map=new google.maps.Map(document.getElementById("map-canvas"),e),google.maps.event.addListener(map,"click",function(e){$("#latlng").val(e.latLng.lat().toFixed(6)+","+e.latLng.lng().toFixed(6))}),mapSearchInput=document.getElementById("map-search"),map.controls[google.maps.ControlPosition.TOP_LEFT].push(mapSearchInput);var d=new google.maps.places.SearchBox(mapSearchInput);google.maps.event.addListener(d,"places_changed",function(){var e=d.getPlaces();if(0!==e.length){for(var t,a=0;t=l[a];a++)t.setMap(null);l=[];for(var i,n=new google.maps.LatLngBounds,s=0;i=e[s];s++){var r={url:i.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};t=new google.maps.Marker({map:map,icon:r,title:i.name,position:i.geometry.location}),l.push(t),n.extend(i.geometry.location)}map.fitBounds(n);var o=google.maps.event.addListener(map,"idle",function(){16<map.getZoom()&&map.setZoom(16),google.maps.event.removeListener(o)})}}),google.maps.event.addListener(map,"bounds_changed",function(){var e=map.getBounds();d.setBounds(e)})}jQuery.fn.toggleOption=function(e){if(jQuery(this).toggle(e),e)for(;jQuery(this).parent("span.toggleOption").length;)jQuery(this).unwrap();else jQuery(this).wrap('<span class="toggleOption" style="display: none;" />')};var createRowWithLangRm=function(e,t,a,i){return console.log("createRowWithLangRm fired"),$('<div class="large-12 small-12 columns"><div class="small-3 columns"><label for="'+a+'" class="right inline">'+t+'</label></div><div class="small-6 large-7 columns"><input id="'+a+'" name="'+a+'" type="text" class="validurl"/></div><div class="small-3 large-2 columns"> <button type="button" class="btn langinputrm button inline  left alert" name="langrm" value="'+e+'">'+i+"</button></div></div>")},createRowTaskParams=function(e,t){for(var a="z",i="0123456789",n=0;n<5;n++)a+=i.charAt(Math.floor(Math.random()*i.length));return $('<div class="row"><div class="small-6 column"><label>'+e+'<input name="params['+a+'][name]" type="text" value=""/></label></div><div class="small-6 column"><label>'+t+'<input name="params['+a+'][value]" type="text"  value=""/></label></div></div>')},spinImage=$("#spinner"),BINIT={initFvalidators:function(){console.log("BININT"),$("ul.validatorbuttons button").on("click",function(e){var t=$(this).attr("value"),s=$("#fvform");$.ajax({type:"GET",url:t,timeout:2500,cache:!0,dataType:"json",success:function(e){if(spinImage.hide(),e){var t=e.fedid,a=e.id,i=e.name,n=e.desc;s.find('input[name="fedid"]').first().val(t),s.find('input[name="fvid"]').first().val(a),$("#fvalidesc").replaceWith('<div id="fvalidesc"><b>'+i+"</b><p>"+n+"</p></div>"),s.show()}},beforeSend:function(){$("#fvresult").hide()},error:function(){spinImage.hide(),s.hide(),$("#fvresult").hide()}})})}},GINIT={initialize:function(){"use strict";var n,t,e=$(".pjagger");0<e.length&&e.each(function(){if((n=$(this)).hasClass("piegraph")&&n.hasClass("fedgraph")){t=n.attr("data-jagger-link");var e=[];e.idp=0,e.sp=0,e.both=0,$.ajax({url:t,type:"GET",cache:!0,dataType:"json",success:function(e){if(e){var t=[{value:e.idp,color:"#F7464A",highlight:"#FF5A5E",label:e.definitions.idp},{value:e.sp,color:"#46BFBD",highlight:"#5AD3D1",label:e.definitions.sp},{value:e.both,color:"#FDB45C",highlight:"#FFC870",label:e.definitions.both}],a=n.find("canvas").get(0).getContext("2d");if(a){var i=new Chart(a).Pie(t,{responsive:!0,legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><div><span style="background-color:<%=segments[i].fillColor%>">&nbsp;&nbsp;&nbsp;</span> <%if(segments[i].label){%><%=segments[i].label%><%}%></div><%}%></div>'}).generateLegend();n.find("div.plegend").first().html(i)}}}})}});var u=$("#membership2").first();if(void 0!==u&&0<u.length){var p,a=$(u).attr("data-jagger-link"),f=["idp","sp","both"],m=[];m.idp=0,m.sp=0,m.both=0,$.ajax({url:a,type:"GET",cache:!0,dataType:"json",success:function(e){if(e){var a,i=e.definitions.preurl,n=[],s=-1;n[++s]='<h7 class="subheader">List of currently registered entities</h7>',n[++s]='<ul class="accordion" data-allow-all-closed="true" data-multi-expand="true" data-accordion>';for(var t=0,r=f.length;t<r;t++){var o;if(e[p=f[t]])m[p]=e[p].length,n[++s]='<li class="accordion-item " data-accordion-item>',n[++s]='<a href="#" class="accordion-title">'+e.definitions[p]+" ("+m[p]+")</a> ",n[++s]='<div class="accordion-content" data-tab-content>',n[++s]="<table><tbody>",n[++s]='<tr><td colspan="2"><div class="zebramembers">',a=0,$.each(e[p],function(e,t){o="",!1===t.penabled&&(o+='<span class="label alert">disabled</span> '),1!==t.mdisabled&&1!==t.mbanned||(o+='<span class="label alert">membership suspended</span> '),++a,n[++s]=a%2?'<div class="small-12 column odd">':'<div class="small-12 column even">',n[++s]='<div class="large-5 column">'+a+'. <a href="'+i+t.pid+'">'+t.pname+"</a></div>",n[++s]='<div class="large-5 column">'+t.entityid+"</div>",n[++s]='<div class="large-2 column">'+o+"</div>",n[++s]="</div>"}),n[++s]="</div></td></tr>",n[++s]="</tbody></table>",n[++s]="</div>",n[++s]="</li>"}n[++s]="</ul>",u.hasClass("fake")||$(u).html(n.join("")).foundation();var l=[{value:m.idp,color:"#F7464A",highlight:"#FF5A5E",label:e.definitions.idp},{value:m.sp,color:"#46BFBD",highlight:"#5AD3D1",label:e.definitions.sp},{value:m.both,color:"#FDB45C",highlight:"#FFC870",label:e.definitions.both}],d=document.getElementById("fedpiechart").getContext("2d");if(d&&(0<m.idp||0<m.sp||0<m.both)){var c=new Chart(d).Pie(l,{responsive:!0,legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><div><span style="background-color:<%=segments[i].fillColor%>">&nbsp;<%=segments[i].value %>&nbsp;</span> <%if(segments[i].label){%><%=segments[i].label%><%}%></div><%}%></div>'}).generateLegend();$("#fedpiechartlegend").html(c)}}}})}$("div[data-jagger-getmoreajax]").each(function(e){var t=$(this).attr("data-jagger-getmoreajax"),a=$(this).attr("data-jagger-response-msg"),n=$(this).attr("data-jagger-refreshurl"),s="";if(null==a)return console.log('attribute data-jagger-response-msg not found in element with data-jagger-getmoreajax="'+t+'" - exiting'),!1;console.log('attribute data-jagger-response-msg="'+a+'" in element data-jagger-getmoreajax="'+t+'"');var r=$("div#"+a);if(null==r||0===$(r).length)return console.log('div with id="'+a+'" not found'),!1;console.log('div with id="'+a+'" found'),$.ajax({dataType:"json",type:"GET",url:t,cache:!0,success:function(e){if(!e)return console.log("no json got from "+t),!1;if(e.length<1)return!1;var a,i=$("<div/>");$.each(e,function(e,t){a="<div>"+t.msg+"</div>",i.append(a)}),null!==n&&(s='<a class="refreshurl float-right" href="#"  data-jagger-getmoreajaxonclick= "'+n+'" data-jagger-response-msg="prdetails"><i class="fa fa-refresh" ></i></a>'),r.empty().append(s).append(i).show()}})}),$("#taskformaddparam").on("click",function(e){var t=$(this).closest("div.row");return createRowTaskParams("","").insertBefore(t),!1}),$("#password").on("keypress",function(e){var t=e.keyCode?e.keyCode:e.which,a=e.shiftKey?e.shiftKey:16===t;65<=t&&t<=90&&!a||97<=t&&t<=122&&a?$("#capswarn").show():$("#capswarn").hide()}),$("table.sortable").tablesorter();var r=$("[name='baseurl']").val();void 0===r&&(r=""),$("#loginbtn").on("click",function(e){var t=$(this).attr("data-jagger-link"),a=$("#loginform"),i=$(a).find(":submit").first(),n=$(a).find("div.usernamerow").first(),s=$(a).find("div.passwordrow").first(),r=$(a).find("div.secondfactorrow").first(),o=$("#loginresponse");return $.ajax({type:"GET",url:t,dataType:"json",cache:!1,success:function(e){if(1!==e.logged){if(0===e.partiallogged)return i.prop("disabled",!1),n.show(),s.show(),o.hide(),a.foundation("open"),!1;if(1===e.twofactor&&null!==e.secondfactor)return i.prop("disabled",!0),n.show(),$("#password").val(null),s.show(),o.hide(),e.html&&r.html(e.html).show(),a.foundation("open"),!1}else{var t=$("[name='baseurl']").val();void 0!==t&&(window.location.href=t)}n.show(),s.show(),o.hide(),a.foundation("open")}}),!1}),$(document).on("click",".modal-close",function(e){$(this).foundation("reveal","close")}),$("#providerdetail-tabs[data-tabs]").on("change.zf.tabs",function(e){console.log("Those tabs sure did change!");var a=$('div[data-tabs-content="'+$(this).attr("id")+'"]').children(".tabs-panel.is-active"),t=a.attr("data-reveal-ajax-tab");void 0!==t&&$.ajax({cache:!0,type:"GET",url:t,success:function(t){try{JSON.parse(t)}catch(e){a.empty().append(t)}return a.foundation(),!1}})}),$("#newusermodal").on("submit","form",function(e){e.preventDefault();var t=$(this),a=t.attr("action"),i=t.find("div.message").first();$.ajax({url:a,type:"POST",data:t.serializeArray(),beforeSend:function(){i.hide().empty()},success:function(e){e&&"OK"===e.trim()?($("#newusermodal").foundation("close"),i.hide().empty(),location.reload()):i.html(e).show()}})}),$(".cleartarget").on("click",function(e){e.preventDefault();var t=$(this).attr("data-jagger-textarea"),a=$(this).attr("data-jagger-input");return void 0!==t&&$("textarea[name='"+t+"']").val(""),void 0!==a&&$("input[name='"+a+"']").val(""),!1}),$(".postajax").on("click",function(e){e.preventDefault();var t=$(this).closest("form"),a=$(this).attr("data-jagger-response-msg"),n=$("div#"+a),i=t.attr("action");return $.ajax({type:"POST",url:i,data:t.serializeArray(),beforeSend:function(){n.empty()},success:function(e){e?n.append(e):n.append("no result")},error:function(e,t,a){var i="<div>"+a+"</div>";return n.append(i),!1}}),!1}),$(".policymembers").on("click",function(e){var t=$(this).attr("data-jagger-jsource"),n=$("#regpolmembers"),s=n.find(".datacontent").first();$.ajax({type:"GET",url:t,beforeSend:function(){s.empty()},success:function(e){if(e){var t=$("<ul/>");t.addClass("no-bullet");var a=[],i=0;$.each(e,function(e,t){a[i++]='<li><a href="'+r+"providers/detail/show/"+t.provid+'">'+t.name+" </a><small>("+t.entityid+")</small></li>"}),t.append(a.join("")),s.append(t),n.foundation("open")}}})}),$(document).on("click",".ecmembers",function(e){var t=$(this).attr("data-jagger-jsource"),n=$("#ecmembers"),s=n.find(".datacontent").first();$.ajax({type:"GET",url:t,beforeSend:function(){s.empty()},success:function(e){if(e){var t=$("<ul/>");t.addClass("no-bullet");var a=[],i=0;$.each(e,function(e,t){a[i++]='<li><a href="'+r+"providers/detail/show/"+t.provid+'">'+t.name+" </a><small>("+t.entityid+")</small></li>"}),t.append(a.join("")),s.append(t),n.foundation("open")}}})}),$(".rmusericon").on("click",function(e){var t=$("#removeusermodal"),a=t.find("#removeusermodalmsg").first(),i=$(this).attr("data-jagger-username"),n=$(this).attr("data-jagger-encodeduser"),s=t.find("#usernameval").first(),r=t.find("#encodedusr").first(),o=t.find("button[name='close']"),l=t.find("button[name='cancel']"),d=t.find("button[name='remove']");return t.find("input[name='username']").val(""),r.val(n),s.html(i),a.html("").hide().removeClass("alert").removeClass("success"),d.show(),l.show(),o.hide(),t.foundation("open"),!1}),$("#removeusermodal").on("submit",function(e){e.preventDefault();var t=$(this),a=t.find("form").first(),i=a.serializeArray(),n=t.find("#removeusermodalmsg").first(),s=t.find("#encodedusr").first(),r=a.attr("action"),o=t.find("button[name='close']"),l=t.find("button[name='cancel']"),d=t.find("button[name='remove']");$.ajax({type:"POST",url:r,data:i,beforeSend:function(){n.html("").hide().removeClass("alert").removeClass("success"),d.show(),l.show(),o.hide()},success:function(e){var t=$(document).find('a[data-jagger-encodeduser="'+s.val()+'"]');return t&&t.closest("tr").hide(),n.html(e).addClass("success").show(),d.hide(),l.hide(),o.show(),!1},error:function(e,t,a){return n.html(e.responseText).addClass("alert").show(),!1}})}),$("#confirmremover").on("click",".yes",function(e){e.preventDefault();var t=$(this).closest("form"),a=t.attr("action"),i=t.attr("data-jagger-regpolicy"),n=t.attr("data-jagger-ec");$.ajax({type:"POST",url:a,data:t.serializeArray(),success:function(e){null!=i?$('a[data-jagger-regpolicy="'+i+'"]').closest("tr").hide():$('a[data-jagger-ec="'+n+'"]').closest("tr").hide(),$("#confirmremover").foundation("close")},error:function(e,t,a){var i=""+a;return window.alert(i),!1}})}),$("a.withconfirm").on("click",function(e){e.preventDefault();var t=$(this).attr("href"),a=$(this).attr("data-jagger-regpolicy"),i=$(this).attr("data-jagger-ec"),n=$(this).attr("data-jagger-counter"),s=$(this).attr("data-jagger-fieldname");if(void 0===t)return!1;var r=$("#confirmremover"),o=r.find("span.data-fieldname").first(),l=r.find("span.data-counter").first();o.html(s),l.html(n);var d=r.find("form").first();d.attr("action",t),null!=i?d.attr("data-jagger-ec",i):d.attr("data-jagger-regpolicy",a),r.foundation("open")}),$(".dhelp").click(function(){var e=parseInt($(this).css("font-size"));e<=10?$(this).css("font-size",e+5).removeClass("zoomin").addClass("zoomout"):$(this).css("font-size",e-5).removeClass("zoomout").addClass("zoomin")}),$("form#availablelogos input[name='filename']").click(function(){$(this).after($("form#availablelogos div.buttons").show())}),$("button.reqattrrm").click(function(){$(this).closest("fieldset").remove()}),$("form#availablelogos").on("submit",function(e){e.preventDefault();var i=$("div.uploadresult"),t=$("div.assignedlogosgrid").text();$("#uploadlogo").unbind(),$.ajax({type:"POST",url:$(this).attr("action"),data:$("form#availablelogos").serializeArray(),dataType:"html",cache:!1,beforeSend:function(){$("form#availablelogos div.buttons").hide().appendTo("form#availablelogos")},success:function(e){$("form#availablelogos #filename").prop("checked",!1),$.ajax({type:"GET",url:t,cache:!1,success:function(e){$("#uploadlogo").unbind(),$("div#t1").empty().append(e),$("#assignedlogos").unbind(),$("#availablelogos").unbind(),GINIT.initialize()}}),spinImage.hide(),revealAlert(e,"OK")},error:function(e,t,a){spinImage.hide(),i.css("color","red"),revealAlert('<div data-alert class="alert-box alert">'+e.responseText+"</div>","OK")}})}),$("#uploadlogo").on("submit",function(e){e.preventDefault();var t=new FormData(document.forms.namedItem("uploadlogo")),a=$("div.uploadresult"),i=$("div.availablelogosgrid").text(),n=$("div.assignedlogosgrid").text();$.ajax({type:"POST",url:$(this).attr("action"),data:t,dataType:"html",cache:!1,processData:!1,contentType:!1,beforeSend:function(){a.html(""),a.css("color","black"),$("form#availablelogos div.buttons").hide().appendTo("form#availablelogos"),spinImage.show()},success:function(e){spinImage.hide(),a.html(e),revealAlert($("div.uploadresult").text(),"OK"),$.ajax({type:"GET",url:n,cache:!1,success:function(e){var t=$("form#assignedlogos");t.replaceWith(e),$("#availablelogos").unbind(),t.unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),$("form#availablelogos input[name='filename']").unbind("click"),GINIT.initialize()},error:function(e,t,a){spinImage.hide(),$("#availablelogos").unbind(),$("#assignedlogos").unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),$("form#availablelogos input[name='filename']").unbind("click"),GINIT.initialize()}}),$.ajax({type:"GET",url:i,cache:!1,success:function(e){$("form#availablelogos").replaceWith(e).unbind(),$("form#assignedlogos").unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),$("form#availablelogos input[name='filename']").unbind("click"),GINIT.initialize()},error:function(e,t,a){spinImage.hide(),$("#availablelogos").unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),$("form#availablelogos input[name='filename']").off("click"),revealAlert('<div data-alert class="alert-box alert">'+e.responseText+"</div>","OK"),GINIT.initialize()}})},error:function(e,t,a){spinImage.hide(),revealAlert('<div data-alert class="alert-box alert">'+e.responseText+"</div>","OK")}}).done(function(){})}),$("li.fromprevtoright").each(function(){var e=$(this).prev().offset().left,t=$(this).prev().find("input,textarea").last(),a=t.offset().left+t.width()-e;$(this).css("text-align","right").width(a)}),$("form#assignedlogos input[name='logoid']").click(function(){$(this).after($("div#unsignlogosbtn").show())}),$("form#applyforaccount").on("submit",function(e){e.preventDefault();var i=$("div.result"),t=$("form#applyforaccount").serializeArray();$.ajax({type:"POST",url:$(this).attr("action"),data:t,dataType:"html",cache:!1,beforeSend:function(){i.html(""),spinImage.show()},success:function(e){spinImage.hide(),i.html(e),$("form#applyforaccount").remove()},error:function(e,t,a){spinImage.hide(),i.html(e.responseText),i.css("color","red"),$("form#applyforaccount").remove()}})}),$("form#assignedlogos").on("submit",function(e){e.preventDefault();var t=$("div.uploadresult"),a=$("form#assignedlogos").serializeArray(),i=$("input[name=logoid]:radio:checked"),n=$("#messagereveal"),s=n.find("p.infomsg");$.ajax({type:"POST",url:$(this).attr("action"),data:a,dataType:"html",cache:!1,beforeSend:function(){$("div#unsignlogosbtn").hide().appendTo("form#assignedlogos"),t.html(""),spinImage.show()},success:function(e){spinImage.hide(),s.html(e),n.foundation("open"),i.parent().remove()},error:function(e,t,a){spinImage.hide(),s.html(e.responseText),n.foundation("open")}})}),$(".updatenotifactionstatus").click(function(e){e.preventDefault();var t=$("#notificationupdateform"),a=$(this).attr("value"),i=($(this).closest("tbody"),$(this).closest("tr").find("div.subscrstatus:first"),r+"notifications/subscriber/updatestatus/"+a);t.attr("action",i),t.find("#noteid").first().val(a)}),$("#fvform").submit(function(e){e.preventDefault();var t=$(this),a=t.serializeArray(),i=t.attr("action");t.find("button:focus").attr("id");$.ajax({type:"POST",url:i,cache:!1,data:a,dataType:"json",timeout:12e4,success:function(e){var i;(spinImage.hide(),e)?(e.returncode&&($("#fvreturncode").append(e.returncode),$("#fvresult").show()),"success"===e.returncode?(t.find("button:focus").css("background-color","#00aa00"),t.find("button:focus").data("passed","true"),t.find("button:focus").attr("disabled","true")):"error"===e.returncode&&(t.find("button:focus").css("background-color","#aa0000"),t.find("button:focus").data("passed","false")),e.message&&$.each(e.message,function(a,e){$.each(e,function(e,t){i="<div>"+a+": "+t+"</div>",$("#fvmessages").append(i)})})):alert("no data received from upstream server")},beforeSend:function(){$("#fvreturncode").text(""),$("#fvmessages").text(""),spinImage.show()},error:function(e,t,a){spinImage.hide(),revealAlert("timeout"===t?"got timeout from validation server":"unknown problem with receiving data","Close")}})}),$("#rejectqueue").on("submit",function(e){var t=$(this).serializeArray(),a=$(this).attr("action");return $.ajax({type:"POST",url:a,data:t,dataType:"json",success:function(e){e&&(alert(e.message),window.location.href=r)},error:function(e,t,a){window.alert("Error occured: "+a)}}),!1}),$("#approvequeue").submit(function(e){var t=0,a=0;if($("button[name='mandatory']").each(function(e){"true"===$(this).data("passed")&&(t+=1),a+=1}),a!==t)return revealAlert("All mandatory validations have to pass successfully!","Close"),!1}),$(document).on("click",".fmembers","a",function(){var s=$(this),e=s.attr("href"),r=(s.find("i").first(),s.parent().parent());if(!0===$(r).hasClass("opened"))$(r).next().remove(),$(r).removeClass("opened").removeClass("highlight"),s.removeClass("is-active");else{var o=$("<ul/>");$.ajax({url:e,timeout:9500,cache:!0,success:function(e){var t,a,i;if(s.addClass("is-active"),spinImage.hide(),$(r).addClass("opened").addClass("highlight"),e)if(e.idp||e.sp||e.both){var n=e.definitions.preurl;e.idp&&(t=$("<div>"+e.definitions.idp+"</div>"),a=$("<ol/>"),$.each(e.idp,function(e,t){i='<li class="homeorg"><a href="'+n+t.pid+'">'+t.pname+"</a> ("+t.entityid+") </li>",a.append(i)}),t.append(a),o.append(t)),e.sp&&(t=$("<div>"+e.definitions.sp+"</div>"),a=$("<ol/>"),$.each(e.sp,function(e,t){i='<li class="resource"><a href="'+n+t.pid+'">'+t.pname+"</a> ("+t.entityid+") </li>",a.append(i)}),t.append(a),o.append(t)),e.both&&(t=$("<div>"+e.definitions.both+"</div>"),a=$("<ol/>"),$.each(e.both,function(e,t){i='<li class="both"><a href="'+n+t.pid+'">'+t.pname+"</a> ("+t.entityid+") </li>",a.append(i)}),t.append(a),o.append(t))}else i="<div>"+e.definitions.nomembers+"</div>",o.append(i);else revealAlert("No data","Close")},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),revealAlert("problem with loading data","Close")}}).done(function(){var e='<tr class="feddetails"><td colspan="7"><ul class="feddetails">'+o.html()+"</ul></td></tr>";$(e).insertAfter(r)})}return!1}),$("#getmembers").click(function(){var e=$(this).attr("href"),t=$("<ul/>");return $.ajax({url:e,timeout:22500,cache:!0,dataType:"json",success:function(e){if(spinImage.hide(),!e)return revealAlert("No data","Close"),!1;var a,i,n,s='<div class="zebralist row" style="list-style-type : decimal" >',r=1;$.each(e,function(e,t){n="<span>",i="",$.each(t.feds,function(e,t){i+='<span class="label">'+t+"</span>&nbsp;"}),n+=i,n+="</span>",a='<div class="large-12 columns" style="margin-top: 2px; margin-bottom: 2px"><div class="large-9 columns">'+r+'. <a href="'+t.url+'">'+t.name+"</a> <i> ("+t.entityid+') </i></div><div class="fedlbl large-3 end text-right columns">'+n+"</div></div>",s+=a,1,r+=1}),s+="</div>",t.append(s)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),revealAlert("problem with loading data","Close")}}).done(function(){var e=t.html();$("#membership").replaceWith(e)}),!1}),$(".accordionButton").addClass("off").mouseover(function(){$(this).addClass("over")}).mouseout(function(){$(this).removeClass("over")}).click(function(){$(this).removeClass("on").addClass("off"),$(".accordionContent").slideUp("fast"),!0===$(this).next().is(":hidden")&&($(this).addClass("on"),$(this).removeClass("off"),$(this).next().slideDown("fast"))}),$(".accordionContent").hide()}};$(document).ready(function(){$("fieldset").addClass("fieldset"),$("pre code").each(function(e,t){hljs.highlightBlock(t)}),$(window).scroll(function(){100<=$(this).scrollTop()?$("#return-to-top").fadeIn(200):$("#return-to-top").fadeOut(200)}),$("#return-to-top").click(function(){$("body,html").animate({scrollTop:0},400)}),GINIT.initialize();var i,n=$("#accessmngmt");if(n.length){i=n.closest("form");var e=n.attr("data-jagger-jsource");$.ajax({type:"GET",url:e,dataTypa:"json",beforeSend:function(){spinImage.show()},success:function(t){var r=t.definitions.admin,o=t.definitions.dictionary.allow,l=t.definitions.dictionary.deny,d=t.definitions.dictionary.hasaccess,c=t.definitions.dictionary.hasnoaccess,e=t.definitions.dictionary.username;spinImage.hide();var u=[];u.push("<table><thead><tr><th>"+e+"</th>"),$.each(t.definitions.actions,function(e,t){u.push("<th>"+t+"</th>")}),u.push("</tr></thead>"),u.push("<tbody>"),$.each(t.data,function(a,i){u.push("<tr><td>");var e="",n="",s="";!0===i.isyou&&(e+=' <span class="label warning">You</span>',n=' disabled="disabled" '),!0===i.isadmin&&(e+=' <span class="label">Administrator</span>'),u.push(a+" ("+i.fullname+")"+e),u.push("</td>"),$.each(t.definitions.actions,function(e,t){!(s="")===i.isadmin?u.push("<td>"+d+"</td>"):("approve"===t&&!0!==r&&(n=' disabled="disabled" ',s="secondary"),!0===i.perms[t]?u.push("<td>"+d+" <div><button "+n+' class="button small alert '+s+'" value="'+a+"$|$"+t+'$|$deny" name="changeaccess" type="submit" >'+l+"</button></div></td>"):u.push("<td>"+c+" <div><button "+n+' class="button small '+s+'" value="'+a+"$|$"+t+'$|$allow" name="changeaccess" type="submit">'+o+"</button></div></td>"))}),u.push("</tr>")}),u.push("</tbody>"),u.push("</table>");var a=u.join("");n.html(a)},error:function(e,t,a){spinImage.hide(),revealAlert(e.responseText,"Close")}}),i.on("click","button",function(e){var t=$(this),a=i.serializeArray();return a.push({name:t.attr("name"),value:t.val()}),console.log(a),$.ajax({method:"POST",data:a,url:i.attr("action"),success:function(e){window.location.href=window.location.href},error:function(e,t,a){}}),!1})}var s,d=/^-?([0-8]?[0-9]|90)\.[0-9]{1,6},-?((1?[0-7]?|[0-9]?)[0-9]|180)\.[0-9]{1,6}$/,t=$("#providereditform");if(t.length){$("#uihints");var a,r=$("#addlatlng"),l=[],c=[],o=t.find("#map-canvas");if(o.length)if("object"==typeof google&&"object"==typeof google.maps){google.maps.event.addDomListener(window,"load",mapInitialize);var u=$("#geogroup").first();l=[],u.find("input").each(function(e){var t=$(this).val().split(",");l.push(t)});t.on("change.zf.tabs","[data-tabs]",function(e){for(var t=new google.maps.LatLngBounds,a=0,i=l.length;a<i;a++){var n=new google.maps.LatLng(l[a][0],l[a][1]),s=new google.maps.Marker({position:n,map:map,title:""});s.setMap(map),c.push(s),t.extend(s.position)}!0;var r=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(r),0<l.length&&map.fitBounds(t);var o=google.maps.event.addListener(map,"idle",function(){16<map.getZoom()&&map.setZoom(16),google.maps.event.removeListener(o)})})}else o.append('<div data-alert class="alert-box alert">Map could not be loaded</div>');t.on("click","a.rmgeo",function(e){for(var t=$(this).closest("div.georow").find("input").first().val().split(","),a=0,i=c.length;a<i;a++){var n=c[a];console.log(n.position.lat()+" ?? "+t[0]),parseFloat(n.position.lat())===parseFloat(t[0])&&(n.setMap(null),c.splice(a,1))}return $(this).closest("div.georow").remove(),!1}),r.on("click",function(e){e.preventDefault();var t=$("#latlng").val();if(d.test(t)){for(var a="z",i="0123456789",n=0;n<5;n++)a+=i.charAt(Math.floor(Math.random()*i.length));if($('<div class="small-12 column collapse georow"><div class="small-11 column"><input name="f[uii][idpsso][geo]['+a+']" type="text" value="'+t+'" readonly="readonly"></div><div class="small-1 column"><a href="#" class="rmgeo"><i class="fa fa-trash alert" style="color: red"></i></a></div></div>').appendTo($("#geogroup")),"object"==typeof google&&"object"==typeof google.maps){var s=new google.maps.LatLngBounds,r=t.split(","),o=new google.maps.LatLng(r[0],r[1]),l=new google.maps.Marker({position:o,map:map,title:""});l.setMap(map),c.push(l),s.extend(l.position)}}else window.alert("incorrect value")}),t.find("div.group").each(function(){var e=$(this).find("select").first();$(this).find("button.langinputrm").each(function(){a=$(this).attr("value"),e.find("option[value="+a+"]").each(function(){$(this).toggleOption(!0),$(this).attr("disabled",!0)})})}),$("button#idpssoadddomainhint").click(function(){for(var e="",t="0123456789",a=0;a<5;a++)e+=t.charAt(Math.floor(Math.random()*t.length));var i=$("button#helperbutttonrm").html();$(this).attr("value");createRowWithLangRm("Domain Hint","Domain Hint","f[uii][idpsso][domainhint][n"+e+"]",i).insertBefore($(this).closest("span").parent())}),$("button#idpssoaddiphint").click(function(){for(var e="",t="0123456789",a=0;a<5;a++)e+=t.charAt(Math.floor(Math.random()*t.length));var i=$("button#helperbutttonrm").html();$(this).attr("value");createRowWithLangRm("IP Hint","IP Hint","f[uii][idpsso][iphint][n"+e+"]",i).insertBefore($(this).closest("span").parent())}),$("button#addlhelpdesk").click(function(){var e=$("span.lhelpdeskadd option:selected").first(),t=e.val(),a=$("button#helperbutttonrm").html();if(void 0===t)return!1;var i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,i,"f[lhelpdesk]["+t+"]",a).insertBefore($(this).closest("span").parent())}),$("button#addldisplayname").click(function(){var e=$("span.ldisplaynameadd option:selected").first(),t=e.val(),a=$("button#helperbutttonrm").html();if(void 0===t)return!1;var i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,i,"f[ldisplayname]["+t+"]",a).insertBefore($(this).closest("span").parent())}),$("button#idpadduiidisplay").click(function(){var e=$("span.idpuiidisplayadd option:selected").first(),t=e.val(),a=$("button#helperbutttonrm").html();if(void 0===t)return!1;var i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,i,"f[uii][idpsso][displayname]["+t+"]",a).insertBefore($(this).closest("span").parent())}),$("button#idpadduiihelpdesk").click(function(){var e=$("span.idpuiihelpdeskadd option:selected").first(),t=e.val();if(void 0===t)return!1;var a=$("button#helperbutttonrm").html(),i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,i,"f[uii][idpsso][helpdesk]["+t+"]",a).insertBefore($(this).closest("span").parent())}),$("button#spadduiidisplay").click(function(){var e=$("span.spuiidisplayadd option:selected").first(),t=e.val();if(void 0===t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,a,"f[uii][spsso][displayname]["+t+"]",i).insertBefore($(this).closest("span").parent())}),$("button#spadduiihelpdesk").click(function(){var e=$("span.spuiihelpdeskadd option:selected").first(),t=e.val();if(void 0===t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,a,"f[uii][spsso][helpdesk]["+t+"]",i).insertBefore($(this).closest("span").parent())}),$("button#spadduiidesc").click(function(){var e=$("span.spuiidescadd option:selected").first(),t=e.val();if(void 0===t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();e.attr("disabled",!0).attr("selected",!1),$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][spsso][desc]['+t+']" class="right inline">'+a+'</label></div><div class="small-6 large-7 columns"><textarea id="f[uii][spsso][desc]['+t+']" name="f[uii][spsso][desc]['+t+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"><button type="button" class="btn langinputrm button left inline alert" name="uiispdescrm" value="'+t+'">'+i+"</button></div></div>").insertBefore($(this).closest("span").parent())}),$("#spadduiikeywords").click(function(){var e=$("span.spuiikeywordsadd option:selected").first(),t=e.val();if(void 0===t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();e.attr("disabled",!0).attr("selected",!1),$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][spsso][keywords]['+t+']" class="right inline">'+a+'</label></div><div class="small-6 large-7 columns"><textarea id="f[uii][spsso][keywords]['+t+']" name="f[uii][spsso][keywords]['+t+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"><button type="button" class="langinputrm button  left inline alert" name="uiispkeywordsrm" value="'+t+'">'+i+"</button></div></div>").insertBefore($(this).closest("span").parent())}),$("button#addlname").click(function(){var e=$("span.lnameadd option:selected").first(),t=e.val();if(void 0===t)return!1;var a=$("button#helperbutttonrm").html(),i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,i,"f[lname]["+t+"]",a).insertBefore($(this).closest("span").parent())}),$("button[name='addinnewlang']").on("click",function(e){var t=$(this),a=(t.closest("fieldset"),t.closest("span"));if(0===a.length)return!1;var i=a.find(":selected").first();if(0===i.length)return!1;var n=i.attr("disabled");if(null!==n&&"disabled"===n)return!1;var s=i.val(),r=i.text();if(void 0===s||""===s)return!1;var o=$("button#helperbutttonrm").html(),l=t.attr("value").replace("XXX",s);i.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(s,r,l,o).insertBefore($(this).closest("span").parent())}),$("button#idpadduiidesc").click(function(){var e=$("span.idpuiidescadd option:selected").first(),t=e.val();if(void 0===t)return!1;var a=$("button#helperbutttonrm").html(),i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][idpsso][desc]['+t+']" class="right inline">'+i+' </label></div><div class="small-6 large-7 columns"><textarea id="f[uii][idpsso][desc]['+t+']" name="f[uii][idpsso][desc]['+t+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"> <button type="button" class=" langinputrm button  left inline alert" name="ldesc" value="'+t+'">'+a+"</button></div></div>").insertBefore($(this).closest("span").parent())}),$("button#idpadduiikeywords").click(function(){var e=$("span.idpuiikeywordsadd option:selected").first(),t=e.val();if(void 0===t)return!1;var a=$("button#helperbutttonrm").html(),i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][idpsso][keywords]['+t+']" class="right inline">'+i+' </label></div><div class="small-6 large-7 columns"><textarea id="f[uii][idpsso][keywords]['+t+']" name="f[uii][idpsso][keywords]['+t+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"> <button type="button" class="langinputrm button  left inline alert" name="lkeywords" value="'+t+'">'+a+"</button></div></div>").insertBefore($(this).closest("span").parent())}),$("button#addlprivacyurlspsso").click(function(){var e=$("span.addlprivacyurlspsso option:selected").first(),t=e.val();if(void 0===t)return!1;var a=e.text(),i=$("button#helperbutttonrm").html();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,a,"f[prvurl][spsso]["+t+"]",i).insertBefore($(this).closest("span").parent())}),$("button#addlprivacyurlidpsso").click(function(){var e=$("span.addlprivacyurlidpsso option:selected").first(),t=e.val(),a=$("button#helperbutttonrm").html();if(void 0===t)return!1;var i=e.text();$(this).attr("value");e.attr("disabled",!0).attr("selected",!1),createRowWithLangRm(t,i,"f[prvurl][idpsso]["+t+"]",a).insertBefore($(this).closest("span").parent())}),$("#ncontactbtn").click(function(){var e=genRandomStr(5),t=$(this).attr("value").split("|"),a='<div class="group"><div class="small-12 columns"><fieldset><legend>'+t[5]+'</legend><div><div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+e+'][type]" class="right inline">'+t[1]+'</label></div><div class="small-8 large-7 columns inline"><select name="f[contact][n_'+e+'][type]"> <option value="administrative">Administrative</option> <option value="technical">Technical</option> <option value="support" selected="selected">Support</option> <option value="billing">Billing</option> <option value="other">Other</option> <option value="other-sirfti">Security (Sirfty)</option> </select></div><div class="small-1 large-2 columns"></div></div> <div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+e+'][fname]" class="right inline">'+t[2]+'</label></div><div  class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+e+'][fname]" value="" id="f[contact][n_'+e+'][fname]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div> <div class="small-12 columns"><div  class="small-3 columns"><label for="f[contact][n_'+e+'][sname]" class="right inline">'+t[3]+'</label></div><div class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+e+'][sname]" value="" id="f[contact][n_'+e+'][sname]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+e+'][email]" class="right inline ">'+t[4]+'</label></div><div class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+e+'][email]" value="" id="f[contact][n_'+e+'][email]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div><div class="rmelbtn small-12 columns"><div class="small-9 large-10 columns"><button type="button" class="btn contactrm  alert button inline right" name="contact" value="'+e+'">'+t[0]+'</button></div><div class="small-3 large-2 columns"></div></div></div></fieldset></div></div>';$(this).parent().before(a)}),$("#nidpssocert").click(function(){var e="newx"+genRandomStr(5),t='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][idpsso]['+e+'][type]" class="inline right">Certificate type</label></div><div class="small-6 large-7 columns"><select name="f[crt][idpsso]['+e+'][type]"> <option value="x509">x509</option> </select></div><div class="small-3 large-2 columns"></div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][idpsso]['+e+'][usage]" class="inline right">Certificate use</label></div><div class="small-6 large-7 columns"><select name="f[crt][idpsso]['+e+'][usage]"> <option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][idpsso]['+e+'][keyname]" class="inline right">KeyName</label></div><div class="small-6 large-7 columns"><input type="text" name="f[crt][idpsso]['+e+'][keyname]" value="" id="f[crt][idpsso]['+e+'][keyname]" class=""  /> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][idpsso]['+e+'][certdata]" class="inline right">Certificate</label></div><div class="small-6 large-7 columns"><textarea name="f[crt][idpsso]['+e+'][certdata]" cols="65" rows="20" id="f[crt][idpsso]['+e+'][certdata]" class="certdata notice" ></textarea></div><div class="small-3 large-2 columns"></div></div>';$(this).parent().before(t)}),$("#naacert").click(function(){var e="newx"+genRandomStr(5),t='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][aa]['+e+'][type]" class="inline right">Certificate type</label></div><div class="small-6 large-7 columns"><select name="f[crt][aa]['+e+'][type]"> <option value="x509">x509</option> </select> </div><div class="small-3 large-2 columns"></div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][aa]['+e+'][usage]" class="inline right">Usage</label></div><div class="small-6 large-7 columns"><select name="f[crt][aa]['+e+'][usage]"> <option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][aa]['+e+'][keyname]" class="inline right">KeyName</label></div><div class="small-6 large-7 columns"><input type="text" name="f[crt][aa]['+e+'][keyname]" value="" id="f[crt][aa]['+e+'][keyname]" class=""  /> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][aa]['+e+'][certdata]" class="inline right">Certificate</label></div><div class="small-6 large-7 columns"><textarea name="f[crt][aa]['+e+'][certdata]" cols="65" rows="20" id="f[crt][aa]['+e+'][certdata]" class="certdata notice" ></textarea> </div><div class="small-3 large-2 columns"></div></div> ';$(this).parent().before(t)}),$("#nspssocert").click(function(){var e="newx"+genRandomStr(5),t='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][spsso]['+e+'][type]" class="right inline">Certificate type</label></div><div class="small-8 large-7 columns"><select name="f[crt][spsso]['+e+'][type]"><option value="x509">x509</option></select> </div><div class="small-1 large-2 columns end"></div></div><div class="small-12  columns"><div class="small-3 columns"><label for="f[crt][spsso]['+e+'][usage]" class="right inline">Certificate use</label></div><div class="small-8 large-7 columns"><select name="f[crt][spsso]['+e+'][usage]"><option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select></div><div class="small-1 large-2 columns end"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][spsso]['+e+'][keyname]" class="right inline">KeyName</label></div><div class="small-8 large-7 columns"><input type="text" name="f[crt][spsso]['+e+'][keyname]" value="" id="f[crt][spsso]['+e+'][keyname]" class=""  /></div><div class="small-1 large-2 columns end"></div> </div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][spsso]['+e+'][certdata]" class="right inline">Certificate</label></div><div class="small-8 large-7 columns"><textarea name="f[crt][spsso]['+e+'][certdata]" cols="65" rows="20" id="f[crt][spsso]['+e+'][certdata]" class="certdata" ></textarea></div><div class="small-1 large-2 columns end"></div></div><div class="small-12 columns"><div class="small-3 columns">&nbsp;</div><div class="small-6 large-7 columns"><button class="certificaterm button alert  right" value="'+e+'" name="certificate" type="button">Remove certificate</button></div><div class="small-3 large-2 columns"></div></div></div>';$(this).parent().before(t)}),$("#nacsbtn").click(function(){var e=genRandomStr(5),t='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][AssertionConsumerService][n_'+e+'][bind]" class="right inline">Binding Name</label></div><div class="small-5 columns inline"><select name="f[srv][AssertionConsumerService][n_'+e+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST-SimpleSign">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST-SimpleSign</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:PAOS">urn:oasis:names:tc:SAML:2.0:bindings:PAOS</option> <option value="urn:oasis:names:tc:SAML:2.0:profiles:browser-post">urn:oasis:names:tc:SAML:2.0:profiles:browser-post</option> <option value="urn:oasis:names:tc:SAML:1.0:profiles:browser-post">urn:oasis:names:tc:SAML:1.0:profiles:browser-post</option> <option value="urn:oasis:names:tc:SAML:1.0:profiles:artifact-01">urn:oasis:names:tc:SAML:1.0:profiles:artifact-01</option> </select></div> <div class="small-4 columns"><div class="small-6 columns"><input type="text" name="f[srv][AssertionConsumerService][n_'+e+'][order]" value="" id="f[srv][AssertionConsumerService][n_'+e+'][order]" size="2" maxlength="2" class="acsindex "  /></div><div class="small-6 columns"><label for="f[srv][AssertionConsumerService][n_'+e+'][default]">Is default</label><input type="radio" name="f[srv][AssertionConsumerService][n_'+e+'][default]" value="1" id="f[srv][AssertionConsumerService][n_'+e+'][default]" class="acsdefault"/></div></div> </div>          <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][AssertionConsumerService][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-8 large-7 columns inline"><input name="f[srv][AssertionConsumerService][n_'+e+'][url]" id="f[srv][AssertionConsumerService][n_'+e+'][url]" type="text"></div><div class="small-3 large-2 columns"><button class="inline left button  alert rmfield"  name="rmfield" type="button">Remove</button></div></div></div>';$(this).parent().before(t)}),$("#nidpartifactbtn").click(function(){var e=genRandomStr(5),t='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][IDPArtifactResolutionService][n_'+e+'][bind]" class="right inline">Binding Name</label></div><div class="small-6 large-7 columns inline"><select name="f[srv][IDPArtifactResolutionService][n_'+e+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:SOAP" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</option> <option value="urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding">urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding</option></select></div> <div class="small-2 large-1 columns end"><input type="text" name="f[srv][IDPArtifactResolutionService][n_'+e+'][order]" value="" id="f[srv][IDPArtifactResolutionService][n_'+e+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div> <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][IDPArtifactResolutionService][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns inline"><input name="f[srv][IDPArtifactResolutionService][n_'+e+'][url]" id="f[srv][IDPArtifactResolutionService][n_'+e+'][url]" type="text"></div><div class="small-3 large-2 columns"><button class="inline left button  alert rmfield" value="" name="rmfield" type="button">Remove</button></div></div>';$(this).parent().before(t)}),$("#nspartifactbtn").click(function(){var e=genRandomStr(5),t='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][SPArtifactResolutionService][n_'+e+'][bind]" class="right inline">Binding Name</label></div><div class="small-8 large-7 columns inline"><select name="f[srv][SPArtifactResolutionService][n_'+e+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:SOAP" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</option> <option value="urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding">urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding</option></select> </div> <div class="small-1  columns left"><input type="text" name="f[srv][SPArtifactResolutionService][n_'+e+'][order]" value="" id="f[srv][SPArtifactResolutionService][n_'+e+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div>           <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][SPArtifactResolutionService][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns inline"><input name="f[srv][SPArtifactResolutionService][n_'+e+'][url]" id="f[srv][SPArtifactResolutionService][n_'+e+'][url]" type="text"> </div><div class="small-3 large-2 columns"><button class="inline left button  alert rmfield"  name="rmfield" type="button">Remove</button></div></div>';$(this).parent().before(t)}),$("#ndrbtn").click(function(){var e=genRandomStr(5),t='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][DiscoveryResponse][n_'+e+'][bind]" class="right inline">Binding Name</label></div><div class="small-6 large-7 columns"><select name="f[srv][DiscoveryResponse][n_'+e+'][bind]"><option value="urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol">urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol</option></select> </div><div class="small-1 columns end"><input type="text" name="f[srv][DiscoveryResponse][n_'+e+'][order]" value="" id="f[srv][DiscoveryResponse][n_'+e+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][DiscoveryResponse][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns"><input name="f[srv][DiscoveryResponse][n_'+e+'][url]" id="f[srv][DiscoveryResponse][n_'+e+'][url]" type="text"></div><div class="small-1 columns end"><button class="rmfield button alert  left" name="rmfield">Remove</button></div></div></div>';$(this).parent().before(t)}),$("#nribtn").click(function(){var e=genRandomStr(5),t='<div class="small-12 columns srvgroup"><div class="small-3 columns"><label for="f[srv][RequestInitiator][n_'+e+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns"><input name="f[srv][RequestInitiator][n_'+e+'][url]" id="f[srv][RequestInitiator][n_'+e+'][url]" type="text"></div><div class="small-3 large-2 columns"><button type="button" class="inline left button  alert rmfield" name="rmfield" value="">remove</button></div></div>';$(this).parent().before(t)}),$("button.addnewlogo").click(function(){var e,t=$(this).closest("div.reviewlogo"),a=t.attr("id"),i=genRandomStr(5),n="sp";"idpreviewlogo"===a&&(n="idp");var s,r=t.find("input[name='"+n+"inputurl']").attr("value"),o=t.find("input[name='"+n+"inputsize']").attr("value"),l=t.find("select[name='"+n+"logolang']").val(),d=t.find("input[name='"+n+"embedded']").first(),c=t.find("input[name='"+n+"logoraw']").attr("value");e="0"===l?"unspec":l;var u='<input type="hidden" name="f[uii]['+n+"sso][logo][n"+i+'][size]" value="'+o+'">',p='<input type="hidden" name="f[uii]['+n+"sso][logo][n"+i+'][lang]" value="'+l+'">',f=$("li#nlogo"+n+"row"),m=f.clone(!0);m.removeAttr("id"),null!==d&&d.is(":checked")&&"embedded"===d.val()&&null!=c&&""!==c?(s='<input type="hidden" name="f[uii]['+n+"sso][logo][n"+i+'][url]" value="'+c+'">',m.find("img").first().attr("src",c).append(s).append(u).append(p),m.find("div.logoinfo").first().append(e+"<br />").append(o+"<br />")):(s='<input type="hidden" name="f[uii]['+n+"sso][logo][n"+i+'][url]" value="'+r+'">',m.find("img").first().attr("src",r).append(s).append(u).append(p),m.find("div.logoinfo").first().append(e+"<br />").append(r+"<br />").append(o+"<br />")),m.insertBefore(f).show()}),$("button.getlogo").click(function(){var l,d,e,c,u=$(this).attr("name"),t=$(this).attr("value");d=(e="idpgetlogo"===u?((c=$("#idpreviewlogo")).hide(),(l=$("small.idplogoretrieve")).empty().hide(),$("[name='idplogoretrieve']").val()):((c=$("#spreviewlogo")).hide(),(l=$("small.splogoretrieve")).empty().hide(),$("[name='splogoretrieve']").val()),c.find("div.imgsource").first());var a=[{name:$("[name='csrfname']").val(),value:$("[name='csrfhash']").val()},{name:"logourl",value:e}];$.ajax({type:"POST",url:t,cache:!1,data:a,dataType:"json",success:function(e){if(e)if(e.error)l.append(e.error).show();else if(e.data){var t=e.data,a=new Image;a.onload=function(){},a.src=t.url;var i,n,s,r,o=t.width+"x"+e.data.height;genRandomStr(5);"idpgetlogo"===u?(s='<input type="hidden" name="logotype" value="idp">',i='<input type="hidden" name="idpinputurl" value="'+e.data.url+'">',n='<input type="hidden" name="idpinputsize" value="'+o+'">',r='<input type="hidden" name="idplogoraw" value="'+e.data.raw+'">',d.empty().append(a).append(i).append(n).append(s).append(r),$("div#idpreviewlogo div.logoinfo").empty().append(o),c.show()):"spgetlogo"===u&&(s='<input type="hidden" name="logotype" value="idp">',i='<input type="hidden" name="spinputurl" value="'+e.data.url+'">',n='<input type="hidden" name="spinputsize" value="'+o+'">',r='<input type="hidden" name="splogoraw" value="'+e.data.raw+'">',d.empty().append(a).append(i).append(n).append(s).append(r),$("div#spreviewlogo div.logoinfo").empty().append(o),c.show())}}})}),t.on("click","button.contactrm",function(e){$(this).attr("value"),$(this).attr("name");$(this).closest("div.group").remove()}),t.on("click","button.certificaterm",function(e){$(this).attr("value"),$(this).attr("name");$(this).closest("div.certgroup").remove()}),t.on("click","input.acsdefault",function(e){$(this).is(":checked")&&$(".acsdefault").not(this).removeAttr("checked")}),t.on("click","button.rmfield",function(e){var t=$(this).closest("div.srvgroup");$(this).attr("value"),$(this).attr("name");t.find("input").each(function(){$(this).attr("value","")}),t.find("textarea").each(function(){$(this).val("")}),t.remove()}),t.on("click","button.langinputrm",function(e){var t=$(this).closest("div").parent(),a=$(this).attr("value"),i=$(this).closest("div.group").find("select").first();return t.find("input").each(function(){$(this).attr("value","")}),t.find("textarea").each(function(){$(this).val("")}),i.find("option[value="+a+"]").each(function(){$(this).toggleOption(!0),$(this).attr("disabled",!1)}),t.remove(),!1})}if($("#spmatrixload").on("click",function(e){var d=$(this),t=$(this).attr("data-jagger-ajaxurl"),c=$(document).find("#spmatrixdiv").first();$.ajax({type:"GET",url:t,cache:!1,dataType:"json",beforeSend:function(){spinImage.show()},success:function(e){if(spinImage.hide(),e){var i,n,s,t=e.attrs,a=e.data,r=e.providerprefurl,o=0,l='<table class="table table-header-rotated" id="idpmatrixresult"><thead><tr>';l+='<th style="background: white"><div><span class="den">&nbsp;&nbsp;&nbsp;</span> <span>denied</span></div><div><span class="perm">&nbsp;&nbsp;&nbsp;</span><span>permitted</span></div><div><span class="dis">&nbsp;&nbsp;&nbsp;</span><span>not supported</span></div><div><span>R</span>-<span>required</span></div><div><span>D</span>-<span>desired</span></div></th>',$.each(t,function(e,t){l+='<th class="rotate"><div><span>'+e+"</span></div></th>",o++}),52<o&&$("#container").css({"max-width":"100%"}),l+="</tr></thead><tbody>",$.each(a,function(e,a){l+='<tr><td data-jagger-entidlink="'+a.idpid+'" class="searchcol"><a href="'+r+"/"+a.idpid+'" title="'+a.entityid+'" >'+a.name+'</a><span class="hidden">'+e+"</span></td>",$.each(t,function(e,t){s="",n=a.data.attributes[""+e],i=t[0].toUpperCase(),void 0===n?s="dis":0===n?s="den":1===n?s="R"===i?"perm":"den":2===n&&(s="perm"),l+='<td class="'+s+'">',l+=i+"</td>"})}),l+="</tbody></table>",d.hide(),c.html(l)}},error:function(){spinImage.hide()}})}),0<$("#attrpols").length){var I,p=$("#attrpols").first(),f=$("#attrpolstab").first(),m=function(){f.foundation("_handleTabChange",$("li.tabs-title.is-active"))},v=$("#arpmaddspecattr").first();s=p.attr("data-jagger-providerdetails"),f.on("change.zf.tabs",function(e,t){var a=$($.parseHTML('<div class="progress"><span class="meter" style="width: 10%"></span></div>')).find("span.meter").first(),k=$("#addattrsupport").clone(!0).removeClass("hidden"),T=$("#addentcatattr").clone(!0).removeClass("hidden"),C=$("#addespecattr").clone(!0).removeClass("hidden");console.log(e,t);var i=$(t).attr("data-reveal-ajax-tab");if(void 0===i)return!1;var S,A=p.find("section.is-active").first();$.ajax({url:i,method:"GET",dataType:"json",beforeSend:function(){spinImage.show()},success:function(s){spinImage.hide(),a.css("width","100%");var r,i,o,n,l=[];if("supported"===s.type)$.each(s.data.support,function(e,t){l.push(t)}),S='<div class="small-12 column"><table class="table"><thead><tr>',$.each(s.definitions.columns,function(e,t){S+="<th>"+t+"</th>"}),S+="</tr></thead>",$.each(s.data.global,function(e,t){n=parseInt(t),i="",S+="<tr><td>"+s.definitions.attrs[e]+"</td><td>",S+=0===n?'<span class="label alert">'+s.definitions.policy[t]+"</span>":1===n?'<span class="label warning">'+s.definitions.policy[t]+"</span>":2===n?'<span class="label success">'+s.definitions.policy[t]+"</span>":'<span class="label">'+s.definitions.policy[t.policy]+"</span>";var a="1";-1===(r=l.indexOf(parseInt(e)))&&(i='&nbsp;<span class="label alert">'+s.definitions.policy[1e3]+"</span>",a="0"),S+=i,S+="</td><td>",S+='<a href="#" class="modalconfirm" data-jagger-attrpolicy="'+t+'" data-jagger-attrsupport="'+a+'" data-jagger-attrname="'+s.definitions.attrs[e]+'" data-jagger-attrid="'+e+'" data-jagger-action="edit" data-jagger-arp="global"><i class="fa fa-edit"></i></a>',-1===r&&(S+='&nbsp;&nbsp;&nbsp;<a href="#" class="modalconfirm" data-jagger-attrsupport="'+a+'" data-jagger-attrname="'+s.definitions.attrs[e]+'" data-jagger-attrid="'+e+'" data-jagger-action="delete" data-jagger-arp="global"><i class="fa fa-trash alert"></i></a>'),S+="</td></tr>"}),S+="</table></div>",k.show().prependTo(A.html(S));else if("federation"===s.type){var d,c;$.each(s.data.support,function(e,t){l.push(t)}),o=0;var t=s.definitions.lang.federation;S='<div class="small-12 column"><table class="table"><thead><tr>',$.each(s.definitions.columns,function(e,t){o+=1,S+="<th>"+t+"</th>"}),S+="</tr></thead>";var u,p=o-2,f=s.definitions.statusstr;$.each(s.data.fedpols,function(a,e){var i=l.slice(0);I=parseInt(a),u=s.data.activefeds.indexOf(I),S+=-1===u?'<tr><td colspan="'+o+'" class="highlight">'+t+": "+s.definitions.feds[a]+' <span class="label alert">'+f.inactive+"</span></td></tr>":'<tr><td colspan="'+o+'" class="highlight">'+t+": "+s.definitions.feds[a]+"</td></tr>",$.each(e,function(e,t){c="",d=parseInt(t.policy),r=i.indexOf(parseInt(e)),0===d?c="alert":1===d?c="warning":2===d&&(c="success"),S+="<tr><td>"+s.definitions.attrs[e]+'</td><td><span class="label '+c+'">'+s.definitions.policy[t.policy]+"</span><br/><small>"+t.comments.reverse().join("<br/>")+"</small>",-1===r?S+='&nbsp;<span class="label alert">'+s.definitions.lang.unsupported+"</span>":i.splice(r,1),S+='</td><td></td><td colspan="'+p+'"><a href="#" class="modalconfirm" data-jagger-attrpolicy="'+t.policy+'" data-jagger-arp="fed" data-jagger-action="edit" data-jagger-fedid="'+a+'" data-jagger-attrid="'+e+'" data-jagger-attrname="'+s.definitions.attrs[e]+'"><i class="fa fa-edit"></i></a></td></tr>'}),$.each(i,function(e,t){S+="<tr><td>"+s.definitions.attrs[t]+'</td><td><span class="label secondary">'+s.definitions.policy[100]+'</span></td><td></td><td colspan="'+p+'"><a href="#" class="modalconfirm" data-jagger-arp="fed" data-jagger-attrname="'+s.definitions.attrs[t]+'" data-jagger-attrpolicy="100" data-jagger-fedid="'+a+'" data-jagger-action="edit" data-jagger-attrid="'+t+'"><i class="fa fa-edit"></i></a></td></tr>'})}),S+="</table></div>",A.html(S)}else if("entcat"===s.type){var m,v;o=0;var h=s.definitions.ecmembers;$.each(s.data.support,function(e,t){l.push(t)}),S='<div class="small-12 column"><table class="table"><thead><tr>',$.each(s.definitions.columns,function(e,t){o+=1,S+="<th>"+t+"</th>"}),S+="</tr></thead>",$.each(s.data.entcats,function(a,e){S+='<tr><td colspan="'+o+'" class="highlight">EntityCategory: '+s.definitions.entcats[a].name+"  "+s.definitions.entcats[a].value+' <i class="ecmembers fa fa-list"  data-jagger-jsource="'+h+"/"+a+'"></i></td></tr>',$.each(e,function(e,t){v="",-1===(r=l.indexOf(parseInt(e)))&&(v='&nbsp;<span class="label alert">'+s.definitions.policy[1e3]+"</span>"),c="",0===(m=parseInt(t.policy))?c="alert":1===m?c="warning":2===m&&(c="success"),S+="<tr>",S+="<td>"+s.definitions.attrs[e]+'</td><td><span class="label '+c+'">'+s.definitions.policy[t.policy]+"</span>"+v+"<br /><small>"+t.comments.reverse().join("<br />")+'</small></td><td><a href="#" class="modalconfirm" data-jagger-arp="entcat" data-jagger-entcatid="'+a+'" data-jagger-attrid="'+e+'" data-jagger-arp="entcat" data-jagger-action="edit" data-jagger-attrname="'+s.definitions.attrs[e]+'" data-jagger-attrpolicy="'+t.policy+'"><i class="fa fa-edit"></i></a></td>',S+="</tr>"})}),S+="</table></div>",T.show().prependTo(A.html(S))}else if("sp"===s.type){var g;o=1,S='<div class="small-12 column"><table class="table"><thead><tr>',$.each(s.definitions.columns,function(e,t){o+=1,S+="<th>"+t+"</th>"}),S+="</tr></thead>",$.each(s.data.supported,function(e,t){l.push(t)});s.data.sps;var b,y,w,x={0:"alert",1:"warning",2:"success",100:"secondary"},j='<span class="label alert">'+s.definitions.policy[1e3]+"</span>";$.each(s.data.sps,function(a,i){var n=[];if(void 0!==i.req&&$.each(i.req,function(e,t){n[e]=t}),!$.isEmptyObject(i.spec))for(var e in void 0!==i.entityid?S+='<tr><td data-jagger-entidlink="'+a+'" colspan="'+o+'" class="highlight" >'+i.entityid+"</td></tr>":s.definitions.sps.hasOwnProperty(a)?S+='<tr><td data-jagger-entidlink="'+a+'" colspan="'+o+'" class="highlight">'+s.definitions.sps[a].entityid+' <span class="label alert">disabled</span></td></tr>':console.log("undefined "+a+" in data.definitions.sps"),$.each(i.spec,function(e,t){y=w="",-1===(r=l.indexOf(parseInt(e)))&&(y=j),b=s.data.definitions.attrs[e],g="100",void 0!==n[e]&&(g=n[e],delete n[e]),void 0!==i.custom&&void 0!==i.custom[e]&&(void 0!==i.custom[e].policy.deny?(w+='<span class="label alert">denied values:  ',$.each(i.custom[e].policy.deny,function(e,t){w+=t+", "})):(w+='<span class="label success">permited values: ',$.each(i.custom[e].policy.permit,function(e,t){w+=t+", "})),w+="</span>"),console.log(t),S+="<td>"+b+'</td><td><span class="label '+x[t.policy]+'">'+s.definitions.policy[t.policy]+"</span>  "+y+" "+w+"<br /><small>"+t.comments.reverse().join("<br />")+"</small></td></td><td>"+s.definitions.req[g]+'</td><td><a href="#" class="modalconfirm" data-jagger-attrpolicy="'+t.policy+'" data-jagger-entityid="'+s.definitions.sps[a].entityid+'" data-jagger-attrname="'+b+'" data-jagger-spid="'+a+'" data-jagger-arp="sp" data-jagger-action="edit" data-jagger-attrid="'+e+'"><i class="fa fa-edit"></i></a></td></tr>'}),n)n.hasOwnProperty(e)&&(w="",void 0!==i.custom&&void 0!==i.custom[e]&&(void 0!==i.custom[e].deny?(w+='<span class="label alert">denied values:  ',$.each(i.custom[e].deny,function(e,t){w+=t+", "})):(w+='<span class="label success">permited values: ',$.each(i.custom[e].permit,function(e,t){w+=t+", "})),w+="</span>"),y="",-1===(r=l.indexOf(parseInt(e)))&&(y=j),b=s.data.definitions.attrs[e],n.hasOwnProperty(e)&&(S+="<tr><td>"+b+'</td><td><span class="label '+x[100]+'">'+s.definitions.policy[100]+"</span>  "+y+" "+w+"</td><td>"+s.definitions.req[n[e]]+'</td><td><a href="#" class="modalconfirm" data-jagger-attrpolicy="100" data-jagger-entityid="'+s.definitions.sps[a].entityid+'" data-jagger-attrname="'+b+'" data-jagger-spid="'+a+'" data-jagger-arp="sp" data-jagger-action="edit" data-jagger-attrid="'+e+'"><i class="fa fa-edit"></i></i></td></tr>'))}),S+="</table></div>",C.show().prependTo(A.html(S))}},error:function(e,t,a){spinImage.hide(),A.html('<div data-aler class="alert-box alert">'+e.responseText+"</div>")}})}),p.on("click","td.highlight",function(e){var t=$(this).attr("data-jagger-entidlink");if(void 0!==t)return document.location.href=s+"/"+t,!1}),p.on("click","a.modalconfirm",function(e){e.preventDefault();var t,a=$(this),i=a.attr("data-jagger-arp"),n=a.attr("data-jagger-action"),s=a.attr("data-jagger-attrname"),r=a.attr("data-jagger-attrid"),o=a.attr("data-jagger-fedid"),l=a.attr("data-jagger-entcatid"),d=a.attr("data-jagger-attrsupport"),c=a.attr("data-jagger-attrpolicy"),u=a.attr("data-jagger-spid"),p=a.attr("data-jagger-entityid");$("[name='baseurl']").val();if(void 0!==i&&void 0!==n)if("global"===i&&"delete"===n)(t=$("#arpmdelattr")).find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find('input[name="attrname"]').first().val(s),t.find('input[name="attrid"]').first().val(r),t.find("span.attributename").first().html(s),t.foundation("open");else if("global"===i&&"edit"===n){(t=$("#arpmeditglobalattr")).find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find("span.attributename").first().html(s),t.find('input[name="attrname"]').first().val(s),t.find('input[name="attrid"]').first().val(r);var f=t.find('input[name="support"]').first();"1"===d?f.prop("checked",!0):f.prop("checked",!1),t.find('[name="policy"] option').prop("selected",!1).filter('[value="'+c+'"]').prop("selected",!0),t.foundation("open")}else if("fed"===i&&"edit"===n)(t=$("#arpmeditfedattr")).find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find("span.attributename").first().html(s),t.find('input[name="attrid"]').first().val(r),t.find('input[name="fedid"]').first().val(o),t.find('textarea[name="comment"]').first().val(""),t.find('[name="policy"] option').prop("selected",!1).filter('[value="'+c+'"]').prop("selected",!0),t.foundation("open");else if("entcat"===i&&"edit"===n)(t=$("#arpmeditentcatattr")).find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find("span.attributename").first().html(s),t.find('input[name="attrid"]').first().val(r),t.find('input[name="entcatid"]').first().val(l),t.find('textarea[name="comment"]').first().val(""),t.find('[name="policy"] option').prop("selected",!1).filter('[value="'+c+'"]').prop("selected",!0),t.foundation("open");else if("sp"===i&&"edit"===n){(t=$("#arpmeditspattr")).find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide(),t.find("span.attributename").first().html(s),t.find("span.requestersp").first().html(p),t.find('input[name="attrid"]').first().val(r),t.find('input[name="spid"]').first().val(u),t.find('textarea[name="comment"]').first().val(""),t.find('[name="policy"] option').prop("selected",!1).filter('[value="'+c+'"]').prop("selected",!0);var m=t.attr("data-jagger-getdata"),v=t.find("form").first(),h=v.serializeArray(),g=(v.find('[name="custompolicy"]').first(),v.find('[name="customvals"]').first()),b=v.find('[name="customenabled"]').first();g.empty();var y="";b.prop("checked",!1),$.ajax({url:m,method:"POST",dataType:"json",data:h,success:function(e){e.data&&void 0!==e.data.customsp&&(e.data.customsp.deny?(b.prop("checked",!0),v.find('[name="custompolicy"] option').prop("selected",!1).filter('[value="deny"]').prop("selected",!0),$.each(e.data.customsp.deny,function(e,t){y+=t+", "})):e.data.customsp.permit&&(b.prop("checked",!0),v.find('[name="custompolicy"] option').prop("selected",!1).filter('[value="permit"]').prop("selected",!0),$.each(e.data.customsp.permit,function(e,t){y+=t+", "})),g.text(y))}}),t.foundation("open")}}),$("#arpmdelattr").on("click","div.yes",function(e){var t=$("#arpmdelattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmdelattr").foundation("close"),m()}})}),$("#arpmeditglobalattr").on("click","div.yes",function(e){var t=$("#arpmeditglobalattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmeditglobalattr").foundation("close"),m()},error:function(e,t,a){$("#arpmeditglobalattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),p.on("click","#addattrsupport button",function(e){var t=$("#addattrsupport").attr("data-jagger-link");$.ajax({url:t,method:"GET",dataType:"json",success:function(e){if(e.data.support){var a=$("#arpmaddattr").find("select[name='attrid']");a.find("option").removeAttr("disabled"),$.each(e.data.global,function(e,t){a.find("option[value="+e+"]").prop("disabled","disabled")})}}}),$("#arpmaddattr").foundation("open")}),p.on("click","#addentcatattr button",function(e){var t=$("#addentcatattr").attr("data-jagger-link");$.ajax({url:t,method:"GET",dataType:"json",success:function(a){var i=$("#arpmaddentcatattr").find("select[name='attrid']");i.empty();var n=$("#arpmaddentcatattr").find("select[name='entcatid']");n.empty(),a.data.support&&$.each(a.data.support,function(e,t){i.append($("<option></option>").attr("value",t).text(a.definitions.attrs[t]))}),a.data.entcats&&$.each(a.data.entcats,function(e,t){n.append($("<option></option>").attr("value",t.entcatid).text(t.value))})}}),$("#arpmaddentcatattr").foundation("open")}),p.on("click","#addespecattr button",function(e){var t=$("#addespecattr").attr("data-jagger-link"),a=v;a.find('[name="customvals"]').first().empty(),a.find("div.response").first().removeClass("alert").removeClass("alert-box").empty().hide();var i=a.find("select[name='attrid']");i.empty().append($("<option></option>").attr("value","0").text(""));var n=a.find("select[name='spid']");n.empty().append($("<option></option>").attr("value","0").text("")),$.ajax({url:t,method:"GET",dataType:"json",success:function(e){e.members&&$.each(e.members,function(e,t){n.append($("<option></option>").attr("value",t.pid).text(t.name+" ("+t.entityid+")"))}),e.attrs&&$.each(e.attrs,function(e,t){i.append($("<option></option>").attr("value",t.attrid).text(t.name))})}}),a.foundation("open"),n.select2({width:"100%"}),i.select2({width:"100%"})}),$("#arpmaddattr").on("click","div.yes",function(e){var t=$("#arpmaddattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmaddattr").foundation("close"),m()},error:function(e,t,a){$("#arpmaddattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),$("#arpmeditfedattr").on("click","div.yes",function(e){var t=$("#arpmeditfedattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmeditfedattr").foundation("close"),m()},error:function(e,t,a){$("#arpmeditfedattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),v.on("change","select",function(e){var t=$(this).attr("name");(void 0===t||"spid"!==t&&"attrid"!==t)&&console.log("TT"),"spid"===t&&console.log("DDDDDDDDDDDD")}),v.on("click","div.yes",function(e){var t=v,i=t.find(".response").first();i.empty().removeClass("alert").removeClass("alert-box").hide();var a=t.find("form").first(),n=a.serializeArray(),s=a.attr("action");$.ajax({url:s,method:"POST",dataType:"json",data:n,success:function(e){i.empty().removeClass("alert").removeClass("alert-box").hide(),t.foundation("close"),m()},error:function(e,t,a){i.html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),$("#arpmeditspattr").on("click","div.yes",function(e){var t=$("#arpmeditspattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmeditspattr").foundation("close"),m()},error:function(e,t,a){$("#arpmeditspattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),$("#arpmeditentcatattr").on("click","div.yes",function(e){var t=$("#arpmeditentcatattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmeditentcatattr").foundation("close"),m()},error:function(e,t,a){$("#arpmeditentcatattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})}),$("#arpmaddentcatattr").on("click","div.yes",function(e){var t=$("#arpmaddentcatattr").find("form").first(),a=t.serializeArray(),i=t.attr("action");$.ajax({url:i,method:"POST",dataType:"json",data:a,success:function(e){$("#arpmaddentcatattr").foundation("close"),m()},error:function(e,t,a){$("#arpmaddentcatattr").find(".response").html(e.responseText).addClass("alert").addClass("alert-box").show()}})})}var h=$("#matrixloader").first(),g=$("#idpmatrixdiv").first(),b=$("#policyupdater").first();if(1===h.length){var y=b.attr("data-jagger-link"),w=b.find("form").first();s=h.attr("data-jagger-providerdetails");var x,j=b.find("span.mrequester").first(),k=b.find("span.mattribute").first(),T=(b.find("div.yes").first(),b.find("div.attrflow").first());b.on("click",".yes",function(e){e.preventDefault();var t=w.attr("action");$.ajax({type:"POST",url:t,data:w.serializeArray(),success:function(e){if(b.foundation("close"),!x.hasClass("dis")){var t=$.trim(x.text());"2"===e&&("R"===t||"D"===t)||"1"===e&&"R"===t?x.attr("class","perm"):"2c"===e&&("R"===t||"D"===t)||"1c"===e&&"R"===t?x.attr("class","spec"):"1"===e&&"D"===t||"0"===e?x.attr("class","den"):("1c"===e&&"D"===t||"0c"===e)&&x.attr("class","den")}}})}),g.on("click","td",function(e){spinImage.show();var t=(x=$(this)).attr("data-jagger-entidlink");if(void 0!==t)return document.location.href=s+"/"+t,!1;var a=x.attr("data-jagger-spid"),i=x.attr("data-jagger-attrid");void 0!==a&&void 0!==i&&$.ajax({type:"GET",url:y+"/"+a+"/"+i,cache:!1,dataType:"json",success:function(e){w.find("select[name='policy']").prop("selected",!1).filter('[value=""]').prop("selected",!0),w.find("input[name='attribute']").first().val(e.attributename),w.find("input[name='requester']").first().val(e.requester),j.html(e.requester),k.html(e.attributename);var i=$("<tbody></tbody>");$.each(e.details,function(e,t){var a="<tr><td>"+t.name+"</td><td>"+t.value+"</td></tr>";i.append(a)});var t=$("<table/>").css({"font-size":"smaller"}).addClass("detailsnosort").addClass("small-12").addClass("columns"),a=$("<div/>");t.append('<thead><tr><th colspan="2">Current attribute flow</th></tr></thead>'),t.append(i),a.append(t),T.html(a.html()),b.foundation("open"),spinImage.hide()}})});var C=h.attr("data-jagger-link");if(void 0===C)return!1;$.ajax({type:"GET",url:C,cache:!1,dataType:"json",success:function(e){if(spinImage.hide(),e){var i,t=new Date,n=e.attributes,a=e.policies,s=e.total,r=e.message;if(void 0!==s&&0===s&&void 0!==r){var o='<div class="small-12 medium-11 columns small-centered"><div data-alert class="alert-box warning">'+r+"</div></div>";return g.html(o),!1}var l,d,c,u=0,p='<table class="table table-header-rotated" id="idpmatrixresult"><thead><tr>';p+='<th style="background: white"><div><span class="den">&nbsp;&nbsp;&nbsp;</span> <span>denied</span></div><div><span class="perm">&nbsp;&nbsp;&nbsp;</span> <span>permitted</span></div><div><span class="dis">&nbsp;&nbsp;&nbsp;</span> <span>not supported</span></div><div><span>R</span> <span>required</span></div><div><span>D</span> <span>desired</span></div></th>',$.each(n,function(e,t){p+='<th class="rotate"><div><span>'+e+"</span></div></th>",u++}),52<u&&$("#container").css({"max-width":"100%"}),p+="</tr></thead><tbody>",$.each(a,function(e,a){p+='<tr><td data-jagger-entidlink="'+a.spid+'" class="searchcol"><span data-tooltip aria-haspopup="true" class="has-tip" data-options="disable_for_touch:true" title="'+e+'" >'+a.name+'</span><span class="hidden">'+e+"</span></td>",$.each(n,function(e,t){d=null,c=void 0!==a.attributes[e]?a.attributes[e]:null,void 0!==a.req[e]&&(d=a.req[e]),l=null!==d?d[0].toUpperCase():"",i=null!==c?0===c?"den":1===c?void 0!==a.custom[e]?"spec":"perm":"dis":"dis",p+='<td data-jagger-spid="'+a.spid+'" data-jagger-attrid="'+t+'" class="'+i+'" title="'+e+'">',p+=l+"</td>"})}),p+="</tbody></table>";var f=new Date,m=f-t;console.log("time of generating matrix: "+m),g.html(p),m=new Date-f,console.log("time of input matrinx into DOM: "+m),$("#idpmatrixresult").searcher({inputSelector:"#tablesearchinput",textSelector:".searchcol"})}},beforeSend:function(){spinImage.show()},error:function(e,t,a){spinImage.hide();var i='<div class="small-12 medium-11 columns small-centered"><div data-alert class="alert-box error">'+a+"</div></div>";return g.html(i),!1}})}var S=$("#showhelps");S.length&&(S.hasClass("helpactive")?$(".dhelp").show():$(".dhelp").hide());var A=$("#fedlogin").first(),R=A.attr("href"),D=-(new Date).getTimezoneOffset();if(A.attr("href",R+"/"+D),$("#fedcategories li.active").length){var O=$("#fedcategories li.active").find("a").first().attr("href"),_=$("table.fedistpercat");$.ajax({url:O,timeout:2500,cache:!0,dataType:"json",value:$("table.fedistpercat"),success:function(e){spinImage.hide(),e?($("table.fedistpercat tbody tr").remove(),$.each(e,function(e,t){var a="<tr><td>"+t.name+"</td><td>"+t.urn+"</td><td>"+t.labels+"</td><td>"+t.desc+"</td><td>"+t.members+"</td></tr>";_.append(a)})):window.alert("no data in federation category")}})}$(".fedcategory").on("click","",function(e){$(this).closest("ul").find("li").removeClass("active"),$(this).closest("li").addClass("active");var t=$(this).attr("href"),i=$("table.fedistpercat");return $.ajax({url:t,timeout:2500,cache:!0,dataType:"json",value:i,success:function(e){spinImage.hide(),e?($("table.fedistpercat tbody tr").remove(),$.each(e,function(e,t){var a="<tr><td>"+t.name+"</td><td>"+t.urn+"</td><td>"+t.labels+"</td><td>"+t.desc+"</td><td>"+t.members+"</td></tr>";i.append(a)})):window.alert("no data in federation category")},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("problem with loading data")}}).done(function(){i.html()}),!1}),$(".userlogout").on("click",function(e){var t=$("[name='baseurl']").val(),a=$(this).attr("jagger-data-logout"),i=$(this).attr("href"),n=t;return null===t&&(n=i),null!==a&&""!==a&&$.ajax({type:"GET",url:a,cache:!1}),$.ajax({type:"GET",url:i,cache:!1,success:function(){window.location.href=n}}),!1})}),$(function(){var e=$("#filter"),t=$("#filter-form");$("div.floating-menu").addClass("mobilehidden"),$("table.idplist tr td:first-child").addClass("homeorg"),$("table.idplist tr td:first-child span.alert").removeClass("alert").parent().addClass("alert");var a=$("table.filterlist");a.find("tbody > tr").find("td:eq(1)").mousedown(function(){}),e.keyup(function(){$.uiTableFilter(a,this.value)}),t.submit(function(){return a.find("tbody > tr:visible > td:eq(1)").mousedown(),!1}).focus(),$("table.splist tr td:first-child span.alert").removeClass("alert").parent().addClass("alert");var i=$("table.splist");i.find("tbody > tr").find("td:eq(1)").mousedown(function(){}),e.keyup(function(){$.uiTableFilter(i,this.value)}),t.submit(function(){return i.find("tbody > tr:visible > td:eq(1)").mousedown(),!1}).focus(),$(".datepicker").datepicker({dateFormat:"yy-mm-dd"});var r=$("[name='baseurl']").val();void 0===r&&(r=""),$.ajaxSetup({cache:!1});var o=$("#qcounter");if(0<o.length){var n=o.attr("data-jagger-src"),s=sessionStorage.getItem("jaggerqcounter");null!==s&&o.html(parseInt(s));var l=function(){var s=$("#dashresponsecontainer").first();$.ajax({url:n,method:"GET",cache:!1,dataType:"json",success:function(e){var a=0;if(e.data&&$.each(e.data,function(e,t){a+=t.length}),sessionStorage.setItem("jaggerqcounter",a),o.html(a),s){var i=[];if(e.definitions){var t=e.definitions;i.push('<table id="detailsi" class="itablesorter"><thead><tr><th>'+t.date+"</th><th>"+t.requester+"</th><th>"+t.requesttype+"</th><th></th></tr><thead><tbody>")}else i.push('<table id="detailsi" class="itablesorter"><thead><tr><th>Date</th><th>Requester</th><th>Request type</th><th></th></tr><thead><tbody>');e.data.q&&$.each(e.data.q,function(e,t){i.push("<tr><td>"+t.idate+"</td><td>"+t.requesterCN+" "+t.mail+"</td><td>"+t.type+" - "+t.action+'</td><td><a href="'+r+"reports/awaiting/detail/"+t.token+'"><i class="fa fa-arrow-right"></i></a></td></tr>')}),e.data.s&&$.each(e.data.s,function(e,t){i.push("<tr><td>&nbsp;</td><td>"+t.subscriber+" &lt"+t.subscriber_email+"&gt;</td><td>"+t.type+'</td><td><a href="'+t.url+'"><i class="fa fa-arrow-right"></i></a></td></tr>')}),i.push("</tbody></table>");var n=i.join("");s.html(n)}},error:function(){if(s){s.html('<div data-alert class="alert-box alert center">Could not refresh queue</div>')}}})};setTimeout(l,1e3),setInterval(l,3e4)}$("#responsecontainer").load(r+"reports/awaiting/ajaxrefresh"),setInterval(function(){$("#responsecontainer").load(r+"reports/awaiting/ajaxrefresh")},172e3);var d=$("#languageset");d.on("change","select",function(e){var t=d.find("form").first().attr("action")+this.value;return $.ajax({url:t,timeout:2500,cache:!1}).done(function(){d.foundation("close"),setTimeout(function(){go_to_private_page()},1e3)}),!1}),$("select.nuseraccesstype").on("change",function(){"fed"===$(this).find("option:selected").val()?$("div.passwordrow").hide():$("div.passwordrow").show()}),$("button#idpadduiiprvurl").click(function(){var e=$("span.idpuiiprvurladd option:selected").val(),t=$("span.idpuiiprvurladd option:selected").text();$("span.idpuiiprvurladd option[value="+e+"]").remove(),$(this).parent().prepend('<li class="localized"><label for="f[[uii][idpsso][prvurl]['+e+']">'+t+'</label><input id="f[uii][idpsso][prvurl]['+e+']" name="f[uii][idpsso][prvurl]['+e+']" type="text"/></li>')}),$("button#spadduiiprvurl").click(function(){var e=$("span.spuiiprvurladd option:selected").val(),t=$("span.spuiiprvurladd option:selected").text();$("span.spuiiprvurladd option[value="+e+"]").remove(),$(this).parent().prepend('<li class="localized"><label for="f[[uii][spsso][prvurl]['+e+']">'+t+'</label><input id="f[uii][spsso][prvurl]['+e+']" name="f[uii][spsso][prvurl]['+e+']" type="text"/></li>')}),$("button#addlprivacyurl").click(function(){var e=$("li.addlprivacyurl option:selected").val(),t=$("li.addlprivacyurl option:selected").text();$("li.addlprivacyurl option[value="+e+"]").toggleOption(!1),$(this).parent().append('<li class="localized"><label for="lprivacyurl['+e+']">'+t+'</label><input id="lprivacyurl['+e+']" name="lprivacyurl['+e+']" type="text"/></li>')}),$("a#fedmetasigner").click(function(){var e=$(this).attr("href");return $.ajax({url:e,timeout:2500,cache:!1,success:function(e){alert(e)}}),!1}),$("a#providermetasigner").click(function(){var e=$(this).attr("href");return $.ajax({url:e,timeout:2500,cache:!1,success:function(e){window.alert(e)}}),!1}),$("a.downloadstat").click(function(){var e=$(this).attr("href");return $.ajax({url:e,timeout:2500,cache:!1,dataType:"json",success:function(e){e?window.alert(e.status):window.alert("no data")}}),!1}),$("a.lateststat").click(function(){var e=$(this).attr("href");$('<div id="#statisticdiag">');return $.ajax({url:e,timeout:2500,cache:!0,dataType:"json",success:function(e){null,spinImage.hide(),e?($("div#statisticdiag").replaceWith('<div id="statisticdiag"></div>'),$.each(e,function(e,t){(e=new Image).src=t.url,e.onload=function(){$("#statisticdiag").append('<div style="text-align:center; font-weight: bold; width: 90%;">'+t.title+"</div>").append('<div style="font-weight: bolder; width: 90%; text-align: right;">'+t.subtitle+"</div>").append(e)},e.onerror=function(){$("#statisticdiag").append('<div style="text-align:center; font-weight: bold; width: 90%;">'+t.title+"</div>").append('<div style="font-weight: bolder; width: 90%; text-align: right;">'+t.subtitle+"</div>").append('<div data-alert class="alert-box alert">Could not load the image (not found or no access)</div>')}})):window.alert("no data")},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("problem with loading data")}}),!1}),$("a.clearcache").click(function(){var e=$(this).attr("href");return $.ajax({type:"GET",url:e,timeout:2500,cache:!1,success:$(this).remove()}),!1}),$(".updatebookmark").on("click",function(e){var t=$(this).attr("href"),a=$(this),i=$(this).attr("data-jagger-bookmark"),n=$(this).closest("[data-jagger-onsuccess]"),s=n.attr("data-jagger-onsuccess");return void 0===t||void 0===i||$.ajax({url:t+"/"+i,type:"GET",success:function(e){e&&"ok"===e&&(void 0!==s&&"hide"===s?n.hide():a.remove())}}),!1}),$("table.reqattraddform").addClass("hidden"),$("button.hideform").addClass("hidden"),$("form.reqattraddform").addClass("hidden"),$("button.showform").click(function(){$("table.reqattraddform").removeClass("hidden"),$("form.reqattraddform").removeClass("hidden"),$("button.showform").addClass("hidden"),$("button.hideform").removeClass("hidden")}),$("button.hideform").click(function(){$("table.reqattraddform").addClass("hidden"),$("form.reqattraddform").addClass("hidden"),$("button.showform").removeClass("hidden"),$("button.hideform").addClass("hidden")}),$("#sortable").sortable(),$("div.nsortable").sortable(),$("#sortable").disableSelection()});var ww=document.body.clientWidth;$(document).ready(function(){$(".nav li a").each(function(){0<$(this).next().length&&$(this).addClass("parent")}),$(".toggleMenu").click(function(e){e.preventDefault(),$(this).toggleClass("active"),$(".nav").toggle()})}),$(document).on("click","a.refreshurl",function(e){e.preventDefault();var t=$(this).attr("data-jagger-getmoreajaxonclick"),a=$(this).attr("data-jagger-response-msg"),i=$(this);if(null==a)return console.log('attribute data-jagger-response-msg not found in element with data-jagger-getmoreajax="'+t+'" - exiting'),!1;console.log('attribute data-jagger-response-msg="'+a+'" in element data-jagger-getmoreajax="'+t+'"');var n=$("div#"+a);if(null==n||0===$(n).length)return console.log('div with id="'+a+'" not found'),!1;console.log('div with id="'+a+'" found'),$.ajax({dataType:"json",type:"GET",url:t,cache:!0,success:function(e){if(!e)return console.log("no json got from "+t),!1;if(e.length<1)return!1;var a=$("<div/>");$.each(e,function(e,t){a.append("<div>"+t.msg+"</div>")}),n.empty().append(i).append(a).show()}})}),$(window).bind("resize orientationchange",function(){ww=document.body.clientWidth,adjustMenu()});var checkRegpol,adjustMenu=function(){ww<768?($(".toggleMenu").css("display","inline-block"),$(".toggleMenu").hasClass("active")?$(".nav").show():$(".nav").hide(),$(".nav li").unbind("mouseenter mouseleave"),$(".nav li a.parent").unbind("click").bind("click",function(e){e.preventDefault(),$(this).parent("li").toggleClass("hover")})):768<=ww&&($(".toggleMenu").css("display","none"),$(".nav").show(),$(".nav li").removeClass("hover"),$(".nav li a").unbind("click"),$(".nav li").unbind("mouseenter mouseleave").bind("mouseenter mouseleave",function(){$(this).toggleClass("hover")}))};if($(function(){$("#details").tablesorter({sortList:[[0,0]],widgets:["zebra"]}),$(".userlist#details").tablesorter({sortList:[[4,1],[0,0]],widgets:["zebra"]}),$("#options").tablesorter({sortList:[[0,0]],headers:{3:{sorter:!1},4:{sorter:!1}}}),$("#logotabs").tabs({load:function(e,t){$("#availablelogos").unbind(),$("#assignedlogos").unbind(),$("#uploadlogo").unbind(),$("table#details").unbind(),GINIT.initialize()}})}),$("#usepredefined").attr("checked")&&$("fieldset#stadefext").hide(),$("#usepredefined").click(function(){$(this).is(":checked")?($("#usepredefined").not(this).removeAttr("checked"),$("fieldset#stadefext").hide()):($("fieldset#stadefext").show(),$("#usepredefined").not(this).addAttr("checked"))}),$("#nattrreqbtn").click(function(e){var t=genRandomStr(5),a=$('select[name="nattrreq"]'),i=a.find(":selected").text(),n='<fieldset class="fieldset"><legend>'+i+'</legend><div class="small-12 columns"><div class="medium-3 columns medium-text-right"><select name="f[reqattr]['+t+'][status]"><option value="required">required</option><option value="desired">desired</option></select><input type="hidden" name="f[reqattr]['+t+'][attrname]" value="'+i+'"><input type="hidden" name="f[reqattr]['+t+'][attrid]" value="'+a.find(":selected").val()+'"></div><div class="medium-6 columns"><textarea name="f[reqattr]['+t+'][reason]"></textarea></div><div class="medium-3 column end"><button class="btn reqattrrm inline left button alert" type="button" name="f[reqattr]['+t+']">Remove</button></div></div></fieldset>';return $(this).parent().parent().before(n),!1}),$(".pCookieAccept").on("click",function(){var e=$(this).attr("value");return $.ajax({url:e,timeout:2500}),$("#cookiesinfo").hide(),!1}),$("[id='f[entityid]']").change(function(){if($(this).hasClass("alertonchange")){var e=$("#entitychangealert").text();window.alert(e)}}),$(document).ready(function(){var n=$("[name='baseurl']").val();function d(e,i){var n=$("#sconfirm");n.find(".message").html(e+"&nbsp;"),n.on("open.zf.reveal",function(e){var t=n.find(".yes").first(),a=n.find(".no").first();t.off().on("click",function(){i.apply(),n.foundation("close")}),a.off().on("click",function(){n.foundation("close")})}),n.foundation("open")}void 0===n&&(n=""),$("#eds2").is("*")&&$("#idpSelect").modal({Height:"500px",minHeight:"500px"}),$("#vormversion").click(function(){return $.ajax({cache:!1,type:"GET",url:n+"smanage/reports/vormversion",success:function(e){spinImage.hide(),$("#rvormversion").show(),$("tr#rvormversion td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error occurred")}}),!1}),$("#vschema").click(function(){return $.ajax({cache:!1,type:"GET",url:n+"smanage/reports/vschema",success:function(e){spinImage.hide(),$("#rvschema").show(),$("tr#rvschema td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error ocured")}}),!1}),$("#vschemadb").click(function(){return $.ajax({cache:!1,type:"GET",url:n+"smanage/reports/vschemadb",success:function(e){spinImage.hide(),$("#rvschemadb").show(),$("tr#rvschemadb td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error ocured")}}),!1}),$("#vmigrate").click(function(){return $.ajax({cache:!1,type:"GET",url:n+"smanage/reports/vmigrate",success:function(e){spinImage.hide(),$("#rvmigrate").show(),$("tr#rvmigrate td:first-child").html(e)},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error ocured")}}),!1}),$("#vcerts").click(function(){var e,t=$(this).closest("div").find("select").first();t&&(e=t.find("option:selected").val());var a=e.split("|"),i="";return void 0!==a[0]&&void 0!==a[1]&&0<=["localidp","extidp","localsp","extsp"].indexOf(a[0])&&["expired","missingencryption","missingsigning"].indexOf(0<=a[1])?(i="/"+a[0]+"/"+a[1],$.ajax({cache:!1,type:"GET",url:n+"smanage/reports/certificates"+i,dataType:"json",success:function(e){var t=e.data,a=e.definitions.baseurl,i=[],n=[];n.push("<table><tbody>"),$.each(t,function(e,t){t.alerts&&$.each(t.alerts,function(e,t){t.level?i.push('<div class="alert-box '+t.level+'" style="" data-alert="">'+t.msg+"</div>"):i.push("<div>"+t.msg+"</div>")}),n.push('<tr><td><a href="'+a+"providers/detail/show/"+t.id+'">'+t.entityid+"</a></td><td>"+i.join("")+"</td></tr>"),i=[]}),n.push("</tbody></table>"),spinImage.hide(),$("#rvcerts").show(),$("tr#rvcerts td:first-child").html(n.join(""))},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),window.alert("Error ocured")}})):alert("incorrect post"),!1}),$('button[name="fedstatus"]').click(function(e){var t=$(this).attr("value"),a=$(this).attr("title");void 0===a&&(a="");var i=$("[name='csrfname']").val(),n=$("[name='csrfhash']").val(),s=$("[name='baseurl']").val(),r=$("#fednameencoded").text(),o=s+"federations/fedactions/changestatus",l=[{name:"status",value:t},{name:i,value:n},{name:"fedname",value:r}];d(""+a,function(e){$.ajax({type:"POST",url:o,data:l,success:function(e){e&&("deactivated"===e?($('button[value="disablefed"]').hide(),$('button[value="enablefed"]').show(),$('button[value="delfed"]').show(),$("td.fedstatusinactive").show(),$("span.fedstatusinactive").show()):"activated"===e?($('button[value="disablefed"]').show(),$('button[value="enablefed"]').hide(),$('button[value="delfed"]').hide(),$("td.fedstatusinactive").hide(),$("span.fedstatusinactive").hide()):"todelete"===e&&($('button[value="disablefed"]').hide(),$('button[value="enablefed"]').hide(),$('button[value="delfed"]').hide()))},error:function(e){window.alert("Error  ocurred")}})})}),$("#rmstatdef").on("click","button",function(e){var t=$("form#rmstatdef").attr("action"),a=$("#rmstatdef").serialize();d("",function(e){$.ajax({type:"POST",url:t,data:a,success:function(e){revealAlert($("#resultdialog .message").html(),"ok")},error:function(e){window.alert("Error")}})}),e.preventDefault()}),$("#rmfedcategory").click(function(e){var t=$(this).closest("form");t.attr("action"),$(this).serialize();d("",function(e){$("<input>").attr({type:"hidden",id:"formsubmit",name:"formsubmit",value:"remove"}).appendTo("form"),t.submit()}),e.preventDefault()}),$("#rmfedvalidator").click(function(e){var t=$(this).closest("form");t.attr("action"),$(this).serialize();d("",function(e){$("<input>").attr({type:"hidden",id:"formsubmit",name:"formsubmit",value:"remove"}).appendTo("form"),t.submit()}),e.preventDefault()}),$(document).on("submit","#notificationaddform",function(e){e.preventDefault();var t=$(this);t.serializeArray();$.ajax({type:"POST",url:t.attr("action"),data:t.serializeArray(),success:function(e){$(".message").html(e),"OK"===e&&($("#notificationaddmodal").foundation("close"),location.reload())},error:function(e,t,a){window.alert("Error occured: "+a)}})}),$(document).on("open.zf.reveal","#notificationaddmodal",function(){$(this);$("select#sfederation").parent().hide(),$("select#sprovider").parent().hide(),$("select#type").change(function(){$("select#sfederation").parent().hide(),$("select#sprovider").parent().hide();var e=$(this).find("option:selected"),t=e.val(),a=(e.text(),$("#sfederation")),i=$("#sprovider");a.find("option").remove(),i.find("option").remove(),"joinfedreq"===t||"fedmemberschanged"===t||"fedmembersmodified"===t?$.ajax({type:"GET",url:n+"ajax/getfeds",cache:!0,success:function(e){$.each(e,function(e,t){$("<option>").val(t.id).text(t.name).appendTo(a)}),$("select#sfederation").parent().show()},error:function(e,t,a){$(".message").html(a)}}):"requeststoproviders"!==t&&"providermodified"!==t||$.ajax({type:"GET",url:n+"ajax/getproviders",cache:!1,datatype:"json",success:function(e){$.each(e,function(e,t){$("<option>").val(t.key).text(t.value).appendTo(i)}),$("select#sprovider").parent().show()},error:function(e,t,a){$(".message").html(a)}})})})}),$(".submit").click(function(){return!1}),$("#joinfed").on("change","#fedid",function(e){$("div.validaronotice").hide(),$("ul.validatorbuttons").replaceWith('<ul class="button-group validatorbuttons"></ul>');var t=$("[name='csrfname']").val(),a=$("[name='csrfhash']").val();void 0===t&&(t=""),void 0===a&&(a="");var i=$(this).find("option:selected").val(),n=($(this).find("option:selected").text(),$("#retrfvalidatorjson").text()),s={};s[t]=a,0!==(s.fedid=i)&&$.ajax({type:"POST",url:n,timeout:2500,cache:!0,data:s,dataType:"json",success:function(e){if(spinImage.hide(),e){var a=$("ul.validatorbuttons");$.each(e,function(e,t){a.append('<li><button  value="'+n+"/"+t.fedid+"/"+t.id+'" class="button">'+t.name+"</button></li>")}),$("div.validaronotice").show()}},beforeSend:function(){spinImage.show()},error:function(){spinImage.hide(),$("#fvform").hide(),$("#fvresult").hide()}}).done(function(){BINIT.initFvalidators()})}),$("#showhelps").click(function(e){e.preventDefault();var t=$(this).attr("href"),a="n";a=$("#showhelps").hasClass("helpactive")?"n":"y",$.ajax({type:"GET",url:t+"/"+a,success:function(){$("#showhelps").toggleClass("helpinactive").toggleClass("helpactive").toggleClass("active"),$(".dhelp").toggle()}})}),$("div.section").parent().addClass("section"),$("#notificationupdateform").on("submit",function(e){e.preventDefault();var t=$(this).serializeArray(),a=$(this).attr("action"),i=parseInt($("input[name=noteid]").val()),n=$('button[type="button"][value="'+i+'"]'),s=$(n).closest("tr"),r=s.find("div.subscrstatus:first");$.ajax({type:"POST",url:a,data:t,dataType:"json",success:function(e){if(e){var a=!1;$.each(e,function(e,t){!1===a&&parseInt(t.id)===i&&(a=!0,r.text(t.langstatus)),!1===a&&s.hide()})}$("#notificationupdatemodal").foundation("close"),location.reload()},error:function(e,t,a){window.alert("Error occured: "+a)}})}),$(document).on("submit","#loginform form",function(e){e.preventDefault();var t=$("#loginform"),a=$(t).find(":submit").first(),i=$(t).find("div.secondfactorrow").first(),n=$("div#loginform form").attr("action"),s=$(this).serializeArray(),r=-(new Date).getTimezoneOffset();s.push({name:"browsertimeoffset",value:""+r});var o=$("[name='baseurl']").val();return $.ajax({type:"POST",cache:!1,timeout:3500,url:n,data:s,beforeSend:function(){$("#loginresponse").html("").hide()},success:function(e){e?!0===e.success&&"OK"===e.result?(t.foundation("close"),spinImage.show(),setTimeout(function(){window.location.href=o},1e3)):"secondfactor"===e.result&&($("#password").val(""),i.empty(),i.append(e.html).show(),a.prop("disabled",!0)):$("#loginresponse").html(e).show()},error:function(e,t,a){$("#loginresponse").html(e.responseText).show()}}),!1}),$("button.advancedmode").click(function(){var e=$("span.modalnotice").text();$("textarea#metadatabody").val().trim().length<20&&window.alert(e);var t=$(this).val();$("[name='csrfname']").val(),$("[name='csrfhash']").val();$(this).closest("form").attr("action",t)}),$("#providerslistresultv2").length){var jnl=$("#providerslistresultv2").first(),url=jnl.attr("data-jagger-src");$.ajax({type:"GET",url:url,cache:!0,dataType:"json",success:function(n){spinImage.hide();var e=n.definitions.lang,t=$("<table/>"),a=$("<thead/>"),i=$("<tfoot/>");t.append(a),t.append(i);var s=$("<tr/>"),r=$("<tr/>");a.append(s),i.append(r);var o=[],l=n.columns;s.append('<th class="header">s</th>'),r.append('<th class="header">s</th>'),$.each(l,function(e,t){if(t.status){var a=[];$.each(t.cols,function(e,t){a.push(t)}),o.push(a),s.append('<th class="header">'+t.colname+"</th>"),r.append('<th class="header">'+t.colname+"</th>"),1}});var d,c=n.data,u=[];$.each(c,function(e,i){(d=[]).push(i.plocal),$.each(o,function(e,t){var a="";$.each(t,function(e,t){null!==i[t]&&("pname"===t?a=a+'<a href="'+n.baseurl+"providers/detail/show/"+i.pid+'">'+i[t]+"</a><br />":"phelpurl"===t?a=a+'<a href="'+i.phelpurl+'">'+i.phelpurl+"</a>":"plocked"===t||"pactive"===t||"plocal"===t||"pstatic"===t||"pvisible"===t||"pavailable"===t?void 0!==n.statedefs[t][i[t]]&&(a=a+' <span class="lbl lbl-'+t+"-"+i[t]+'">'+n.statedefs[t][i[t]]+"</span>"):"contacts"===t?$.each(i.contacts,function(e,t){a=a+'<span class="label">'+t.type.charAt(0).toUpperCase()+"</span> "+t.mail+"<br />"}):a=a+"  "+i[t])}),d.push(a.trim())}),u.push(d)}),jnl.append(t);var p=t.DataTable({dom:'<"text-right"lB><"text-left"i>frtip',buttons:[{text:e.btnexternal,className:"tiny"},{text:e.btnlocal,className:"tiny"},{className:"tiny",extend:"colvis",postfixButtons:["colvisRestore"],columns:":gt(1)"}],columnDefs:[{targets:[0],visible:!1,searchable:!0},{targets:[4],visible:!1}],order:[[1,"asc"]],paging:!0,stateSave:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],data:u,language:{lengthMenu:"Display _MENU_ records per page",zeroRecords:"Nothing found - sorry",infoEmpty:"No records available",infoFiltered:"(filtered from _MAX_ total records)",paginate:{next:e.next,previous:e.previous}},defereRender:!0});p.button(0).action(function(e,t,a,i){a.hasClass("active")?(this.active(!1),$("#entityc").val("").trigger("change")):(this.active(!0),p.button(1).active(!1),$("#entityc").val("external").trigger("change"))}),p.button(1).action(function(e,t,a,i){a.hasClass("active")?(this.active(!1),$("#entityc").val("").trigger("change")):(this.active(!0),p.button(0).active(!1),$("#entityc").val("local").trigger("change"))}),$("#entityc").on("change",function(){console.log("chanmge triggered"),p.draw()})},beforeSend:function(){spinImage.show()},error:function(e,t,a){spinImage.hide(),console.log(e),console.log(t),console.log(a),window.alert(a)}})}function genAttrUsage(e,t){var a=Jagger.base_url+"providers/detail/show/",i=[],n=[],s=[];return $.each(e.requested_by,function(e,t){"provider"===t.type?s.push('<div><a href="'+a+t.id+'">'+t.entityid+"</a></div>"):"federation"===t.type&&n.push("<div>Federation: "+t.name+"</div>")}),i.push('<div class="small-12 column">'),i.push("Name: "+e.name),i.push("</div>"),i.push('<div class="small-12 column">'),i.push('<ul class="accordion" data-accordion data-allow-all-closed="true" data-multi-expand="true">'),i.push('<li class="accordion-item" data-accordion-item><a href="#" class="accordion-title">supported by '+e.supported_by.length+' Identity Providers</a><div class="accordion-content" data-tab-content>'),$.each(e.supported_by,function(e,t){i.push('<div><a href="'+a+t.id+'">'+t.entityid+"</a></div>")}),i.push("</div></li>"),i.push('<li class="accordion-item" data-accordion-item><a href="#" class="accordion-title">requested by '+s.length+" Service Providers"),0<n.length&&i.push(" and "+n.length+" Federations"),i.push("</a>"),i.push('<div class="accordion-content" data-tab-content>'),i.push(n.join("")),i.push(s.join("")),i.push("</div></li>"),i.push("</ul>"),i.push("</div>"),i.join("")}$(".afilter").click(function(){var m,e=$(this).attr("href");return m=$(this).hasClass("filterext")?1:$(this).hasClass("filterlocal")?2:0,$("a.initiated").removeClass("initiatied"),$.ajax({type:"GET",url:e,timeout:9500,cache:!0,dataType:"json",success:function(n){if(spinImage.hide(),1===m?$("dd.filterext").addClass("active"):2===m?$("dd.filterlocal").addClass("active"):$("dd.filterall").addClass("active"),n){var e=$("<table/>");e.attr("id","details"),e.addClass("filterlist");var t=$("<thead/>");e.append(t);var i=$("<tr/>");t.append(i);var s=[],a=n.columns,r=0;$.each(a,function(e,t){if(t.status){var a=[];$.each(t.cols,function(e,t){a.push(t)}),s.push(a),i.append("<th>"+t.colname+"</th>")}});var o=$("<tbody/>");e.append(o);var l=n.data,d=new Date,c=[],u=0;$.each(l,function(e,i){(1===i.plocal&&(2===m||0===m)||0===i.plocal&&m<2)&&(c[u++]="<tr>",$.each(s,function(e,t){var a="";$.each(t,function(e,t){null!==i[t]&&("pname"===t?a=a+'<a href="'+n.baseurl+"providers/detail/show/"+i.pid+'">'+i[t]+"</a><br />":"phelpurl"===t?a=a+'<a href="'+i.phelpurl+'">'+i.phelpurl+"</a>":"plocked"===t||"pactive"===t||"plocal"===t||"pstatic"===t||"pvisible"===t||"pavailable"===t?void 0!==n.statedefs[t][i[t]]&&(a=a+' <span class="lbl lbl-'+t+"-"+i[t]+'">'+n.statedefs[t][i[t]]+"</span>"):a=a+"  "+i[t])}),c[u++]="<td>"+a+"</td>"}),r++,c[u++]="</tr>")}),o.append(c.join(""));var p=new Date-d;console.log("Providerlist table gen time: "+p);var f=$("div.subtitleprefix").text();$("div.subtitle").empty().append(f+": "+r),$("div#providerslistresult").append(e),1<r&&(e.tablesorter({sortList:[[0,0]]}),$("#filter").keyup(function(){$.uiTableFilter(e,this.value)}),$("#filter-form").submit(function(){return e.find("tbody > tr:visible > td:eq(1)").mousedown(),!1}).focus())}},beforeSend:function(){$("dd.afilter").removeClass("active"),$("div#providerslistresult").empty(),$("div.alert-box").empty().hide(),spinImage.show()},error:function(e,t,a){spinImage.hide(),$("div.subtitle").empty(),$("div.alert-box").append(a).show()}}),!1}),$("a.initiated").trigger("click"),$('button[name="mrolebtn"]').click(function(e){var t=$(this).attr("value");$.ajax({type:"GET",url:t,timeout:2500,cache:!1,dataType:"json",success:function(e){var a=[];$.each(e,function(e,t){a.push(t)}),$("input[name='checkrole[]']").each(function(){var e=$(this).attr("value");$(this).attr("checked");-1===$.inArray(e,a)?$(this).prop("checked",!1):$(this).prop("checked",!0)})}})}),$('button[name="update2f"]').click(function(e){e.preventDefault();var t=$(this).parents("form:first"),i=t.find("div.alert-box"),a=t.attr("action");$.ajax({type:"POST",url:a,cache:!1,data:t.serializeArray(),dataType:"json",success:function(e){if(i.hide(),e){var a="";$.each(e,function(e,t){a=a+t+","}),$("span#val2f").empty().append(a.substring(0,a.length-1))}$("#m2f").foundation("close")},error:function(e,t,a){i.html(a).show()}})}),$('input[type="radio"].withuncheck').on("hover",function(){checkRegpol=$(this).is(":checked")}).on("click",function(){checkRegpol=!checkRegpol,$(this).attr("checked",checkRegpol)}),$(document).on("click","#resetloginform",function(e){e.preventDefault();var t=$("[name='baseurl']").val();$.ajax({type:"GET",url:t+"authenticate/resetloginform",cache:!1,success:function(e){return $(".secondfactorrow").empty(),$("#loginform").foundation("close"),!1}})}),$(document).on("click","#duo_form",function(e){var t=$(this).attr("action"),a=$(".secondfactorrow");return $.ajax({type:"POST",url:t,cache:!1,data:$(this).serializeArray(),beforeSend:function(){$("#loginresponse").html("").hide()},success:function(e){e?!0===e.success&&"OK"===e.result?($("#loginform").foundation("close"),setTimeout(function(){go_to_private_page()},1e3)):"secondfactor"===e.result&&a.append(e.html).show():$("#loginresponse").html(e).show()},error:function(e,t,a){$("#loginresponse").html(e.responseText).show()}}),!1}),$(document).ready(function(){var e=$("a.autoclick");void 0!==e&&e.click()}),$(".oidclink").on("click",function(e){e.preventDefault();var t=$(this).attr("href"),a=[{name:$("[name='csrfname']").val(),value:$("[name='csrfhash']").val()},{name:"op",value:$(this).attr("data-jagger-oidc")}];$.ajax({type:"POST",url:t,data:a,cache:!1,dataType:"json",success:function(e){window.location.href=e.redirect}})}),$("#updateprefsmodal").on("submit",function(e){e.preventDefault();var i=$(this),t=i.attr("data-jagger-link"),n=i.find("div.alert").first(),a=i.find("form").first();$.ajax({url:t,type:"POST",cache:!1,data:a.serializeArray(),success:function(e){if(e)if("OK"===e.result){var t=$(document).find('[data-jagger-record="'+e.confname+'"]').first().closest("tr");"text"===e.type&&t.find('span[data-jagger-name="vtext"]').first().html(nl2br(e.vtext,!1));var a=t.find('span[data-jagger-name="status"]').first();e.status?a.removeClass("alert").html(e.statusstring):a.addClass("alert").html(e.statusstring),i.foundation("close")}else e.error&&n.html(e.error).show();else n.html("No data").show()},error:function(e,t,a){n.html(a).show()}})}),$(document).on("click","a.updateprefs",function(e){e.preventDefault();var t=$("#updateprefsmodal"),a=$(this).attr("href");if(void 0===t||void 0===a)return!1;var i=t.find('span[data-jagger-name="displayname"]').first(),n=t.find('input[name="confname"]').first(),s=t.find('div[data-jagger-name="desc"]').first(),r=t.find('input[name="status"]').first(),o=t.find('textarea[data-jagger-name="vtext"]').first();return t.find("div.alert").first().html("").hide(),null===o&&window.alert("d"),$.ajax({url:a,type:"GET",cache:!1,success:function(e){e&&(i.html('"'+e.displayname+'"'),n.val(e.confname),s.html("<b>"+e.displayname+":</b> "+e.desc),"text"===e.type?(o.val(e.vtext),o.closest("div.row").show()):o.closest("div.row").hide(),!0===e.status?r.prop("checked",!0):r.prop("checked",!1))}}),t.foundation("open"),!1}),$("#updatemembership").on("click",".yes",function(e){var t=$("#updatemembership").find("form"),a=t.attr("action"),i=t.serializeArray();return $.ajax({url:a,type:"post",data:i,dataType:"json",success:function(e){e.message&&revealAlert(e.message,"OK")},error:function(e,t,a){revealAlert('<div class="alert-box alert ">'+e.responseText+"</div>","OK")}}),!1}),$("button.revealc").on("click",function(){var e=$(this).val(),t=$(this).attr("data-jagger-desc"),a=$("#updatemembership"),i=a.find("div.message").first();i&&i.html(t),a.find('input[name="updatedata"]').val(e),a.foundation("open")}),$(".select2").select2(),$("#itestcombo").select2();var genModalForm=function(e,t){var a="POST",i="submit",n="cancel";e.method&&(a=e.method),e.submittext&&(i=e.submittext),e.canceltext&&(n=e.canceltext);var s=[];if(s.push('<div class="reveal '+t+'" data-reveal>'),s.push('<div class="small-12 column response alert-box alert hidden" alert-data></div>'),s.push('<form method="'+a+'" action="'+Jagger.base_url+e.actionuri+'" class="'+e.formclass+'">'),s.push('<input type="hidden" name="'+Jagger.csrfname+'" value="'+Jagger.csrfhash+'">'),e.confirmationtext&&s.push('<div class="small-12 column"><h5>'+e.confirmationtext+"</h5></div>"),e.forminputs)for(var r,o=e.forminputs.length,l=0;l<o;l++)r=e.forminputs[l],console.log(r),"input"===r.element&&"hidden"===r.type&&s.push('<input type="hidden" name="'+r.name+'" value="'+r.value+'">');return s.push('<div class="small-12 column text-right"><div class="button-group"><a data-close class="button alert cancel">'+Jagger.getLangLine(n)+'</a><button type="submit" class="button submit">'+Jagger.getLangLine(i)+"</button></div></div>"),s.push("</form>"),s.push("</div>"),$(""+s.join("")).foundation()};$(document).on("submit",".delattrform",function(){var e=$(this),t=e.closest("form"),a=t.find("[name='attrid']").val(),i=e.closest("div.reveal"),n=i.find(".response").first();return $.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serialize(),fataType:"json",beforeSend:function(){n.empty().hide()},success:function(e){var t=$("[data-jagger-attrid='"+a+"']");"undefined"!==t&&t.closest("tr").remove(),i.foundation("close")},error:function(e,t,a){console.log(e),n.html(e.responseText).show()}}),!1}),$(".delattribute").click(function(e){var t=$(this),a=t.attr("data-jagger-attrid"),i=t.attr("data-jagger-attrname"),n={method:"POST",formclass:"delattrform",actionuri:"attributes/attributes/remove",confirmationtext:"Are you sure you want to remove attribute:  "+i+"?",submittext:"remove",canceltext:"cancel",forminputs:[{name:"attrid",value:a,element:"input",type:"hidden"},{name:"attrname",value:i,element:"input",type:"hidden"}]};Jagger.confirmFormModal(genModalForm(n,"tiny"))}),$("#inviteuserform").on("submit",function(e){e.preventDefault();var t=$(this).closest("form"),i=$("#invusrresp");$.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serialize(),beforeSend:function(){i.empty().hide()},success:function(e){i.removeClass("alert").addClass("success").html("Success").show()},error:function(e,t,a){i.removeClass("success").addClass("alert").html(e.responseText).show()}})}),$("#invverify").on("submit",function(e){e.preventDefault();var t=$(this).closest("form"),i=$("#invverifyerror");$.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serialize(),beforeSend:function(){i.hide().empty()},success:function(e){i.hide(),e?alert(e):alert("success")},error:function(e,t,a){i.html(e.responseText).show()}})}),$("#massmailform").on("submit",function(e){e.preventDefault();var t=$(this).closest("form"),i=$("#massmailerror");i.hide().empty(),console.log(i),$.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serialize(),beforeSend:function(){i.hide().empty()},success:function(e){i.hide(),t.trigger("reset"),e?alert(e):alert("mail sent")},error:function(e,t,a){i.html(e.responseText).show()}})}),$(".attrinfo").click(function(e){var t=$(this),a=t.find("i").first(),i=t.attr("data-jagger-attrid"),n=t.closest("tr"),s=n.next();if(s.hasClass("attrexpanded"))return s.remove(),a.toggleClass("fa-compress",!1).toggleClass("fa-expand",!0),!1;var r=n.find("td").length,o=$('<tr class="attrexpanded"><td colspan="'+r+'"></td></tr>'),l=[];a.toggleClass("fa-compress",!0).toggleClass("fa-expand",!1),(isNaN(i)?(l.push("<div> alert </div>"),$.ajax()):$.ajax({type:"GET",url:Jagger.base_url+"attributes/attributes/byid/"+i,dataType:"json",cache:!0,success:function(e){var t=genAttrUsage(e,"html");l.push(t)}})).done(function(){var e=l.join("");o.find("td").append(e),n.after(o),o.foundation()})});