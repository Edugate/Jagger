(function(){var a;a=this.jQuery;a.fn.extend({confirmWithReveal:function(b){var f,e,d,c;if(b===null){b={}}f={modal_class:"small",title:"Are you sure?",title_class:"",body:"This action cannot be undone.",body_class:"",password:false,prompt:"Type <strong>%s</strong> to continue:",footer_class:"",ok:"Confirm",ok_class:"button small",cancel:"Cancel",cancel_class:"button small alert"};c=a.extend({},f,b);e=function(o){var g,k,i,h,m,l,n,j;h=o.data("confirm");if(o.attr("data-confirm")===null){return true}if((typeof h==="string")&&(h.length>0)){return(((j=a.rails)!==null?j.confirm:void 0)||window.confirm).call(window,h)}l=function(p){return h[p]||c[p]};m=a("<div data-reveal class='reveal-modal "+(l("modal_class"))+"'>\n  <h2 data-confirm-title class='"+(l("title_class"))+"'></h2>\n  <p data-confirm-body class='"+(l("body_class"))+"'></p>\n  <div data-confirm-footer class='"+(l("footer_class"))+"'>\n    <a data-confirm-cancel class='"+(l("cancel_class"))+"'></a>\n  </div>\n</div>");g=o.is("a")?o.clone():a("<a/>");g.removeAttr("data-confirm").attr("class",l("ok_class")).html(l("ok")).on("click",function(p){if(a(this).prop("disabled")){return false}o.trigger("confirm.reveal",p);if(o.is("form, :input")){return o.closest("form").removeAttr("data-confirm").submit()}});m.find("[data-confirm-title]").html(l("title"));m.find("[data-confirm-body]").html(l("body"));m.find("[data-confirm-cancel]").html(l("cancel")).on("click",function(p){m.foundation("reveal","close");return o.trigger("cancel.reveal",p)});m.find("[data-confirm-footer]").append(g);if((n=l("password"))){i=(l("prompt")).replace("%s",n);k="<label>\n  "+i+"\n  <input data-confirm-password type='text'/>\n</label>";m.find("[data-confirm-body]").after(a(k));m.find("[data-confirm-password]").on("keyup",function(q){var p;p=a(this).val()!==n;return g.toggleClass("disabled",p).prop("disabled",p)}).trigger("keyup")}m.appendTo(a("body")).foundation().foundation("reveal","open").on("closed.fndtn.reveal",function(p){return m.remove()});return false};if(a.rails){a.rails.allowAction=function(g){return e(a(g))};return a(this)}else{d=function(g){if(!(e(a(this)))){g.preventDefault();return g.stopImmediatePropagation()}};return this.each(function(){var g;g=a(this);g.on("click","a[data-confirm], :input[data-confirm]",d);g.on("submit","form[data-confirm]",d);return g})}}})}).call(this);function nl2br(c,b){var a=(b||typeof b==="undefined")?"<br />":"<br>";return(c+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+a+"$2")}function revealAlert(d,b){var a='<div class="row text-right"><button class="small modal-close">'+b+"</button></div>";var c=$("#malert");c.empty().append('<div class="row text-center"><p><h4>'+d+"</h4></p></div>").append(a).foundation("reveal","open")}jQuery.uiTableFilter=function(c,d,e,b){var h=false;if(this.last_phrase===d){return false}var l=d.length;var i=d.toLowerCase().split(" ");var f=function(m){m.show()};var j=function(m){m.hide();h=true};var k=function(m){return m.text()};if(e){var g=null;c.find("thead > tr:last > th").each(function(m){if($(this).text()===e){g=m;return false}});if(g===null){throw ("given column: "+e+" not found")}k=function(m){return jQuery(m.find(("td:eq("+g+")"))).text()}}if((i.size>1)&&(d.substr(0,l-1)===this.last_phrase)){if(d[-1]===" "){this.last_phrase=d;return false}i=i[-1];f=function(m){};var a=c.find("tbody > tr:visible")}else{h=true;var a=c.find("tbody > tr")}a.each(function(){var m=jQuery(this);jQuery.uiTableFilter.has_words(k(m),i,false)?f(m):j(m)});last_phrase=d;if(b&&h){b()}return c};jQuery.uiTableFilter.last_phrase="";jQuery.uiTableFilter.has_words=function(e,d,a){var c=a?e:e.toLowerCase();for(var b=0;b<d.length;b++){if(c.indexOf(d[b])===-1){return false}}return true};var map;var mapSearchInput;function mapInitialize(){window.console.log("map init");var b=[];var a={zoom:4,center:new google.maps.LatLng(50.019036,13.007813),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DEFAULT}};map=new google.maps.Map(document.getElementById("map-canvas"),a);google.maps.event.addListener(map,"click",function(d){$("#latlng").val(d.latLng.lat().toFixed(6)+","+d.latLng.lng().toFixed(6))});mapSearchInput=(document.getElementById("map-search"));map.controls[google.maps.ControlPosition.TOP_LEFT].push(mapSearchInput);var c=new google.maps.places.SearchBox((mapSearchInput));google.maps.event.addListener(c,"places_changed",function(){var f=c.getPlaces();if(f.length===0){return}for(var g=0,e;e=b[g];g++){e.setMap(null)}b=[];var h=new google.maps.LatLngBounds();for(var g=0,d;d=f[g];g++){var k={url:d.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};var e=new google.maps.Marker({map:map,icon:k,title:d.name,position:d.geometry.location});b.push(e);h.extend(d.geometry.location)}map.fitBounds(h);var j=google.maps.event.addListener(map,"idle",function(){if(map.getZoom()>16){map.setZoom(16)}google.maps.event.removeListener(j)})});google.maps.event.addListener(map,"bounds_changed",function(){var d=map.getBounds();c.setBounds(d)})}jQuery.fn.toggleOption=function(a){jQuery(this).toggle(a);if(a){while(jQuery(this).parent("span.toggleOption").length){jQuery(this).unwrap()}}else{jQuery(this).wrap('<span class="toggleOption" style="display: none;" />')}};var createRowWithLangRm=function(d,c,a,b){console.log("createRowWithLangRm fired");return $('<div class="large-12 small-12 columns"><div class="small-3 columns"><label for="'+a+'" class="right inline">'+c+'</label></div><div class="small-6 large-7 columns"><input id="'+a+'" name="'+a+'" type="text" class="validurl"/></div><div class="small-3 large-2 columns"> <button type="button" class="btn langinputrm button inline tiny left alert" name="langrm" value="'+d+'">'+b+"</button></div></div>")};var createRowTaskParams=function(e,d){var c="z";var a="0123456789";for(var b=0;b<5;b++){c+=a.charAt(Math.floor(Math.random()*a.length))}return $('<div class="row"><div class="small-6 column"><label>'+e+'<input name="params['+c+'][name]" type="text" value=""/></label></div><div class="small-6 column"><label>'+d+'<input name="params['+c+'][value]" type="text"  value=""/></label></div></div>')};var BINIT={initFvalidators:function(){console.log("BININT");$("ul.validatorbuttons button").on("click",function(b){var a=$(this).attr("value");var d=$("#fvform");var c=$("#spinner");$.ajax({type:"GET",url:a,timeout:2500,cache:true,success:function(g){c.hide();var h=$.parseJSON(g);if(h){var e=h.fedid;var j=h.id;var f=h.name;var i=h.desc;d.find('input[name="fedid"]').first().val(e);d.find('input[name="fvid"]').first().val(j);$("#fvalidesc").replaceWith('<div id="fvalidesc"><b>'+f+"</b><p>"+i+"</p></div>");d.show()}},beforeSend:function(){$("#fvresult").hide();c.show()},error:function(){c.hide();d.hide();$("#fvresult").hide()}})})}};var GINIT={initialize:function(){var b=$(".pjagger");if(b.length>0){var g;var d;b.each(function(){g=$(this);if(g.hasClass("piegraph")&&g.hasClass("fedgraph")){d=g.attr("data-jagger-link");var l=["idp","sp","both"];var j;var k=[];k.idp=0;k.sp=0;k.both=0;$.ajax({url:d,type:"GET",cache:true,dataType:"json",success:function(o){if(o){var q=[{value:o.idp,color:"#F7464A",highlight:"#FF5A5E",label:o.definitions.idp},{value:o.sp,color:"#46BFBD",highlight:"#5AD3D1",label:o.definitions.sp},{value:o.both,color:"#FDB45C",highlight:"#FFC870",label:o.definitions.both}];var m=g.find("canvas").get(0).getContext("2d");if(m){var p=new Chart(m).Pie(q,{responsive:true,legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><div><span style="background-color:<%=segments[i].fillColor%>">&nbsp;&nbsp;&nbsp;</span> <%if(segments[i].label){%><%=segments[i].label%><%}%></div><%}%></div>'});var n=p.generateLegend();g.find("div.plegend").first().html(n)}}}})}})}var h=$("#membership2").first();if(h!==undefined&&h.length>0){var e=$(h).attr("data-jagger-link");var a=["idp","sp","both"];var i;var f=[];f.idp=0;f.sp=0;f.both=0;$.ajax({url:e,type:"GET",cache:true,dataType:"json",success:function(p){if(p){var k=p.definitions.preurl;var n=[],l=-1;var t,r;n[++l]="<table><tbody>";for(var q=0,s=a.length;q<s;q++){i=a[q];if(p[i]){n[++l]='<tr><td colspan="2" class="highlight">'+p.definitions[i]+"</td></tr>";n[++l]='<tr><td colspan="2"><div class="zebramembers">';t=0;f[i]=p[i].length;$.each(p[i],function(w,o){++t;if(t%2){n[++l]='<div class="small-12 column odd">'}else{n[++l]='<div class="small-12 column even">'}n[++l]='<div class="large-5 column">'+t+'. <a href="'+k+o.pid+'">'+o.pname+"</a></div>";n[++l]='<div class="large-5 column">'+o.entityid+"</div>";n[++l]='<div class="large-2 column"></div>';n[++l]="</div>"});n[++l]="</div></td></tr>"}}n[++l]="</tbody></table>";if(!h.hasClass("fake")){$(h).html(n.join(""))}var m=[{value:f.idp,color:"#F7464A",highlight:"#FF5A5E",label:p.definitions.idp},{value:f.sp,color:"#46BFBD",highlight:"#5AD3D1",label:p.definitions.sp},{value:f.both,color:"#FDB45C",highlight:"#FFC870",label:p.definitions.both}];var v=document.getElementById("fedpiechart").getContext("2d");if(v&&(f.idp>0||f.sp>0||f.both>0)){var j=new Chart(v).Pie(m,{responsive:true,legendTemplate:'<div class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><div><span style="background-color:<%=segments[i].fillColor%>">&nbsp;<%=segments[i].value %>&nbsp;</span> <%if(segments[i].label){%><%=segments[i].label%><%}%></div><%}%></div>'});var u=j.generateLegend();$("#fedpiechartlegend").html(u)}}}})}$("div[data-jagger-getmoreajax]").each(function(o){var k=$(this).attr("data-jagger-getmoreajax");var n=$(this).attr("data-jagger-response-msg");var l=$(this).attr("data-jagger-refreshurl");var m="";if(n===undefined||n===null){console.log('attribute data-jagger-response-msg not found in element with data-jagger-getmoreajax="'+k+'" - exiting');return false}else{console.log('attribute data-jagger-response-msg="'+n+'" in element data-jagger-getmoreajax="'+k+'"')}var j=$("div#"+n);if(j===undefined||j===null||$(j).length===0){console.log('div with id="'+n+'" not found');return false}else{console.log('div with id="'+n+'" found')}$.ajax({dataType:"json",type:"GET",url:k,cache:true,success:function(s){if(!s){console.log("no json got from "+k);return false}var q=s.length;if(q<1){return false}var p=$("<div/>");var r;$.each(s,function(u,t){r="<div>"+t.msg+"</div>";p.append(r)});if(l!==null){m='<a class="refreshurl right" href="#"  data-jagger-getmoreajaxonclick= "'+l+'" data-jagger-response-msg="prdetails"><i class="fi-refresh" ></i></a>'}j.empty().append(m).append(p).show()}})});$("#taskformaddparam").on("click",function(k){var j=$(this).closest("div.row");var l=createRowTaskParams("","");l.insertBefore(j);return false});$("#password").on("keypress",function(l){var k=l.keyCode?l.keyCode:l.which;var j=l.shiftKey?l.shiftKey:(k===16);if(((k>=65&&k<=90)&&!j)||((k>=97&&k<=122)&&j)){$("#capswarn").show()}else{$("#capswarn").hide()}});$("table.sortable").tablesorter();var c=$("[name='baseurl']").val();if(c===undefined){c=""}$("#loginbtn").on("click",function(p){p.preventDefault();var m=$(this).attr("href");var l=$("#loginform");var o=$(l).find(":submit").first();var k=$(l).find("div.usernamerow").first();var n=$(l).find("div.passwordrow").first();var q=$(l).find("div.secondfactorrow").first();var j=$("#loginresponse");$.ajax({type:"GET",url:m,dataType:"json",cache:false,success:function(r){if(r.logged!==1){if(r.partiallogged===0){o.prop("disabled",false);k.show();n.show();j.hide();l.foundation("reveal","open");return false}if(r.twofactor===1&&r.secondfactor!==null){o.prop("disabled",true);k.show();$("#password").val(null);n.show();j.hide();if(r.html){q.html(r.html).show()}l.foundation("reveal","open");return false}}else{var s=$("[name='baseurl']").val();if(s!==undefined){window.location.href=s}}k.show();n.show();j.hide();l.foundation("reveal","open")}});return false});$(document).on("click",".modal-close",function(j){$(this).foundation("reveal","close")});$("#providerlogtab").on("toggled",function(l,j){console.log(j);var k=$(this).attr("data-reveal-ajax-tab");if(k!==undefined){$.ajax({cache:true,type:"GET",url:k,success:function(m){$("#providerlogtab").empty().append(m);$(document).foundation("accordion","reflow")}})}});$("#newusermodal").on("submit","form",function(l){l.preventDefault();var k=$(this);var j=k.attr("action");var m=k.find("div.message").first();$.ajax({url:j,type:"POST",data:k.serializeArray(),beforeSend:function(){m.hide().empty()},success:function(n){if(n&&n==="OK"){$("#newusermodal").foundation("reveal","close");m.hide().empty();location.reload()}else{m.html(n).show()}}})});$("button.cleartarget").on("click",function(l){l.preventDefault();var k=$(this).attr("data-jagger-textarea");var j=$(this).attr("data-jagger-input");if(k!==undefined){$("textarea[name='"+k+"']").val("")}if(j!==undefined){$("input[name='"+j+"']").val("")}return false});$("button.postajax").on("click",function(n){n.preventDefault();var l=$(this).closest("form");var m=$(this).attr("data-jagger-response-msg");var k=$("div#"+m);var j=l.attr("action");$.ajax({type:"POST",url:j,data:l.serializeArray(),beforeSend:function(){k.empty()},success:function(o){if(o){k.append(o)}else{k.append("no result")}},error:function(r,o,p){var q="<div>"+p+"</div>";k.append(q);return false}});return false});$(".policymembers").on("click",function(m){var l=$(this).attr("data-jagger-jsource");var k=$("#regpolmembers");var j=k.find(".datacontent").first();$.ajax({type:"GET",url:l,beforeSend:function(){j.empty()},success:function(q){if(q){var p=$("<ul/>");p.addClass("no-bullet");var n=[];var o=0;$.each(q,function(s,r){n[o++]='<li><a href="'+c+"providers/detail/show/"+r.provid+'">'+r.name+" </a><small>("+r.entityid+")</small></li>"});p.append(n.join(""));j.append(p);k.foundation("reveal","open")}}})});$(document).on("click",".ecmembers",function(m){var l=$(this).attr("data-jagger-jsource");var k=$("#ecmembers");var j=k.find(".datacontent").first();$.ajax({type:"GET",url:l,beforeSend:function(){j.empty()},success:function(q){if(q){var p=$("<ul/>");p.addClass("no-bullet");var n=[];var o=0;$.each(q,function(s,r){n[o++]='<li><a href="'+c+"providers/detail/show/"+r.provid+'">'+r.name+" </a><small>("+r.entityid+")</small></li>"});p.append(n.join(""));j.append(p);k.foundation("reveal","open")}}})});$(".rmusericon").on("click",function(o){var s=$("#removeusermodal");var p=s.find("#removeusermodalmsg").first();var m=$(this).attr("data-jagger-username");var t=$(this).attr("data-jagger-encodeduser");var n=s.find("#usernameval").first();var k=s.find("#encodedusr").first();var q=s.find("button[name='close']");var r=s.find("button[name='cancel']");var j=s.find("button[name='remove']");var l=s.find("input[name='username']");l.val("");k.val(t);n.html(m);p.html("").hide().removeClass("alert").removeClass("success");j.show();r.show();q.hide();s.foundation("reveal","open");return false});$("#removeusermodal form").on("submit",function(o){o.preventDefault();var p=$(this).find("#removeusermodalmsg").first();var n=$(this).find("#encodedusr").first();var m=$(this).attr("action");var k=$(this).find("button[name='close']");var j=$(this).find("button[name='cancel']");var l=$(this).find("button[name='remove']");$.ajax({type:"POST",url:m,data:$(this).serializeArray(),beforeSend:function(){p.html("").hide().removeClass("alert").removeClass("success");l.show();j.show();k.hide()},success:function(r){var q=$(document).find('a[data-jagger-encodeduser="'+n.val()+'"]');if(q){q.closest("tr").hide()}p.html(r).addClass("success").show();l.hide();j.hide();k.show();return false},error:function(t,q,r){var s=""+r+"";p.html(t.responseText).addClass("alert").show();return false}})});$("#confirmremover").on("click",".yes",function(n){n.preventDefault();var m=$(this).closest("form");var l=m.attr("action");var j=m.attr("data-jagger-regpolicy");var k=m.attr("data-jagger-ec");$.ajax({type:"POST",url:l,data:m.serializeArray(),success:function(o){if(j!==undefined&&j!==null){$('a[data-jagger-regpolicy="'+j+'"]').closest("tr").hide()}else{$('a[data-jagger-ec="'+k+'"]').closest("tr").hide()}$("#confirmremover").foundation("reveal","close")},error:function(r,o,p){var q=""+p+"";window.alert(q);return false}})});$("a.withconfirm").on("click",function(r){r.preventDefault();var j=$(this).attr("href");var m=$(this).attr("data-jagger-regpolicy");var n=$(this).attr("data-jagger-ec");var p=$(this).attr("data-jagger-counter");var q=$(this).attr("data-jagger-fieldname");if(j===undefined){return false}var s=$("#confirmremover");var l=s.find("span.data-fieldname").first();var o=s.find("span.data-counter").first();l.html(q);o.html(p);var k=s.find("form").first();k.attr("action",j);if(n!==undefined&&n!==null){k.attr("data-jagger-ec",n)}else{k.attr("data-jagger-regpolicy",m)}s.foundation("reveal","open")});$(".dhelp").click(function(){var j=parseInt($(this).css("font-size"));if(j<=10){$(this).css("font-size",j+5).removeClass("zoomin").addClass("zoomout")}else{$(this).css("font-size",j-5).removeClass("zoomout").addClass("zoomin")}});$("form#availablelogos input[name='filename']").click(function(){$(this).after($("form#availablelogos div.buttons").show())});$("button.reqattrrm").click(function(){var j=$(this).closest("fieldset");j.remove()});$("form#availablelogos").on("submit",function(l){l.preventDefault();var j=$("div.uploadresult");var k=$("div.assignedlogosgrid").text();$("#uploadlogo").unbind();$.ajax({type:"POST",url:$(this).attr("action"),data:$("form#availablelogos").serializeArray(),dataType:"html",cache:false,beforeSend:function(){$("form#availablelogos div.buttons").hide().appendTo("form#availablelogos")},success:function(m){$("form#availablelogos #filename").prop("checked",false);$.ajax({type:"GET",url:k,cache:false,success:function(n){$("#uploadlogo").unbind();$("div#t1").empty().append(n);$("#assignedlogos").unbind();$("#availablelogos").unbind();GINIT.initialize()}});$("#spinner").hide();revealAlert(m,"OK")},error:function(m,o,n){$("#spinner").hide();j.css("color","red");revealAlert('<div data-alert class="alert-box alert">'+m.responseText+"</div>","OK")}})});$("#uploadlogo").on("submit",(function(n){n.preventDefault();var m=new FormData(document.forms.namedItem("uploadlogo"));var j=$("div.uploadresult");var k=$("div.availablelogosgrid").text();var l=$("div.assignedlogosgrid").text();$.ajax({type:"POST",url:$(this).attr("action"),data:m,dataType:"html",cache:false,processData:false,contentType:false,beforeSend:function(){j.html("");j.css("color","black");$("form#availablelogos div.buttons").hide().appendTo("form#availablelogos");$("#spinner").show()},success:function(o){$("#spinner").hide();j.html(o);revealAlert($("div.uploadresult").text(),"OK");$.ajax({type:"GET",url:l,cache:false,success:function(p){$("form#assignedlogos").replaceWith(p);$("#availablelogos").unbind();$("form#assignedlogos").unbind();$("#uploadlogo").unbind();$("table#details").unbind();$("form#availablelogos input[name='filename']").unbind("click");GINIT.initialize()},error:function(p,r,q){$("#spinner").hide();$("#availablelogos").unbind();$("#assignedlogos").unbind();$("#uploadlogo").unbind();$("table#details").unbind();$("form#availablelogos input[name='filename']").unbind("click");GINIT.initialize()}});$.ajax({type:"GET",url:k,cache:false,success:function(p){$("form#availablelogos").replaceWith(p);$("form#availablelogos").unbind();$("form#assignedlogos").unbind();$("#uploadlogo").unbind();$("table#details").unbind();$("form#availablelogos input[name='filename']").unbind("click");GINIT.initialize()},error:function(p,r,q){$("#spinner").hide();$("#availablelogos").unbind();$("#uploadlogo").unbind();$("table#details").unbind();$("form#availablelogos input[name='filename']").off("click");revealAlert('<div data-alert class="alert-box alert">'+p.responseText+"</div>","OK");GINIT.initialize()}})},error:function(o,q,p){$("#spinner").hide();revealAlert('<div data-alert class="alert-box alert">'+o.responseText+"</div>","OK")}}).done(function(){})}));$("li.fromprevtoright").each(function(){var n=$(this).prev();var k=n.offset().left;var m=$(this).prev().find("input,textarea").last();var o=m.offset().left;var j=m.width();var l=(o+j)-k;$(this).css("text-align","right").width(l)});$("form#assignedlogos input[name='logoid']").click(function(){$(this).after($("div#unsignlogosbtn").show())});$("form#applyforaccount").on("submit",function(l){l.preventDefault();var j=$("div.result");var k=$("form#applyforaccount").serializeArray();$.ajax({type:"POST",url:$(this).attr("action"),data:k,dataType:"html",cache:false,beforeSend:function(){j.html("");$("#spinner").show()},success:function(m){$("#spinner").hide();j.html(m);$("form#applyforaccount").remove()},error:function(m,o,n){$("#spinner").hide();j.html(m.responseText);j.css("color","red");$("form#applyforaccount").remove()}})});$("form#assignedlogos").on("submit",(function(n){n.preventDefault();var j=$("div.uploadresult");var l=$("form#assignedlogos").serializeArray();var m=$("input[name=logoid]:radio:checked");var o=$("#messagereveal");var k=o.find("p.infomsg");$.ajax({type:"POST",url:$(this).attr("action"),data:l,dataType:"html",cache:false,beforeSend:function(){$("div#unsignlogosbtn").hide().appendTo("form#assignedlogos");j.html("");$("#spinner").show()},success:function(p){$("#spinner").hide();k.html(p);o.foundation("reveal","open");m.parent().remove()},error:function(p,r,q){$("#spinner").hide();k.html(p.responseText);o.foundation("reveal","open")}})}));$(".updatenotifactionstatus").click(function(q){q.preventDefault();var l=$("#notificationupdateform");var p;var k=$(this).attr("value");var o=$(this).closest("tbody");var m=$(this).closest("tr");var n=m.find("div.subscrstatus:first");var j=c+"notifications/subscriber/updatestatus/"+k;l.attr("action",j);l.find("#noteid").first().val(k)});$("#fvform").submit(function(l){l.preventDefault();var n=$(this);var m=n.serializeArray();var k=n.attr("action");var j=n.find("button:focus").attr("id");$.ajax({type:"POST",url:k,cache:false,data:m,timeout:120000,success:function(o){$("#spinner").hide();var q=$.parseJSON(o);if(!q){alert("no data received from upstream server")}else{if(q.returncode){$("span#fvreturncode").append(q.returncode);$("div#fvresult").show()}if(q.returncode==="success"){n.find("button:focus").css("background-color","#00aa00");n.find("button:focus").data("passed","true");n.find("button:focus").attr("disabled","true")}else{if(q.returncode==="error"){n.find("button:focus").css("background-color","#aa0000");n.find("button:focus").data("passed","false")}}if(q.message){var p;$.each(q.message,function(s,r){$.each(r,function(u,t){p="<div>"+s+": "+t+"</div>";$("div#fvmessages").append(p)})})}}},beforeSend:function(){$("span#fvreturncode").text("");$("div#fvmessages").text("");$("#spinner").show()},error:function(p,q,o){$("#spinner").hide();if(q==="timeout"){window.alert("got timeout from validation server")}else{window.alert("unknown problem with receiving data")}}})});$("form#approvequeue").submit(function(l){var j=0;var k=0;$("button[name='mandatory']").each(function(m){if($(this).data("passed")==="true"){j+=1}k+=1});if(k!==j){window.alert("All mandatory validations have to pass successfully!");l.preventDefault()}});$(document).on("click",".fmembers","a",function(){var k=$(this),j=k.attr("href");var m=$(this).parent().parent();if($(m).hasClass("opened")===true){$(m).next().remove();$(m).removeClass("opened").removeClass("highlight")}else{var l=$("<ul/>");$.ajax({url:j,timeout:9500,cache:true,success:function(q){$("#spinner").hide();var o;var p;var n;$(m).addClass("opened").addClass("highlight");if(!q){window.alert("no data")}else{if(!q.idp&&!q.sp&&!q.both){n="<div>"+q.definitions.nomembers+"</div>";l.append(n)}else{var r=q.definitions.preurl;if(q.idp){o=$("<div>"+q.definitions.idp+"</div>");p=$("<ol/>");$.each(q.idp,function(t,s){n='<li class="homeorg"><a href="'+r+s.pid+'">'+s.pname+"</a> ("+s.entityid+") </li>";p.append(n)});o.append(p);l.append(o)}if(q.sp){o=$("<div>"+q.definitions.sp+"</div>");p=$("<ol/>");$.each(q.sp,function(t,s){n='<li class="resource"><a href="'+r+s.pid+'">'+s.pname+"</a> ("+s.entityid+") </li>";p.append(n)});o.append(p);l.append(o)}if(q.both){o=$("<div>"+q.definitions.both+"</div>");p=$("<ol/>");$.each(q.both,function(t,s){n='<li class="both"><a href="'+r+s.pid+'">'+s.pname+"</a> ("+s.entityid+") </li>";p.append(n)});o.append(p);l.append(o)}}}},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();window.alert("problem with loading data")}}).done(function(){var n='<tr class="feddetails"><td colspan="7"><ul class="feddetails">'+l.html()+"</ul></td></tr>";$(n).insertAfter(m)})}return false});$("#getmembers").click(function(){var k=$(this),j=k.attr("href");var l=$("<ul/>");$.ajax({url:j,timeout:22500,cache:true,dataType:"json",success:function(q){$("#spinner").hide();if(!q){window.alert("no data")}else{var p=$("<div/>");p.addClass("zebralist row");p.css("list-style-type","decimal");var o;var r=1;var m=1;$.each(q,function(t,s){var n=$("<span/>");$.each(s.feds,function(u,v){var w='<span class="label">'+v+"</span>&nbsp;";n.append(w)});o='<div class="large-12 columns" style="margin-top: 2px; margin-bottom: 2px"><div class="large-9 columns">'+m+'. <a href="'+s.url+'">'+s.name+"</a> <i> ("+s.entityid+') </i></div><div class="fedlbl large-3 end text-right columns">'+n.html()+"</div></div>";p.append(o);r=r+1;m=m+1});l.append(p)}},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();window.alert("problem with loading data")}}).done(function(){var m=l.html();$("div#membership").replaceWith(m)});return false});$(".accordionButton").addClass("off").mouseover(function(){$(this).addClass("over")}).mouseout(function(){$(this).removeClass("over")}).click(function(){$(this).removeClass("on").addClass("off");$(".accordionContent").slideUp("fast");if($(this).next().is(":hidden")===true){$(this).addClass("on");$(this).removeClass("off");$(this).next().slideDown("fast")}});$(".accordionContent").hide()}};$(document).ready(function(){var I=$("#spinner");$(window).scroll(function(){if($(this).scrollTop()>=100){$("#return-to-top").fadeIn(200)}else{$("#return-to-top").fadeOut(200)}});$("#return-to-top").click(function(){$("body,html").animate({scrollTop:0},400)});GINIT.initialize();var U=$("#accessmngmt");var T;if(U.length){T=U.closest("form");var w=U.attr("data-jagger-jsource");$.ajax({type:"GET",url:w,dataTypa:"json",beforeSend:function(){I.show()},success:function(am){var ad=am.definitions.admin;var aj=am.definitions.dictionary.allow;var al=am.definitions.dictionary.deny;var ag=am.definitions.dictionary.hasaccess;var ag=am.definitions.dictionary.hasaccess;var ah=am.definitions.dictionary.hasnoaccess;var ae=am.definitions.dictionary.username;var ak="Administrator";var an="You";I.hide();var af=[];af.push("<table><thead><tr><th>"+ae+"</th>");$.each(am.definitions.actions,function(ao,ap){af.push("<th>"+ap+"</th>")});af.push("</tr></thead>");af.push("<tbody>");$.each(am.data,function(ao,at){af.push("<tr><td>");var ap="";var aq="";var ar="";if(at.isyou===true){ap=ap+' <span class="label warning">'+an+"</span>";aq=' disabled="disabled" '}if(at.isadmin===true){ap=ap+' <span class="label">'+ak+"</span>"}af.push(""+ao+" ("+at.fullname+")"+ap+"");af.push("</td>");$.each(am.definitions.actions,function(au,av){ar="";if(at.isadmin===true){af.push("<td>"+ag+"</td>")}else{if(av==="approve"&&ad!==true){aq=' disabled="disabled" ';ar="secondary"}if(at.perms[av]===true){af.push("<td>"+ag+" <div><button "+aq+' class="tiny alert '+ar+'" value="'+ao+"$|$"+av+'$|$deny" name="changeaccess" type="submit" >'+al+"</button></div></td>")}else{af.push("<td>"+ah+" <div><button "+aq+' class="tiny '+ar+'" value="'+ao+"$|$"+av+'$|$allow" name="changeaccess" type="submit">'+aj+"</button></div></td>")}}});af.push("</tr>")});af.push("</tbody>");af.push("</table>");var ai=af.join("");U.html(ai)},error:function(af,ad,ae){I.hide();window.alert(af.responseText)}});T.on("click","button",function(af){var ae=$(this);var ad=T.serializeArray();ad.push({name:ae.attr("name"),value:ae.val()});console.log(ad);$.ajax({method:"POST",data:ad,url:T.attr("action"),success:function(ag){window.location.href=window.location.href},error:function(ai,ag,ah){}});return false})}var a=/^-?([0-8]?[0-9]|90)\.[0-9]{1,6},-?((1?[0-7]?|[0-9]?)[0-9]|180)\.[0-9]{1,6}$/;var y=$("#providereditform");if(y.length){var S=$("#uihints");var q=$("#addlatlng");var Z=[];var X=[];var ab=y.find("#map-canvas");if(ab.length){google.maps.event.addDomListener(window,"load",mapInitialize);var W=$("#geogroup").first();Z=[];W.find("input").each(function(ae){var ad=$(this).val().split(",");Z.push(ad)});var D=false;S.on("toggled",function(af,ah){if(D===false){var ad=new google.maps.LatLngBounds();for(var aj=0,al=Z.length;aj<al;aj++){var ai=new google.maps.LatLng(Z[aj][0],Z[aj][1]);var ak=new google.maps.Marker({position:ai,map:map,title:""});ak.setMap(map);X.push(ak);ad.extend(ak.position)}D=true;var ae=map.getCenter();google.maps.event.trigger(map,"resize");map.setCenter(ae);if(Z.length>0){map.fitBounds(ad)}}var ag=google.maps.event.addListener(map,"idle",function(){if(map.getZoom()>16){map.setZoom(16)}google.maps.event.removeListener(ag)})})}y.on("click","a.rmgeo",function(ai){var ad=$(this).closest("div.georow").find("input").first().val();var ah=ad.split(",");for(var ag=0,af=X.length;ag<af;ag++){var ae=X[ag];console.log(ae.position.lat()+" ?? "+ah[0]);if(parseFloat(ae.position.lat())===parseFloat(ah[0])){ae.setMap(null);X.splice(ag,1)}}$(this).closest("div.georow").remove();return false});q.on("click",function(am){am.preventDefault();var ag=$("#latlng").val();if(!a.test(ag)){window.alert("incorrect value")}else{var ad=new google.maps.LatLngBounds();var af="z";var ai="0123456789";for(var ak=0;ak<5;ak++){af+=ai.charAt(Math.floor(Math.random()*ai.length))}var al='<div class="small-12 column collapse georow"><div class="small-11 column"><input name="f[uii][idpsso][geo]['+af+']" type="text" value="'+ag+'" readonly="readonly"></div><div class="small-1 column"><a href="#" class="rmgeo"><i class="fi-trash alert" style="color: red"></i></a></div></div>';$(al).appendTo($("#geogroup"));var ae=ag.split(",");var ah=new google.maps.LatLng(ae[0],ae[1]);var aj=new google.maps.Marker({position:ah,map:map,title:""});aj.setMap(map);X.push(aj);ad.extend(aj.position)}});var M;y.find("div.group").each(function(){var ad=$(this).find("select").first();$(this).find("button.langinputrm").each(function(){M=$(this).attr("value");ad.find("option[value="+M+"]").each(function(){$(this).toggleOption(true);$(this).attr("disabled",true)})})});$("button#idpssoadddomainhint").click(function(){var af="";var ad="0123456789";for(var ae=0;ae<5;ae++){af+=ad.charAt(Math.floor(Math.random()*ad.length))}var aj=$("button#helperbutttonrm").html();var ag=$(this).attr("value");var ah="f[uii][idpsso][domainhint][n"+af+"]";var ai=createRowWithLangRm("Domain Hint","Domain Hint",ah,aj);ai.insertBefore($(this).closest("span").parent())});$("button#idpssoaddiphint").click(function(){var af="";var ad="0123456789";for(var ae=0;ae<5;ae++){af+=ad.charAt(Math.floor(Math.random()*ad.length))}var aj=$("button#helperbutttonrm").html();var ag=$(this).attr("value");var ah="f[uii][idpsso][iphint][n"+af+"]";var ai=createRowWithLangRm("IP Hint","IP Hint",ah,aj);ai.insertBefore($(this).closest("span").parent())});$("button#addlhelpdesk").click(function(){var ad=$("span.lhelpdeskadd option:selected").first();var ag=ad.val();var aj=$("button#helperbutttonrm").html();if(typeof ag==="undefined"){return false}var ah=ad.text();var ae=$(this).attr("value");ad.attr("disabled",true).attr("selected",false);var af="f[lhelpdesk]["+ag+"]";var ai=createRowWithLangRm(ag,ah,af,aj);ai.insertBefore($(this).closest("span").parent())});$("button#addldisplayname").click(function(){var ad=$("span.ldisplaynameadd option:selected").first();var ag=ad.val();var aj=$("button#helperbutttonrm").html();if(typeof ag==="undefined"){return false}var ah=ad.text();var ae=$(this).attr("value");ad.attr("disabled",true).attr("selected",false);var af="f[ldisplayname]["+ag+"]";var ai=createRowWithLangRm(ag,ah,af,aj);ai.insertBefore($(this).closest("span").parent())});$("button#idpadduiidisplay").click(function(){var ad=$("span.idpuiidisplayadd option:selected").first();var ag=ad.val();var aj=$("button#helperbutttonrm").html();if(typeof ag==="undefined"){return false}var ah=ad.text();var ae=$(this).attr("value");ad.attr("disabled",true).attr("selected",false);var af="f[uii][idpsso][displayname]["+ag+"]";var ai=createRowWithLangRm(ag,ah,af,aj);ai.insertBefore($(this).closest("span").parent())});$("button#idpadduiihelpdesk").click(function(){var ad=$("span.idpuiihelpdeskadd option:selected").first();var ag=ad.val();if(typeof ag==="undefined"){return false}var aj=$("button#helperbutttonrm").html();var ah=ad.text();var ae=$(this).attr("value");ad.attr("disabled",true).attr("selected",false);var af="f[uii][idpsso][helpdesk]["+ag+"]";var ai=createRowWithLangRm(ag,ah,af,aj);ai.insertBefore($(this).closest("span").parent())});$("button#spadduiidisplay").click(function(){var ad=$("span.spuiidisplayadd option:selected").first();var af=ad.val();if(typeof af==="undefined"){return false}var ag=ad.text();var ai=$("button#helperbutttonrm").html();ad.attr("disabled",true).attr("selected",false);var ae="f[uii][spsso][displayname]["+af+"]";var ah=createRowWithLangRm(af,ag,ae,ai);ah.insertBefore($(this).closest("span").parent())});$("button#spadduiihelpdesk").click(function(){var ad=$("span.spuiihelpdeskadd option:selected").first();var af=ad.val();if(typeof af==="undefined"){return false}var ag=ad.text();var ai=$("button#helperbutttonrm").html();ad.attr("disabled",true).attr("selected",false);var ae="f[uii][spsso][helpdesk]["+af+"]";var ah=createRowWithLangRm(af,ag,ae,ai);ah.insertBefore($(this).closest("span").parent())});$("button#spadduiidesc").click(function(){var ad=$("span.spuiidescadd option:selected").first();var ae=ad.val();if(typeof ae==="undefined"){return false}var af=ad.text();var ag=$("button#helperbutttonrm").html();ad.attr("disabled",true).attr("selected",false);$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][spsso][desc]['+ae+']" class="right inline">'+af+'</label></div><div class="small-6 large-7 columns"><textarea id="f[uii][spsso][desc]['+ae+']" name="f[uii][spsso][desc]['+ae+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"><button type="button" class="btn langinputrm button tiny left inline alert" name="uiispdescrm" value="'+ae+'">'+ag+"</button></div></div>").insertBefore($(this).closest("span").parent())});$("button#addlname").click(function(){var ad=$("span.lnameadd option:selected").first();var ag=ad.val();if(typeof ag==="undefined"){return false}var aj=$("button#helperbutttonrm").html();var ah=ad.text();var ae=$(this).attr("value");ad.attr("disabled",true).attr("selected",false);var af="f[lname]["+ag+"]";var ai=createRowWithLangRm(ag,ah,af,aj);ai.insertBefore($(this).closest("span").parent())});var e=$("button[name='addinnewlang']");e.on("click",function(aj){var ae=$(this);var am=ae.closest("fieldset");var al=ae.closest("span");if(al.length===0){return false}var ag=al.find(":selected").first();if(ag.length===0){return false}var ad=ag.attr("disabled");if(ad!==null&&ad==="disabled"){return false}var ah=ag.val();var ai=ag.text();if(typeof ah==="undefined"||ah===""){return false}var ak=$("button#helperbutttonrm").html();var af=ae.attr("value").replace("XXX",ah);ag.attr("disabled",true).attr("selected",false);var an=createRowWithLangRm(ah,ai,af,ak);an.insertBefore($(this).closest("span").parent())});$("button#idpadduiidesc").click(function(){var ad=$("span.idpuiidescadd option:selected").first();var af=ad.val();if(typeof af==="undefined"){return false}var ah=$("button#helperbutttonrm").html();var ag=ad.text();var ae=$(this).attr("value");ad.attr("disabled",true).attr("selected",false);$('<div class="small-12 columns"><div class="small-3 columns"><label for="f[uii][idpsso][desc]['+af+']" class="right inline">'+ag+' </label></div><div class="small-6 large-7 columns"><textarea id="f[uii][idpsso][desc]['+af+']" name="f[uii][idpsso][desc]['+af+']" rows="5" cols="40"/></textarea></div><div class="small-3 large-2 columns"> <button type="button" class="btn langinputrm button tiny left inline" name="ldesc" value="'+af+'">'+ah+"</button></div></div>").insertBefore($(this).closest("span").parent())});$("button#addlprivacyurlspsso").click(function(){var ad=$("span.addlprivacyurlspsso option:selected").first();var ag=ad.val();if(typeof ag==="undefined"){return false}var ah=ad.text();var aj=$("button#helperbutttonrm").html();var ae=$(this).attr("value");ad.attr("disabled",true).attr("selected",false);var af="f[prvurl][spsso]["+ag+"]";var ai=createRowWithLangRm(ag,ah,af,aj);ai.insertBefore($(this).closest("span").parent())});$("button#addlprivacyurlidpsso").click(function(){var ad=$("span.addlprivacyurlidpsso option:selected").first();var ag=ad.val();var aj=$("button#helperbutttonrm").html();if(typeof ag==="undefined"){return false}var ah=ad.text();var ae=$(this).attr("value");ad.attr("disabled",true).attr("selected",false);var af="f[prvurl][idpsso]["+ag+"]";var ai=createRowWithLangRm(ag,ah,af,aj);ai.insertBefore($(this).closest("span").parent())});$("#ncontactbtn").click(function(){var ah="";var ag=$(this).attr("value").split("|");var ae="abcdefghijklmnopqrstuvwxyz0123456789";for(var af=0;af<5;af++){ah+=ae.charAt(Math.floor(Math.random()*ae.length))}var ad='<div class="group"><div class="small-12 columns"><fieldset><legend>'+ag[5]+'</legend><div><div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+ah+'][type]" class="right inline">'+ag[1]+'</label></div><div class="small-8 large-7 columns inline"><select name="f[contact][n_'+ah+'][type]"> <option value="administrative">Administrative</option> <option value="technical">Technical</option> <option value="support" selected="selected">Support</option> <option value="billing">Billing</option> <option value="other">Other</option> </select></div><div class="small-1 large-2 columns"></div></div> <div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+ah+'][fname]" class="right inline">'+ag[2]+'</label></div><div  class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+ah+'][fname]" value="" id="f[contact][n_'+ah+'][fname]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div> <div class="small-12 columns"><div  class="small-3 columns"><label for="f[contact][n_'+ah+'][sname]" class="right inline">'+ag[3]+'</label></div><div class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+ah+'][sname]" value="" id="f[contact][n_'+ah+'][sname]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[contact][n_'+ah+'][email]" class="right inline ">'+ag[4]+'</label></div><div class="small-8 large-7 columns"><input type="text" name="f[contact][n_'+ah+'][email]" value="" id="f[contact][n_'+ah+'][email]" class="right inline" /></div><div class="small-1 large-2 columns"></div></div><div class="rmelbtn small-12 columns"><div class="small-9 large-10 columns"><button type="button" class="btn contactrm tiny alert button inline right" name="contact" value="'+ah+'">'+ag[0]+'</button></div><div class="small-3 large-2 columns"></div></div></div></fieldset></div></div>';$(this).parent().before(ad)});$("#nidpssocert").click(function(){var ag="";var ae="abcdefghijklmnopqrstuvwyz0123456789";for(var af=0;af<5;af++){ag+=ae.charAt(Math.floor(Math.random()*ae.length))}ag="newx"+ag;var ad='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][idpsso]['+ag+'][type]" class="inline right">Certificate type</label></div><div class="small-6 large-7 columns"><select name="f[crt][idpsso]['+ag+'][type]"> <option value="x509">x509</option> </select></div><div class="small-3 large-2 columns"></div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][idpsso]['+ag+'][usage]" class="inline right">Certificate use</label></div><div class="small-6 large-7 columns"><select name="f[crt][idpsso]['+ag+'][usage]"> <option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][idpsso]['+ag+'][keyname]" class="inline right">KeyName</label></div><div class="small-6 large-7 columns"><input type="text" name="f[crt][idpsso]['+ag+'][keyname]" value="" id="f[crt][idpsso]['+ag+'][keyname]" class=""  /> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][idpsso]['+ag+'][certdata]" class="inline right">Certificate</label></div><div class="small-6 large-7 columns"><textarea name="f[crt][idpsso]['+ag+'][certdata]" cols="65" rows="20" id="f[crt][idpsso]['+ag+'][certdata]" class="certdata notice" ></textarea></div><div class="small-3 large-2 columns"></div></div>';$(this).parent().before(ad)});$("#naacert").click(function(){var ag="";var ae="abcdefghijklmnopqrstuvwyz0123456789";for(var af=0;af<5;af++){ag+=ae.charAt(Math.floor(Math.random()*ae.length))}ag="newx"+ag;var ad='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][aa]['+ag+'][type]" class="inline right">Certificate type</label></div><div class="small-6 large-7 columns"><select name="f[crt][aa]['+ag+'][type]"> <option value="x509">x509</option> </select> </div><div class="small-3 large-2 columns"></div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][aa]['+ag+'][usage]" class="inline right">Usage</label></div><div class="small-6 large-7 columns"><select name="f[crt][aa]['+ag+'][usage]"> <option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][aa]['+ag+'][keyname]" class="inline right">KeyName</label></div><div class="small-6 large-7 columns"><input type="text" name="f[crt][aa]['+ag+'][keyname]" value="" id="f[crt][aa]['+ag+'][keyname]" class=""  /> </div><div class="small-3 large-2 columns"></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][aa]['+ag+'][certdata]" class="inline right">Certificate</label></div><div class="small-6 large-7 columns"><textarea name="f[crt][aa]['+ag+'][certdata]" cols="65" rows="20" id="f[crt][aa]['+ag+'][certdata]" class="certdata notice" ></textarea> </div><div class="small-3 large-2 columns"></div></div> ';$(this).parent().before(ad)});$("#nspssocert").click(function(){var ag="";var ae="abcdefghijklmnopqrstuvwyz0123456789";for(var af=0;af<5;af++){ag+=ae.charAt(Math.floor(Math.random()*ae.length))}ag="newx"+ag;var ad='<div class="certgroup small-12 columns"><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][spsso]['+ag+'][type]" class="right inline">Certificate type</label></div><div class="small-8 large-7 columns"><select name="f[crt][spsso]['+ag+'][type]"><option value="x509">x509</option></select> </div><div class="small-1 large-2 columns end"></div></div><div class="small-12  columns"><div class="small-3 columns"><label for="f[crt][spsso]['+ag+'][usage]" class="right inline">Certificate use</label></div><div class="small-8 large-7 columns"><select name="f[crt][spsso]['+ag+'][usage]"><option value="signing">signing</option> <option value="encryption">encryption</option> <option value="both" selected="selected">signing and encryption</option> </select></div><div class="small-1 large-2 columns end"></div></div><div class="small-12 columns hidden"><div class="small-3 columns"><label for="f[crt][spsso]['+ag+'][keyname]" class="right inline">KeyName</label></div><div class="small-8 large-7 columns"><input type="text" name="f[crt][spsso]['+ag+'][keyname]" value="" id="f[crt][spsso]['+ag+'][keyname]" class=""  /></div><div class="small-1 large-2 columns end"></div> </div><div class="small-12 columns"><div class="small-3 columns"><label for="f[crt][spsso]['+ag+'][certdata]" class="right inline">Certificate</label></div><div class="small-8 large-7 columns"><textarea name="f[crt][spsso]['+ag+'][certdata]" cols="65" rows="20" id="f[crt][spsso]['+ag+'][certdata]" class="certdata" ></textarea></div><div class="small-1 large-2 columns end"></div></div><div class="small-12 columns"><div class="small-3 columns">&nbsp;</div><div class="small-6 large-7 columns"><button class="certificaterm button alert tiny right" value="'+ag+'" name="certificate" type="button">Remove certificate</button></div><div class="small-3 large-2 columns"></div></div></div>';$(this).parent().before(ad)});$("#nacsbtn").click(function(){var ag="";var ae="abcdefghijklmnopqrstuvwxyz0123456789";for(var af=0;af<5;af++){ag+=ae.charAt(Math.floor(Math.random()*ae.length))}var ad='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][AssertionConsumerService][n_'+ag+'][bind]" class="right inline">Binding Name</label></div><div class="small-5 columns inline"><select name="f[srv][AssertionConsumerService][n_'+ag+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST-SimpleSign">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST-SimpleSign</option> <option value="urn:oasis:names:tc:SAML:2.0:bindings:PAOS">urn:oasis:names:tc:SAML:2.0:bindings:PAOS</option> <option value="urn:oasis:names:tc:SAML:2.0:profiles:browser-post">urn:oasis:names:tc:SAML:2.0:profiles:browser-post</option> <option value="urn:oasis:names:tc:SAML:1.0:profiles:browser-post">urn:oasis:names:tc:SAML:1.0:profiles:browser-post</option> <option value="urn:oasis:names:tc:SAML:1.0:profiles:artifact-01">urn:oasis:names:tc:SAML:1.0:profiles:artifact-01</option> </select></div> <div class="small-4 columns"><div class="small-6 columns"><input type="text" name="f[srv][AssertionConsumerService][n_'+ag+'][order]" value="" id="f[srv][AssertionConsumerService][n_'+ag+'][order]" size="2" maxlength="2" class="acsindex "  /></div><div class="small-6 columns"><label for="f[srv][AssertionConsumerService][n_'+ag+'][default]">Is default</label><input type="radio" name="f[srv][AssertionConsumerService][n_'+ag+'][default]" value="1" id="f[srv][AssertionConsumerService][n_'+ag+'][default]" class="acsdefault"/></div></div> </div>          <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][AssertionConsumerService][n_'+ag+'][url]" class="right inline">URL</label></div><div class="small-8 large-7 columns inline"><input name="f[srv][AssertionConsumerService][n_'+ag+'][url]" id="f[srv][AssertionConsumerService][n_'+ag+'][url]" type="text"></div><div class="small-3 large-2 columns"><button class="inline left button tiny alert rmfield"  name="rmfield" type="button">Remove</button></div></div></div>';$(this).parent().before(ad)});$("#nidpartifactbtn").click(function(){var ag="";var ae="abcdefghijklmnopqrstuvwxyz0123456789";for(var af=0;af<5;af++){ag+=ae.charAt(Math.floor(Math.random()*ae.length))}var ad='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][IDPArtifactResolutionService][n_'+ag+'][bind]" class="right inline">Binding Name</label></div><div class="small-6 large-7 columns inline"><select name="f[srv][IDPArtifactResolutionService][n_'+ag+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:SOAP" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</option> <option value="urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding">urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding</option></select></div> <div class="small-2 large-1 columns end"><input type="text" name="f[srv][IDPArtifactResolutionService][n_'+ag+'][order]" value="" id="f[srv][IDPArtifactResolutionService][n_'+ag+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div> <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][IDPArtifactResolutionService][n_'+ag+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns inline"><input name="f[srv][IDPArtifactResolutionService][n_'+ag+'][url]" id="f[srv][IDPArtifactResolutionService][n_'+ag+'][url]" type="text"></div><div class="small-3 large-2 columns"><button class="inline left button tiny alert rmfield" value="" name="rmfield" type="button">Remove</button></div></div>';$(this).parent().before(ad)});$("#nspartifactbtn").click(function(){var ag="";var ae="abcdefghijklmnopqrstuvwxyz0123456789";for(var af=0;af<5;af++){ag+=ae.charAt(Math.floor(Math.random()*ae.length))}var ad='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][SPArtifactResolutionService][n_'+ag+'][bind]" class="right inline">Binding Name</label></div><div class="small-8 large-7 columns inline"><select name="f[srv][SPArtifactResolutionService][n_'+ag+'][bind]"> <option value="urn:oasis:names:tc:SAML:2.0:bindings:SOAP" selected="selected">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</option> <option value="urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding">urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding</option></select> </div> <div class="small-1  columns left"><input type="text" name="f[srv][SPArtifactResolutionService][n_'+ag+'][order]" value="" id="f[srv][SPArtifactResolutionService][n_'+ag+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div>           <div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][SPArtifactResolutionService][n_'+ag+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns inline"><input name="f[srv][SPArtifactResolutionService][n_'+ag+'][url]" id="f[srv][SPArtifactResolutionService][n_'+ag+'][url]" type="text"> </div><div class="small-3 large-2 columns"><button class="inline left button tiny alert rmfield"  name="rmfield" type="button">Remove</button></div></div>';$(this).parent().before(ad)});$("#ndrbtn").click(function(){var ag="";var ae="abcdefghijklmnopqrstuvwxyz0123456789";for(var af=0;af<5;af++){ag+=ae.charAt(Math.floor(Math.random()*ae.length))}var ad='<div class="srvgroup"><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][DiscoveryResponse][n_'+ag+'][bind]" class="right inline">Binding Name</label></div><div class="small-6 large-7 columns"><select name="f[srv][DiscoveryResponse][n_'+ag+'][bind]"><option value="urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol">urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol</option></select> </div><div class="small-1 columns end"><input type="text" name="f[srv][DiscoveryResponse][n_'+ag+'][order]" value="" id="f[srv][DiscoveryResponse][n_'+ag+'][order]" size="2" maxlength="2" class="acsindex "  /></div></div><div class="small-12 columns"><div class="small-3 columns"><label for="f[srv][DiscoveryResponse][n_'+ag+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns"><input name="f[srv][DiscoveryResponse][n_'+ag+'][url]" id="f[srv][DiscoveryResponse][n_'+ag+'][url]" type="text"></div><div class="small-1 columns end"><button class="rmfield button alert tiny left" name="rmfield">Remove</button></div></div></div>';$(this).parent().before(ad)});$("#nribtn").click(function(){var ag="";var ae="abcdefghijklmnopqrstuvwxyz0123456789";for(var af=0;af<5;af++){ag+=ae.charAt(Math.floor(Math.random()*ae.length))}var ad='<div class="small-12 columns srvgroup"><div class="small-3 columns"><label for="f[srv][RequestInitiator][n_'+ag+'][url]" class="right inline">URL</label></div><div class="small-6 large-7 columns"><input name="f[srv][RequestInitiator][n_'+ag+'][url]" id="f[srv][RequestInitiator][n_'+ag+'][url]" type="text"></div><div class="small-3 large-2 columns"><button type="button" class="inline left button tiny alert rmfield" name="rmfield" value="">remove</button></div></div>';$(this).parent().before(ad)});$("button.addnewlogo").click(function(){var ae;var ak=$(this).closest("div.reviewlogo");var ag="abcdefghijklmnopqrstuvwxyz0123456789";var ar=ak.attr("id");var ao;var ad="";if(ar==="idpreviewlogo"){ao="idp"}else{ao="sp"}for(var ai=0;ai<5;ai++){ad+=ag.charAt(Math.floor(Math.random()*ag.length))}var au=ak.find("input[name='"+ao+"inputurl']").attr("value");var am=ak.find("input[name='"+ao+"inputsize']").attr("value");var aq=ak.find("select[name='"+ao+"logolang']").val();var ah=ak.find("input[name='"+ao+"embedded']").first();var an=ak.find("input[name='"+ao+"logoraw']").attr("value");if(aq==="0"){ae="unspec"}else{ae=aq}var aj='<input type="hidden" name="f[uii]['+ao+"sso][logo][n"+ad+'][size]" value="'+am+'">';var ap='<input type="hidden" name="f[uii]['+ao+"sso][logo][n"+ad+'][lang]" value="'+aq+'">';var af=$("li#nlogo"+ao+"row");var at=af.clone(true);at.removeAttr("id");if(ah!==null&&ah.is(":checked")&&ah.val()==="embedded"&&an!==undefined&&an!==null&&an!==""){var al='<input type="hidden" name="f[uii]['+ao+"sso][logo][n"+ad+'][url]" value="'+an+'">';at.find("img").first().attr("src",an).append(al).append(aj).append(ap);at.find("div.logoinfo").first().append(""+ae+"<br />").append(am+"<br />")}else{var al='<input type="hidden" name="f[uii]['+ao+"sso][logo][n"+ad+'][url]" value="'+au+'">';at.find("img").first().attr("src",au).append(al).append(aj).append(ap);at.find("div.logoinfo").first().append(""+ae+"<br />").append(au+"<br />").append(am+"<br />")}at.insertBefore(af).show()});$("button.getlogo").click(function(){var ai,ak;var ae=$(this).attr("name");var aj,al;var ag=$(this).attr("value");if(ae==="idpgetlogo"){al=$("#idpreviewlogo");al.hide();ai=$("small.idplogoretrieve");ai.empty().hide();aj=$("[name='idplogoretrieve']").val();ak=$("#idpreviewlogo").find("div.imgsource").first()}else{al=$("#spreviewlogo");al.hide();ai=$("small.splogoretrieve");ai.empty().hide();aj=$("[name='splogoretrieve']").val();ak=$("#spreviewlogo").find("div.imgsource").first()}var ah=$("[name='csrfname']").val();var ad=$("[name='csrfhash']").val();var af=[{name:ah,value:ad},{name:"logourl",value:aj}];$.ajax({type:"POST",url:ag,cache:false,data:af,dataType:"json",success:function(ax){if(ax){if(ax.error){ai.append(ax.error).show()}else{if(ax.data){var aq=ax.data;var au=new Image();au.onload=function(){};au.src=aq.url;var an=aq.width+"x"+ax.data.height;var aw,av,ao,ar;var ap="abcdefghijklmnopqrstuvwxyz0123456789";var am="";for(var at=0;at<5;at++){am+=ap.charAt(Math.floor(Math.random()*ap.length))}if(ae==="idpgetlogo"){ao='<input type="hidden" name="logotype" value="idp">';aw='<input type="hidden" name="idpinputurl" value="'+ax.data.url+'">';av='<input type="hidden" name="idpinputsize" value="'+an+'">';ar='<input type="hidden" name="idplogoraw" value="'+ax.data.raw+'">';ak.empty().append(au).append(aw).append(av).append(ao).append(ar);$("div#idpreviewlogo div.logoinfo").empty().append(an);al.show()}else{if(ae==="spgetlogo"){ao='<input type="hidden" name="logotype" value="idp">';aw='<input type="hidden" name="spinputurl" value="'+ax.data.url+'">';av='<input type="hidden" name="spinputsize" value="'+an+'">';ar='<input type="hidden" name="splogoraw" value="'+ax.data.raw+'">';ak.empty().append(au).append(aw).append(av).append(ao).append(ar);$("div#spreviewlogo div.logoinfo").empty().append(an);al.show()}}}}}}})});y.on("click","button.contactrm",function(af){var ae=$(this).attr("value");var ag=$(this).attr("name");var ad=$(this).closest("div.group");ad.remove()});y.on("click","button.certificaterm",function(af){var ae=$(this).attr("value");var ag=$(this).attr("name");var ad=$(this).closest("div.certgroup");ad.remove()});y.on("click","input.acsdefault",function(ad){if($(this).is(":checked")){$(".acsdefault").not(this).removeAttr("checked")}});y.on("click","button.rmfield",function(af){var ae=$(this).closest("div.srvgroup");var ad=$(this).attr("value");var ag=$(this).attr("name");ae.find("input").each(function(){$(this).attr("value","")});ae.find("textarea").each(function(){$(this).val("")});ae.remove()});y.on("click","button.langinputrm",function(ag){ag.preventDefault();var af=$(this).closest("div").parent();var ae=$(this).attr("value");var ah=$(this).attr("name");var ad=$(this).closest("div.group").find("select").first();af.find("input").each(function(){$(this).attr("value","")});af.find("textarea").each(function(){$(this).val("")});ad.find("option[value="+ae+"]").each(function(){$(this).toggleOption(true);$(this).attr("disabled",false)});af.remove()})}$("#spmatrixload").on("click",function(af){var ag=$(this);var ae=$(this).attr("data-jagger-ajaxurl");var ad=$(document).find("#spmatrixdiv").first();$.ajax({type:"GET",url:ae,cache:false,dataType:"json",beforeSend:function(){I.show()},success:function(aq){I.hide();if(aq){var al=aq.attrs;var ah=aq.data;var aj=aq.providerprefurl;var ap='<div><span class="den">&nbsp;&nbsp;&nbsp;</span> <span>denied</span></div><div><span class="perm">&nbsp;&nbsp;&nbsp;</span><span>permitted</span></div><div><span class="dis">&nbsp;&nbsp;&nbsp;</span><span>not supported</span></div><div><span>R</span>-<span>required</span></div><div><span>D</span>-<span>desired</span></div>';var ar=0;var ak='<table class="table table-header-rotated" id="idpmatrixresult"><thead><tr>';ak+='<th style="background: white">'+ap+"</th>";$.each(al,function(at,au){ak+='<th class="rotate"><div><span>'+at+"</span></div></th>";ar++});if(ar>52){$("#container").css({"max-width":"100%"})}var ao,am,ai,an;ak+="</tr></thead><tbody>";$.each(ah,function(au,at){ak+='<tr><td data-jagger-entidlink="'+at.idpid+'" class="searchcol"><a href="'+aj+"/"+at.idpid+'" title="'+at.entityid+'" >'+at.name+'</a><span class="hidden">'+au+"</span></td>";$.each(al,function(aw,av){an="";am=at.data["attributes"][""+aw+""];ao=av[0].toUpperCase();if(am===undefined){an="dis"}else{if(am===0){an="den"}else{if(am===1){if(ao==="R"){an="perm"}else{an="den"}}else{if(am===2){an="perm"}}}}ak+='<td class="'+an+'">';ak+=ao+"</td>"})});ak+="</tbody></table>";ag.hide();ad.html(ak)}},error:function(){I.hide()}})});var J;if($("#attrpols").length>0){var h=$("#attrpols").first();var r=$("#attrpolstab").first();var aa=$("#arpmaddspecattr").first();J=h.attr("data-jagger-providerdetails");var L;r.on("toggled",function(ad,af){var am='<div class="progress"><span class="meter" style="width: 10%"></span></div>';var aj=$($.parseHTML(am));var ag=aj.find("span.meter").first();var ae=$("#addattrsupport");var ai=$("#addentcatattr");var ak=$("#addespecattr");console.log(ad,af);var an=$(af).attr("data-reveal-ajax-tab");if(an===undefined){return false}var al=h.find("section.active").first();var ah;$.ajax({url:an,method:"GET",dataType:"json",beforeSend:function(){I.show()},success:function(aO){I.hide();ag.css("width","100%");var aN;var aA;var az;var ap;if(aO.type==="supported"){var ax=[];$.each(aO.data.support,function(aR,aQ){ax.push(aQ)});ah='<div class="small-12 column"><table class="table"><thead><tr>';$.each(aO.definitions.columns,function(aR,aQ){ah+="<th>"+aQ+"</th>"});ah+="</tr></thead>";$.each(aO.data.global,function(aR,aQ){az=parseInt(aQ);aA="";ah+="<tr><td>"+aO.definitions.attrs[aR]+"</td><td>";if(az===0){ah+='<span class="label alert">'+aO.definitions.policy[aQ]+"</span>"}else{if(az===1){ah+='<span class="label warning">'+aO.definitions.policy[aQ]+"</span>"}else{if(az===2){ah+='<span class="label success">'+aO.definitions.policy[aQ]+"</span>"}else{ah+='<span class="label">'+aO.definitions.policy[aQ]+"</span>"}}}aN=ax.indexOf(parseInt(aR));if(aN===-1){aA='&nbsp;<span class="label alert">'+aO.definitions.policy[1000]+"</span>";ap="0"}else{ap="1"}ah+=aA;ah+="</td><td>";ah+='<a href="#" class="modalconfirm" data-jagger-attrpolicy="'+aQ+'" data-jagger-attrsupport="'+ap+'" data-jagger-attrname="'+aO.definitions.attrs[aR]+'" data-jagger-attrid="'+aR+'" data-jagger-action="edit" data-jagger-arp="global"><i class="fi-pencil"></i></a>';if(aN===-1){ah+='&nbsp;&nbsp;&nbsp;<a href="#" class="modalconfirm" data-jagger-attrsupport="'+ap+'" data-jagger-attrname="'+aO.definitions.attrs[aR]+'" data-jagger-attrid="'+aR+'" data-jagger-action="delete" data-jagger-arp="global"><i class="fi-trash alert"></i></a>'}ah+="</td></tr>"});ah+="</table></div>";ae.show().prependTo(al.html(ah))}else{if(aO.type==="federation"){var ax=[];$.each(aO.data.support,function(aR,aQ){ax.push(aQ)});var ar=0;var aM,ay;var aB=aO.definitions.lang.federation;ah='<div class="small-12 column"><table class="table"><thead><tr>';$.each(aO.definitions.columns,function(aR,aQ){ar=ar+1;ah+="<th>"+aQ+"</th>"});ah+="</tr></thead>";var at=ar-2;var aG=aO.definitions["statusstr"];var aF,aD;$.each(aO.data.fedpols,function(aS,aR){var aQ=ax.slice(0);L=parseInt(aS);aD=aO.data.activefeds.indexOf(L);if(aD===-1){ah+='<tr><td colspan="'+ar+'" class="highlight">'+aB+": "+aO.definitions.feds[aS]+' <span class="label alert">'+aG.inactive+"</span></td></tr>"}else{ah+='<tr><td colspan="'+ar+'" class="highlight">'+aB+": "+aO.definitions.feds[aS]+"</td></tr>"}$.each(aR,function(aU,aT){ay="";aM=parseInt(aT);aN=aQ.indexOf(parseInt(aU));if(aM===0){ay="alert"}else{if(aM===1){ay="warning"}else{if(aM===2){ay="success"}}}ah+="<tr><td>"+aO.definitions.attrs[aU]+'</td><td><span class="label '+ay+'">'+aO.definitions.policy[aT]+"</span>";if(aN===-1){ah+='&nbsp;<span class="label alert">'+aO.definitions.lang.unsupported+"</span>"}else{aQ.splice(aN,1)}ah+='</td><td></td><td colspan="'+at+'"><a href="#" class="modalconfirm" data-jagger-attrpolicy="'+aT+'" data-jagger-arp="fed" data-jagger-action="edit" data-jagger-fedid="'+aS+'" data-jagger-attrid="'+aU+'" data-jagger-attrname="'+aO.definitions.attrs[aU]+'"><i class="fi-pencil"></i></a></td></tr>'});$.each(aQ,function(aT,aU){ah+="<tr><td>"+aO.definitions.attrs[aU]+'</td><td><span class="label secondary">'+aO.definitions.policy[100]+'</span></td><td></td><td colspan="'+at+'"><a href="#" class="modalconfirm" data-jagger-arp="fed" data-jagger-attrname="'+aO.definitions.attrs[aU]+'" data-jagger-attrpolicy="100" data-jagger-fedid="'+aS+'" data-jagger-action="edit" data-jagger-attrid="'+aU+'"><i class="fi-pencil"></i></a></td></tr>'})});ah+="</table></div>";al.html(ah)}else{if(aO.type==="entcat"){ax=[];ar=0;var ay="";var ao;var aN;var aH;var aJ=aO.definitions.ecmembers;$.each(aO.data.support,function(aR,aQ){ax.push(aQ)});ah='<div class="small-12 column"><table class="table"><thead><tr>';$.each(aO.definitions.columns,function(aR,aQ){ar=ar+1;ah+="<th>"+aQ+"</th>"});ah+="</tr></thead>";$.each(aO.data.entcats,function(aR,aQ){ah+='<tr><td colspan="'+ar+'" class="highlight">EntityCategory: '+aO.definitions.entcats[aR]["name"]+"  "+aO.definitions.entcats[aR]["value"]+' <i class="ecmembers fi-list"  data-jagger-jsource="'+aJ+"/"+aR+'"></i></td></tr>';$.each(aQ,function(aT,aS){aH="";aN=ax.indexOf(parseInt(aT));if(aN===-1){aH='&nbsp;<span class="label alert">'+aO.definitions.policy[1000]+"</span>"}ay="";ao=parseInt(aS);if(ao===0){ay="alert"}else{if(ao===1){ay="warning"}else{if(ao===2){ay="success"}}}ah+="<tr>";ah+="<td>"+aO.definitions.attrs[aT]+'</td><td><span class="label '+ay+'">'+aO.definitions.policy[aS]+"</span>"+aH+'</td><td><a href="#" class="modalconfirm" data-jagger-arp="entcat" data-jagger-entcatid="'+aR+'" data-jagger-attrid="'+aT+'" data-jagger-arp="entcat" data-jagger-action="edit" data-jagger-attrname="'+aO.definitions.attrs[aT]+'" data-jagger-attrpolicy="'+aS+'"><i class="fi-pencil"></i></a></td>';ah+="</tr>"})});ah+="</table></div>";ai.show().prependTo(al.html(ah))}else{if(aO.type==="sp"){ar=1;ah='<div class="small-12 column"><table class="table"><thead><tr>';$.each(aO.definitions.columns,function(aR,aQ){ar=ar+1;ah+="<th>"+aQ+"</th>"});ah+="</tr></thead>";ax=[];$.each(aO.data.supported,function(aR,aQ){ax.push(aQ)});var aw;var av;var aq=aO.data.sps;var aP;var aC={0:"alert",1:"warning",2:"success",100:"secondary"};var aI;var aE='<span class="label alert">'+aO.definitions.policy[1000]+"</span>";var aL="";var au;var aK;$.each(aO.data.sps,function(aS,aR){var aT=new Array();if(aR.req!==undefined){$.each(aR.req,function(aV,aU){aT[aV]=aU})}if(!$.isEmptyObject(aR.spec)){if(aR.entityid!==undefined){ah+='<tr><td data-jagger-entidlink="'+aS+'" colspan="'+ar+'" class="highlight" >'+aR.entityid+"</td></tr>"}else{if(aO.definitions.sps.hasOwnProperty(aS)){ah+='<tr><td data-jagger-entidlink="'+aS+'" colspan="'+ar+'" class="highlight">'+aO.definitions.sps[aS]["entityid"]+' <span class="label alert">disabled</span></td></tr>'}else{console.log("undefined "+aS+" in data.definitions.sps")}}$.each(aR.spec,function(aV,aU){aK="";au="";aN=ax.indexOf(parseInt(aV));if(aN===-1){au=aE}aI=aO.data.definitions.attrs[aV];av="100";if(aT[aV]!==undefined){av=aT[aV];delete aT[aV]}if(aR.custom!==undefined&&aR.custom[aV]!==undefined){if(aR.custom[aV]["deny"]!==undefined){aK+='<span class="label alert">denied values:  ';$.each(aR.custom[aV]["deny"],function(aX,aW){aK+=aW+", "});aK+="</span>"}else{aK+='<span class="label success">permited values: ';$.each(aR.custom[aV]["permit"],function(aX,aW){aK+=aW+", "});aK+="</span>"}}ah+="<tr><td>"+aI+'</td><td><span class="label '+aC[aU]+'">'+aO.definitions.policy[aU]+"</span>  "+au+" "+aK+"</td><td>"+aO.definitions.req[av]+'</td><td><a href="#" class="modalconfirm" data-jagger-attrpolicy="'+aU+'" data-jagger-entityid="'+aO.definitions.sps[aS]["entityid"]+'" data-jagger-attrname="'+aI+'" data-jagger-spid="'+aS+'" data-jagger-arp="sp" data-jagger-action="edit" data-jagger-attrid="'+aV+'"><i class="fi-pencil"></i></a></td></tr>'});for(var aQ in aT){aK="";if(aR.custom!==undefined&&aR.custom[aQ]!==undefined){if(aR.custom[aQ]["deny"]!==undefined){aK+='<span class="label alert">denied values:  ';$.each(aR.custom[aQ]["deny"],function(aV,aU){aK+=aU+", "});aK+="</span>"}else{aK+='<span class="label success">permited values: ';$.each(aR.custom[aQ]["permit"],function(aV,aU){aK+=aU+", "});aK+="</span>"}}au="";aN=ax.indexOf(parseInt(aQ));if(aN===-1){au=aE}aI=aO.data.definitions.attrs[aQ];if(aT.hasOwnProperty(aQ)){ah+="<tr><td>"+aI+'</td><td><span class="label '+aC["100"]+'">'+aO.definitions.policy["100"]+"</span>  "+au+" "+aK+"</td><td>"+aO.definitions.req[aT[aQ]]+'</td><td><a href="#" class="modalconfirm" data-jagger-attrpolicy="100" data-jagger-entityid="'+aO.definitions.sps[aS]["entityid"]+'" data-jagger-attrname="'+aI+'" data-jagger-spid="'+aS+'" data-jagger-arp="sp" data-jagger-action="edit" data-jagger-attrid="'+aQ+'"><i class="fi-pencil"></i></i></td></tr>'}}}});ah+="</table></div>";ak.show().prependTo(al.html(ah))}}}}},error:function(aq,ao,ap){I.hide();al.html('<div data-aler class="alert-box alert">'+aq.responseText+"</div>")}})});h.on("click","td.highlight",function(ae){var ad=$(this).attr("data-jagger-entidlink");if(ad!==undefined){document.location.href=J+"/"+ad;return false}});h.on("click","a.modalconfirm",function(at){at.preventDefault();var ad=$(this).attr("data-jagger-arp");var af=$(this).attr("data-jagger-action");var ao=$(this).attr("data-jagger-attrname");var al=$(this).attr("data-jagger-attrid");var ax=$(this).attr("data-jagger-fedid");var an=$(this).attr("data-jagger-entcatid");var am=$(this).attr("data-jagger-attrsupport");var ae=$(this).attr("data-jagger-attrpolicy");var ar=$(this).attr("data-jagger-spid");var aq=$(this).attr("data-jagger-entityid");var au=$("[name='baseurl']").val();if(ad!==undefined&&af!==undefined){if(ad==="global"&&af==="delete"){var av=$("#arpmdelattr");av.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide();av.find('input[name="attrname"]').first().val(ao);av.find('input[name="attrid"]').first().val(al);av.find("span.attributename").first().html(ao);av.foundation("reveal","open")}else{if(ad==="global"&&af==="edit"){var av=$("#arpmeditglobalattr");av.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide();av.find("span.attributename").first().html(ao);av.find('input[name="attrname"]').first().val(ao);av.find('input[name="attrid"]').first().val(al);var ak=av.find('input[name="support"]').first();if(am==="1"){ak.prop("checked",true)}else{ak.prop("checked",false)}av.find('[name="policy"] option').prop("selected",false).filter('[value="'+ae+'"]').prop("selected",true);av.foundation("reveal","open")}else{if(ad==="fed"&&af==="edit"){var av=$("#arpmeditfedattr");av.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide();av.find("span.attributename").first().html(ao);av.find('input[name="attrid"]').first().val(al);av.find('input[name="fedid"]').first().val(ax);av.find('[name="policy"] option').prop("selected",false).filter('[value="'+ae+'"]').prop("selected",true);av.foundation("reveal","open")}else{if(ad==="entcat"&&af==="edit"){var av=$("#arpmeditentcatattr");av.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide();av.find("span.attributename").first().html(ao);av.find('input[name="attrid"]').first().val(al);av.find('input[name="entcatid"]').first().val(an);av.find('[name="policy"] option').prop("selected",false).filter('[value="'+ae+'"]').prop("selected",true);av.foundation("reveal","open")}else{if(ad==="sp"&&af==="edit"){var av=$("#arpmeditspattr");av.find(".response").first().removeClass("alert").removeClass("alert-box").empty().hide();av.find("span.attributename").first().html(ao);av.find("span.requestersp").first().html(aq);av.find('input[name="attrid"]').first().val(al);av.find('input[name="spid"]').first().val(ar);av.find('[name="policy"] option').prop("selected",false).filter('[value="'+ae+'"]').prop("selected",true);var ai=av.attr("data-jagger-getdata");var ay=av.find("form").first();var aj=ay.serializeArray();var ah=ay.find('[name="custompolicy"]').first();var ag=ay.find('[name="customvals"]').first();var aw=ay.find('[name="customenabled"]').first();ag.empty();var ap="";aw.prop("checked",false);$.ajax({url:ai,method:"POST",dataType:"json",data:aj,success:function(az){if(az.data){if(az.data.customsp!==undefined){if(az.data.customsp.deny){aw.prop("checked",true);ay.find('[name="custompolicy"] option').prop("selected",false).filter('[value="deny"]').prop("selected",true);$.each(az.data.customsp.deny,function(aB,aA){ap+=aA+", "})}else{if(az.data.customsp.permit){aw.prop("checked",true);ay.find('[name="custompolicy"] option').prop("selected",false).filter('[value="permit"]').prop("selected",true);$.each(az.data.customsp.permit,function(aB,aA){ap+=aA+", "})}}ag.text(ap)}}}});av.foundation("reveal","open")}}}}}}});$("#arpmdelattr").on("click","div.yes",function(af){var ae=$("#arpmdelattr").find("form").first();var ad=ae.serializeArray();var ag=ae.attr("action");$.ajax({url:ag,method:"POST",dataType:"json",data:ad,success:function(ah){$("#arpmdelattr").foundation("reveal","close");r.find('a[href="#attrpol-1"]').first().trigger("click")}})});$("#arpmeditglobalattr").on("click","div.yes",function(af){var ae=$("#arpmeditglobalattr").find("form").first();var ad=ae.serializeArray();var ag=ae.attr("action");$.ajax({url:ag,method:"POST",dataType:"json",data:ad,success:function(ah){$("#arpmeditglobalattr").foundation("reveal","close");r.find('a[href="#attrpol-1"]').first().trigger("click")},error:function(aj,ah,ai){$("#arpmeditglobalattr").find(".response").html(aj.responseText).addClass("alert").addClass("alert-box").show()}})});h.on("click","#addattrsupport button",function(ae){var ad=$("#addattrsupport").attr("data-jagger-link");$.ajax({url:ad,method:"GET",dataType:"json",success:function(af){if(af.data.support){var ag=$("#arpmaddattr").find("select[name='attrid']");ag.find("option").removeAttr("disabled");$.each(af.data.global,function(ai,ah){ag.find("option[value="+ai+"]").prop("disabled","disabled")})}}});$("#arpmaddattr").foundation("reveal","open")});h.on("click","#addentcatattr button",function(ae){var ad=$("#addentcatattr").attr("data-jagger-link");$.ajax({url:ad,method:"GET",dataType:"json",success:function(ag){var ah=$("#arpmaddentcatattr").find("select[name='attrid']");ah.empty();var af=$("#arpmaddentcatattr").find("select[name='entcatid']");af.empty();if(ag.data.support){$.each(ag.data.support,function(aj,ai){ah.append($("<option></option>").attr("value",ai).text(ag.definitions.attrs[ai]))})}if(ag.data.entcats){$.each(ag.data.entcats,function(aj,ai){af.append($("<option></option>").attr("value",ai.entcatid).text(ai.value))})}}});$("#arpmaddentcatattr").foundation("reveal","open")});h.on("click","#addespecattr button",function(ag){var ad=$("#addespecattr").attr("data-jagger-link");var af=aa;var ae=af.find('[name="customvals"]').first();ae.empty();af.find("div.response").first().removeClass("alert").removeClass("alert-box").empty().hide();var ai=af.find("select[name='attrid']");ai.empty().append($("<option></option>").attr("value","0").text(""));var ah=af.find("select[name='spid']");ah.empty().append($("<option></option>").attr("value","0").text(""));$.ajax({url:ad,method:"GET",dataType:"json",success:function(aj){if(aj.members){$.each(aj.members,function(al,ak){ah.append($("<option></option>").attr("value",ak.pid).text(ak.name+" ("+ak.entityid+")"))})}if(aj.attrs){$.each(aj.attrs,function(al,ak){ai.append($("<option></option>").attr("value",ak.attrid).text(ak.name))})}}});af.foundation("reveal","open");ah.select2({width:"100%"});ai.select2({width:"100%"})});$("#arpmaddattr").on("click","div.yes",function(af){var ae=$("#arpmaddattr").find("form").first();var ad=ae.serializeArray();var ag=ae.attr("action");$.ajax({url:ag,method:"POST",dataType:"json",data:ad,success:function(ah){$("#arpmaddattr").foundation("reveal","close");r.find('a[href="#attrpol-1"]').first().trigger("click")},error:function(aj,ah,ai){$("#arpmaddattr").find(".response").html(aj.responseText).addClass("alert").addClass("alert-box").show()}})});$("#arpmeditfedattr").on("click","div.yes",function(af){var ae=$("#arpmeditfedattr").find("form").first();var ad=ae.serializeArray();var ag=ae.attr("action");$.ajax({url:ag,method:"POST",dataType:"json",data:ad,success:function(ah){$("#arpmeditfedattr").foundation("reveal","close");r.find('a[href="#attrpol-2"]').first().trigger("click")},error:function(aj,ah,ai){$("#arpmeditfedattr").find(".response").html(aj.responseText).addClass("alert").addClass("alert-box").show()}})});aa.on("change","select",function(ad){var ae=$(this).attr("name");if(ae===undefined||!(ae==="spid"||ae==="attrid")){console.log("TT")}if(ae==="spid"){console.log("DDDDDDDDDDDD")}});aa.on("click","div.yes",function(ah){var ag=aa;var ad=ag.find(".response").first();ad.empty().removeClass("alert").removeClass("alert-box").hide();var af=ag.find("form").first();var ae=af.serializeArray();var ai=af.attr("action");$.ajax({url:ai,method:"POST",dataType:"json",data:ae,success:function(aj){ad.empty().removeClass("alert").removeClass("alert-box").hide();ag.foundation("reveal","close");r.find('a[href="#attrpol-4"]').first().trigger("click")},error:function(al,aj,ak){ad.html(al.responseText).addClass("alert").addClass("alert-box").show()}})});$("#arpmeditspattr").on("click","div.yes",function(af){var ae=$("#arpmeditspattr").find("form").first();var ad=ae.serializeArray();var ag=ae.attr("action");$.ajax({url:ag,method:"POST",dataType:"json",data:ad,success:function(ah){$("#arpmeditspattr").foundation("reveal","close");r.find('a[href="#attrpol-4"]').first().trigger("click")},error:function(aj,ah,ai){$("#arpmeditspattr").find(".response").html(aj.responseText).addClass("alert").addClass("alert-box").show()}})});$("#arpmeditentcatattr").on("click","div.yes",function(af){var ae=$("#arpmeditentcatattr").find("form").first();var ad=ae.serializeArray();var ag=ae.attr("action");$.ajax({url:ag,method:"POST",dataType:"json",data:ad,success:function(ah){$("#arpmeditentcatattr").foundation("reveal","close");r.find('a[href="#attrpol-3"]').first().trigger("click")},error:function(aj,ah,ai){$("#arpmeditentcatattr").find(".response").html(aj.responseText).addClass("alert").addClass("alert-box").show()}})});$("#arpmaddentcatattr").on("click","div.yes",function(af){var ae=$("#arpmaddentcatattr").find("form").first();var ad=ae.serializeArray();var ag=ae.attr("action");$.ajax({url:ag,method:"POST",dataType:"json",data:ad,success:function(ah){$("#arpmaddentcatattr").foundation("reveal","close");r.find('a[href="#attrpol-3"]').first().trigger("click")},error:function(aj,ah,ai){$("#arpmaddentcatattr").find(".response").html(aj.responseText).addClass("alert").addClass("alert-box").show()}})})}if($("#matrixloader").length>0){var K=$("#policyupdater");var g=K.attr("data-jagger-link");var G=$(K).find("form").first();var J=$("#matrixloader").attr("data-jagger-providerdetails");var Q=$(K).find("span.mrequester").first();var k=$(K).find("span.mattribute").first();var O=$(K).find("div.yes").first();var A=$(K).find("div.attrflow").first();var H=$("#idpmatrixdiv");var P;K.on("click","div.yes",function(ae){ae.preventDefault();var ad=G.attr("action");$.ajax({type:"POST",url:ad,data:G.serializeArray(),success:function(ag){K.foundation("reveal","close");if(!P.hasClass("dis")){var af=$.trim(P.text());if((ag==="2"&&(af==="R"||af==="D"))||(ag==="1"&&af==="R")){P.attr("class","perm")}else{if((ag==="2c"&&(af==="R"||af==="D"))||(ag==="1c"&&af==="R")){P.attr("class","spec")}else{if((ag==="1"&&af==="D")||(ag==="0")){P.attr("class","den")}else{if((ag==="1c"&&af==="D")||(ag==="0c")){P.attr("class","den")}}}}}}})});H.on("click","td",function(af){P=$(this);var ae=$(this).attr("data-jagger-entidlink");if(ae!==undefined){document.location.href=J+"/"+ae;return false}var ag=$(this).attr("data-jagger-spid");var ad=$(this).attr("data-jagger-attrid");if(ag!==undefined&&ad!==undefined){$.ajax({type:"GET",url:g+"/"+ag+"/"+ad,cache:false,dataType:"json",success:function(aj){G.find("select[name='policy']").prop("selected",false).filter('[value=""]').prop("selected",true);G.find("input[name='attribute']").first().val(aj.attributename);G.find("input[name='requester']").first().val(aj.requester);Q.html(aj.requester);k.html(aj.attributename);var ai=$("<tbody></tbody>");var ah='<thead><tr><th colspan="2">Current attribute flow</th></tr></thead>';$.each(aj.details,function(an,am){var ao="<tr><td>"+am.name+"</td><td>"+am.value+"</td/></tr>";ai.append(ao)});var al=$("<table/>").css({"font-size":"smaller"}).addClass("detailsnosort").addClass("small-12").addClass("columns");var ak=$("<div/>");al.append(ah);al.append(ai);ak.append(al);A.html(ak.html());K.foundation("reveal","open")}})}});var N=$("#matrixloader").attr("data-jagger-link");if(typeof N==="undefined"){return false}$.ajax({type:"GET",url:N,cache:false,dataType:"json",success:function(au){I.hide();if(au){var ag=new Date();var aq;var at='<div><span class="den">&nbsp;&nbsp;&nbsp;</span> <span>denied</span></div><div><span class="perm">&nbsp;&nbsp;&nbsp;</span> <span>permitted</span></div><div><span class="dis">&nbsp;&nbsp;&nbsp;</span> <span>not supported</span></div><div><span>R</span> <span>required</span></div><div><span>D</span> <span>desired</span></div>';var al=au.attributes;var af=au.policies;var am=au.total;var ae=au.message;if(am!==undefined&&am===0&&ae!==undefined){var an='<div class="small-12 medium-11 columns small-centered"><div data-alert class="alert-box warning">'+ae+"</div></div>";H.html(an);return false}var ar=0;var aj='<table class="table table-header-rotated" id="idpmatrixresult"><thead><tr>';aj+='<th style="background: white">'+at+"</th>";$.each(al,function(av,aw){aj+='<th class="rotate"><div><span>'+av+"</span></div></th>";ar++});if(ar>52){$("#container").css({"max-width":"100%"})}var ap,ao,ah;aj+="</tr></thead><tbody>";$.each(af,function(aw,av){aj+='<tr><td data-jagger-entidlink="'+av.spid+'" class="searchcol"><span data-tooltip aria-haspopup="true" class="has-tip" data-options="disable_for_touch:true" title="'+aw+'" >'+av.name+'</span><span class="hidden">'+aw+"</span></td>";$.each(al,function(ay,ax){ao=null;if(av.attributes[ay]!==undefined){ah=av.attributes[ay]}else{ah=null}if(av.req[ay]!==undefined){ao=av.req[ay]}if(ao!==null){ap=ao[0].toUpperCase()}else{ap=""}if(ah!==null){if(ah===0){aq="den"}else{if(ah===1){if(av.custom[ay]!==undefined){aq="spec"}else{aq="perm"}}else{aq="dis"}}}else{aq="dis"}aj+='<td data-jagger-spid="'+av.spid+'" data-jagger-attrid="'+ax+'" class="'+aq+'" title="'+ay+'">';aj+=ap+"</td>"})});aj+="</tbody></table>";var ak=new Date();var ad=ak-ag;console.log("time of generating matrix: "+ad);H.html(aj);var ai=new Date();ad=ai-ak;console.log("time of input matrinx into DOM: "+ad);$("#idpmatrixresult").searcher({inputSelector:"#tablesearchinput",textSelector:".searchcol"})}},beforeSend:function(){I.show()},error:function(ag,ad,ae){I.hide();var af='<div class="small-12 medium-11 columns small-centered"><div data-alert class="alert-box error">'+ae+"</div></div>";H.html(af);return false}})}if($("#fedarptab").length>0){var m=$("#fedarptab").find("table").first();var i=$("#fedpolicyupdater");var n=$("#fedpolicyupdater").find("form").first();var E=i.find("input[name='attribute']").first();var f=i.find("input[name='fedid']").first();var l=i.find("select[name='policy']").first();var j=i.attr("data-jagger-link");var u=i.find("span.dynamicval").first();var V;m.on("click","a",function(ah){ah.preventDefault();var ae=$(this).closest("tr");V=ae.find("span.dynstate").first();var ad=$(this).attr("data-jagger-attrid");var ag=$(this).attr("data-jagger-attrname");var af=$(this).attr("data-jagger-fedid");E.val(ad);f.val(af);$.ajax({type:"GET",url:j+"/"+af+"/"+ad,cache:false,dataType:"json",success:function(ai){l.find("option:selected").prop("selected",false);l.find("option[value="+ai.policy+"]").prop("selected",true);u.html(ag);i.foundation("reveal","open")},error:function(){alert("error")}})});i.on("click",".yes",function(af){af.preventDefault();var ad=n.attr("action");var ae=n.serializeArray();$.ajax({type:"POST",url:ad,data:ae,dataType:"json",success:function(ag){s.foundation("reveal","close");V.html(ag.policystr)}})})}if($("#defaultarptab").length>0){var b=$("#defaultarptab");var s=$("#globalpolicyupdater");var x=$("#globalpolicyupdater").find("form").first();var o=$("#adddefaultpolicy");var z=s.find("input[name='attribute']").first();var C=s.find("select[name='policy']").first();var t=s.attr("data-jagger-link");var p=s.find("span.dynamicval").first();b.on("click","a",function(af){af.preventDefault();var ad=$(this).attr("data-jagger-attrid");var ae=$(this).attr("data-jagger-attrname");z.val(ad);$.ajax({type:"GET",url:t+"/"+ad,cache:false,success:function(ag){C.find("option:selected").prop("selected",false);C.find("option[value="+ag+"]").prop("selected",true);p.html(ae);s.foundation("reveal","open")},error:function(){alert("error")}})});s.on("click",".yes",function(af){af.preventDefault();var ad=x.attr("action");var ae=x.serializeArray();$.ajax({type:"POST",url:ad,data:ae,dataType:"json",success:function(ag){s.foundation("reveal","close");location.reload()}})});o.on("click","button",function(af){af.preventDefault();var ad=o.attr("action");var ae=o.serializeArray();$.ajax({type:"POST",url:ad,data:ae,dataType:"json",success:function(ag){s.foundation("reveal","close");location.reload()}})})}var v=$("#showhelps");if(v.length){if(v.hasClass("helpactive")){$(".dhelp").show()}else{$(".dhelp").hide()}}var B=$("#fedlogin").first();var F=B.attr("href");var d=new Date();var ac=-d.getTimezoneOffset();B.attr("href",""+F+"/"+ac+"");if($("#fedcategories dd.active").length){var c=$("dd.active").find("a").first().attr("href");var R=$("table.fedistpercat");var Y;$.ajax({url:c,timeout:2500,cache:true,dataType:"json",value:$("table.fedistpercat"),success:function(ad){I.hide();if(!ad){window.alert("no data in federation category")}else{$("table.fedistpercat tbody tr").remove();$.each(ad,function(ag,af){var ae="<tr><td>"+af.name+"</td><td>"+af.urn+"</td><td>"+af.labels+"</td><td>"+af.desc+"</td><td>"+af.members+"</td></tr>";R.append(ae)})}}})}$(".fedcategory").on("click","",function(ae){$("dd").removeClass("active");$(this).closest("dd").addClass("active");var ad=$(this).attr("href");var ag=$("table.fedistpercat");var af;$.ajax({url:ad,timeout:2500,cache:true,dataType:"json",value:ag,success:function(ah){I.hide();if(!ah){window.alert("no data in federation category")}else{$("table.fedistpercat tbody tr").remove();$.each(ah,function(ak,aj){var ai="<tr><td>"+aj.name+"</td><td>"+aj.urn+"</td><td>"+aj.labels+"</td><td>"+aj.desc+"</td><td>"+aj.members+"</td></tr>";ag.append(ai)})}},beforeSend:function(){I.show()},error:function(){I.hide();window.alert("problem with loading data")}}).done(function(){var ah=ag.html()});return false});$(".userlogout").on("click",function(ag){var ah=$("[name='baseurl']").val();var af=$(this).attr("jagger-data-logout");var ae=$(this).attr("href");var ad=ah;if(ah===null){ad=ae}if(af!==null&&af!==""){$.ajax({type:"GET",url:af,cache:false,})}$.ajax({type:"GET",url:ae,cache:false,success:function(){window.location.href=ad}});return false})});$(function(){$("div.floating-menu").addClass("mobilehidden");$("table.idplist tr td:first-child").addClass("homeorg");$("table.idplist tr td:first-child span.alert").removeClass("alert").parent().addClass("alert");var b=$("table.filterlist");b.find("tbody > tr").find("td:eq(1)").mousedown(function(){});$("#filter").keyup(function(){$.uiTableFilter(b,this.value)});$("#filter-form").submit(function(){b.find("tbody > tr:visible > td:eq(1)").mousedown();return false}).focus();$("table.splist tr td:first-child span.alert").removeClass("alert").parent().addClass("alert");var a=$("table.splist");a.find("tbody > tr").find("td:eq(1)").mousedown(function(){});$("#filter").keyup(function(){$.uiTableFilter(a,this.value)});$("#filter-form").submit(function(){a.find("tbody > tr:visible > td:eq(1)").mousedown();return false}).focus();$(".datepicker").datepicker({dateFormat:"yy-mm-dd"});var c=$("[name='baseurl']").val();if(c===undefined){c=""}$("#responsecontainer").load(c+"reports/awaiting/ajaxrefresh");setInterval(function(){$("#responsecontainer").load(c+"reports/awaiting/ajaxrefresh")},172000);$("#dashresponsecontainer").load(c+"reports/awaiting/dashajaxrefresh");setInterval(function(){$("#dashresponsecontainer").load(c+"reports/awaiting/dashajaxrefresh")},172000);$.ajaxSetup({cache:false});$("#qcounter").load(c+"reports/awaiting/counterqueue");setInterval(function(){$("#qcounter").load(c+"reports/awaiting/counterqueue")},86000);$("#languageset").on("change","select",function(g){var f=$("div#languageset form").attr("action");var d=f+this.value;$.ajax({url:d,timeout:2500,cache:false}).done(function(){$("#languageset").foundation("reveal","close");setTimeout(function(){go_to_private_page()},1000)});return false});$("select.nuseraccesstype").on("change",function(){var d=$(this).find("option:selected");var e=d.val();if(e==="fed"){$("div.passwordrow").hide()}else{$("div.passwordrow").show()}});$("button#idpadduiiprvurl").click(function(){var d=$("span.idpuiiprvurladd option:selected").val();var e=$("span.idpuiiprvurladd option:selected").text();$("span.idpuiiprvurladd option[value="+d+"]").remove();$(this).parent().prepend('<li class="localized"><label for="f[[uii][idpsso][prvurl]['+d+']">'+e+'</label><input id="f[uii][idpsso][prvurl]['+d+']" name="f[uii][idpsso][prvurl]['+d+']" type="text"/></li>')});$("button#spadduiiprvurl").click(function(){var d=$("span.spuiiprvurladd option:selected").val();var e=$("span.spuiiprvurladd option:selected").text();$("span.spuiiprvurladd option[value="+d+"]").remove();$(this).parent().prepend('<li class="localized"><label for="f[[uii][spsso][prvurl]['+d+']">'+e+'</label><input id="f[uii][spsso][prvurl]['+d+']" name="f[uii][spsso][prvurl]['+d+']" type="text"/></li>')});$("button#addlprivacyurl").click(function(){var d=$("li.addlprivacyurl option:selected").val();var e=$("li.addlprivacyurl option:selected").text();$("li.addlprivacyurl option[value="+d+"]").toggleOption(false);$(this).parent().append('<li class="localized"><label for="lprivacyurl['+d+']">'+e+'</label><input id="lprivacyurl['+d+']" name="lprivacyurl['+d+']" type="text"/></li>')});$("a#fedmetasigner").click(function(){var e=$(this),d=e.attr("href");$.ajax({url:d,timeout:2500,cache:false,success:function(f){alert(f)}});return false});$("a#providermetasigner").click(function(){var e=$(this),d=e.attr("href");$.ajax({url:d,timeout:2500,cache:false,success:function(f){window.alert(f)}});return false});$("a.downloadstat").click(function(){var e=$(this),d=e.attr("href");var f;$.ajax({url:d,timeout:2500,cache:false,dataType:"json",success:function(g){if(!g){window.alert("no data")}else{window.alert(g.status)}}});return false});$("a.lateststat").click(function(){var f=$(this),d=f.attr("href");var g=$('<div id="#statisticdiag">');var e;$.ajax({url:d,timeout:2500,cache:true,dataType:"json",success:function(h){e=null;$("#spinner").hide();if(!h){window.alert("no data")}else{$("div#statisticdiag").replaceWith('<div id="statisticdiag"></div>');$.each(h,function(k,j){k=new Image();k.src=j.url;$("#statisticdiag").append('<div style="text-align:center; font-weight: bold; width: 90%;">'+j.title+"</div>").append('<div style="font-weight: bolder; width: 90%; text-align: right;">'+j.subtitle+"</div>").append(k)})}},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();window.alert("problem with loading data")}});return false});$("a.clearcache").click(function(){var e=$(this),d=e.attr("href");$.ajax({type:"GET",url:d,timeout:2500,cache:false,success:$(this).remove()});return false});$(".updatebookmark").on("click",function(i){var f=$(this).attr("href");var d=$(this);var g=$(this).attr("data-jagger-bookmark");var h=$(this).closest("[data-jagger-onsuccess]");var j=h.attr("data-jagger-onsuccess");if(f===undefined||g===undefined){return false}$.ajax({url:f+"/"+g,type:"GET",success:function(e){if(e&&e==="ok"){if(j!==undefined&&j==="hide"){h.hide()}else{d.remove()}}}});return false});$("a#synchsettings").click(function(){var e=$(this),d=e.attr("href");var f=$("<ul/>");$.ajax({url:d,timeout:2500,cache:false,success:function(g){$("#spinner").hide();var i=$.parseJSON(g);if(!i){window.alert("no data")}else{var h=$("<ul/>");$.each(i,function(k,j){var l="<li>"+j.result+"</li>";h.append(l)});f.append(h)}},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();window.alert("problem with loading data")}}).done(function(){var g=f.html();$("div#syncresult").replaceWith(g)});return false});$("table.reqattraddform").addClass("hidden");$("button.hideform").addClass("hidden");$("form.reqattraddform").addClass("hidden");$("button.showform").click(function(){$("table.reqattraddform").removeClass("hidden");$("form.reqattraddform").removeClass("hidden");$("button.showform").addClass("hidden");$("button.hideform").removeClass("hidden")});$("button.hideform").click(function(){$("table.reqattraddform").addClass("hidden");$("form.reqattraddform").addClass("hidden");$("button.showform").removeClass("hidden");$("button.hideform").addClass("hidden")});$("#sortable").sortable();$("div.nsortable").sortable();$("#sortable").disableSelection();$(".accordionButton1").click(function(){$(".accordionButton1").removeClass("on");$(".accordionButton1").addClass("off");$(".accordionContent1").slideUp("fast");if($(this).next().is(":hidden")===true){$(this).addClass("on");$(this).removeClass("off");$(this).next().slideDown("fast")}});$(".accordionButton1").mouseover(function(){$(this).addClass("over")}).mouseout(function(){$(this).removeClass("over")})});var ww=document.body.clientWidth;$(document).ready(function(){$(".nav li a").each(function(){if($(this).next().length>0){$(this).addClass("parent")}});$(".toggleMenu").click(function(a){a.preventDefault();$(this).toggleClass("active");$(".nav").toggle()})});$(document).on("click","a.refreshurl",function(f){f.preventDefault();var b=$(this).attr("data-jagger-getmoreajaxonclick");var d=$(this).attr("data-jagger-response-msg");var c=$(this);if(d===undefined||d===null){console.log('attribute data-jagger-response-msg not found in element with data-jagger-getmoreajax="'+b+'" - exiting');return false}else{console.log('attribute data-jagger-response-msg="'+d+'" in element data-jagger-getmoreajax="'+b+'"')}var a=$("div#"+d);if(a===undefined||a===null||$(a).length===0){console.log('div with id="'+d+'" not found');return false}else{console.log('div with id="'+d+'" found')}$.ajax({dataType:"json",type:"GET",url:b,cache:true,success:function(h){if(!h){console.log("no json got from "+b);return false}var g=h.length;if(g<1){return false}var e=$("<div/>");$.each(h,function(k,j){e.append("<div>"+j.msg+"</div>")});a.empty().append(c).append(e).show()}})});$(window).bind("resize orientationchange",function(){ww=document.body.clientWidth;adjustMenu()});var adjustMenu=function(){if(ww<768){$(".toggleMenu").css("display","inline-block");if(!$(".toggleMenu").hasClass("active")){$(".nav").hide()}else{$(".nav").show()}$(".nav li").unbind("mouseenter mouseleave");$(".nav li a.parent").unbind("click").bind("click",function(a){a.preventDefault();$(this).parent("li").toggleClass("hover")})}else{if(ww>=768){$(".toggleMenu").css("display","none");$(".nav").show();$(".nav li").removeClass("hover");$(".nav li a").unbind("click");$(".nav li").unbind("mouseenter mouseleave").bind("mouseenter mouseleave",function(){$(this).toggleClass("hover")})}}};$(function(){$("#details").tablesorter({sortList:[[0,0]],widgets:["zebra"]});$(".userlist#details").tablesorter({sortList:[[3,1],[0,0]],widgets:["zebra"]});$("#options").tablesorter({sortList:[[0,0]],headers:{3:{sorter:false},4:{sorter:false}}});$("#logotabs").tabs({load:function(a,b){$("#availablelogos").unbind();$("#assignedlogos").unbind();$("#uploadlogo").unbind();$("table#details").unbind();GINIT.initialize()}})});if($("#usepredefined").attr("checked")){$("fieldset#stadefext").hide()}$("#usepredefined").click(function(){if($(this).is(":checked")){$("#usepredefined").not(this).removeAttr("checked");$("fieldset#stadefext").hide()}else{$("fieldset#stadefext").show();$("#usepredefined").not(this).addAttr("checked")}});$("#nattrreqbtn").click(function(g){g.preventDefault();var f="";var b="abcdefghijklmnopqrstuvwxyz0123456789";for(var d=0;d<5;d++){f+=b.charAt(Math.floor(Math.random()*b.length))}var c=$('select[name="nattrreq"]');var h=c.find(":selected").text();var e=c.find(":selected").val();var a="<fieldset><legend>"+h+'</legend><div class="small-12 columns"><div class="medium-3 columns medium-text-right"><select name="f[reqattr]['+f+'][status]"><option value="required">required</option><option value="desired">desired</option></select><input type="hidden" name="f[reqattr]['+f+'][attrname]" value="'+h+'"><input type="hidden" name="f[reqattr]['+f+'][attrid]" value="'+e+'"></div><div class="medium-6 collumns end"><textarea name="f[reqattr]['+f+'][reason]"></textarea></div></div></fieldset>';$(this).parent().parent().before(a)});$(".pCookieAccept").on("click",function(){var a=$(this).attr("href");$.ajax({url:a,timeout:2500});$("#cookiesinfo").hide();return false});$("[id='f[entityid]']").change(function(){if($(this).hasClass("alertonchange")){var a=$("#entitychangealert").text();window.alert(a)}});$(document).ready(function(){var d=$("[name='baseurl']").val();if(d===undefined){d=""}var c=new Image(16,16);c.src=d+"images/spinner.gif";var b=new Image(220,19);b.src=d+"images/ajax-loader.gif";if($("#eds2").is("*")){$("#idpSelect").modal({Height:"500px",minHeight:"500px"})}$("#vormversion").click(function(){$.ajax({cache:false,type:"GET",url:d+"smanage/reports/vormversion",success:function(e){$("#spinner").hide();$("#rvormversion").show();$("tr#rvormversion td:first-child").html(e)},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();window.alert("Error occurred")}});return false});$("#vschema").click(function(){$.ajax({cache:false,type:"GET",url:d+"smanage/reports/vschema",success:function(e){$("#spinner").hide();$("#rvschema").show();$("tr#rvschema td:first-child").html(e)},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();window.alert("Error ocured")}});return false});$("#vschemadb").click(function(){$.ajax({cache:false,type:"GET",url:d+"smanage/reports/vschemadb",success:function(e){$("#spinner").hide();$("#rvschemadb").show();$("tr#rvschemadb td:first-child").html(e)},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();window.alert("Error ocured")}});return false});$("#vmigrate").click(function(){$.ajax({cache:false,type:"GET",url:d+"smanage/reports/vmigrate",success:function(e){$("#spinner").hide();$("#rvmigrate").show();$("tr#rvmigrate td:first-child").html(e)},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();window.alert("Error ocured")}});return false});$('button[name="fedstatus"]').click(function(l){var j=$(this).attr("value");var g=$(this).attr("title");if(g===undefined){g=""}var m=$("[name='csrfname']").val();var f=$("[name='csrfhash']").val();var i=$("[name='baseurl']").val();var k=$("span#fednameencoded").text();var e=i+"federations/fedactions/changestatus";var h=[{name:"status",value:j},{name:m,value:f},{name:"fedname",value:k}];a(""+g+"",function(n){$.ajax({type:"POST",url:e,data:h,success:function(o){if(o){if(o==="deactivated"){$('button[value="disablefed"]').hide();$('button[value="enablefed"]').show();$('button[value="delfed"]').show();$("td.fedstatusinactive").show();$("show.fedstatusinactive").show()}else{if(o==="activated"){$('button[value="disablefed"]').show();$('button[value="enablefed"]').hide();$('button[value="delfed"]').hide();$("td.fedstatusinactive").hide();$("span.fedstatusinactive").hide()}else{if(o==="todelete"){$('button[value="disablefed"]').hide();$('button[value="enablefed"]').hide();$('button[value="delfed"]').hide()}}}}},error:function(o){window.alert("Error  ocurred")}})})});$("#rmstatdef").on("click","button",function(g){var e=$("form#rmstatdef").attr("action");var f=$("#rmstatdef").serialize();a("",function(h){$.ajax({type:"POST",url:e,data:f,success:function(i){revealAlert($("#resultdialog .message").html(),"ok")},error:function(i){window.alert("Error")}})});g.preventDefault()});$("#rmfedcategory").click(function(h){var g=$(this).closest("form");var e=g.attr("action");var f=$(this).serialize();a("",function(i){$("<input>").attr({type:"hidden",id:"formsubmit",name:"formsubmit",value:"remove"}).appendTo("form");g.submit()});h.preventDefault()});$("#rmfedvalidator").click(function(h){var g=$(this).closest("form");var e=g.attr("action");var f=$(this).serialize();a("",function(i){$("<input>").attr({type:"hidden",id:"formsubmit",name:"formsubmit",value:"remove"}).appendTo("form");g.submit()});h.preventDefault()});$(document).on("submit","#notificationaddform",function(h){h.preventDefault();var f=$(this);var g=f.serializeArray();$.ajax({type:"POST",url:f.attr("action"),data:f.serializeArray(),success:function(e){$(".message").html(e);if(e==="OK"){$("#notificationaddmodal").foundation("reveal","close");location.reload()}},error:function(e,j,i){window.alert("Error occured: "+i)}})});$(document).on("open.fndtn.reveal","#notificationaddmodal",function(){var e=$(this);$("select#sfederation").parent().hide();$("select#sprovider").parent().hide();$("select#type").change(function(){$("select#sfederation").parent().hide();$("select#sprovider").parent().hide();var j=$(this).find("option:selected");var f=j.val();var g=j.text();var i=$("#sfederation");var h=$("#sprovider");i.find("option").remove();h.find("option").remove();if(f==="joinfedreq"||f==="fedmemberschanged"||f==="fedmembersmodified"){$.ajax({type:"GET",url:d+"ajax/getfeds",cache:true,success:function(k){$.each(k,function(l,m){$("<option>").val(m.id).text(m.name).appendTo(i)});$("select#sfederation").parent().show()},error:function(k,m,l){$(".message").html(l)}})}else{if(f==="requeststoproviders"||f==="providermodified"){$.ajax({type:"GET",url:d+"ajax/getproviders",cache:false,datatype:"json",success:function(k){$.each(k,function(l,m){$("<option>").val(m.key).text(m.value).appendTo(h)});$("select#sprovider").parent().show()},error:function(k,m,l){$(".message").html(l)}})}}})});function a(f,g){var e=$("#sconfirm");e.find(".message").html(f+"&nbsp;");e.foundation("reveal","open");e.foundation("reflow");e.on("opened.fndtn.reveal",function(j){var i=e.find(".yes").first();var h=e.find(".no").first();i.off().on("click",function(){g.apply();e.foundation("reveal","close")});h.off().on("click",function(){e.foundation("reveal","close")})})}});function go_to_private_page(){window.location.reload()}$(".submit").click(function(){return false});$("#joinfed").on("change","#fedid",function(g){$("div.validaronotice").hide();$("ul.validatorbuttons").replaceWith('<ul class="button-group validatorbuttons"></ul>');var h=$("[name='csrfname']").val();var c=$("[name='csrfhash']").val();if(h===undefined){h=""}if(c===undefined){c=""}var a=$(this).find("option:selected").val();var d=$(this).find("option:selected").text();var f=$("div#retrfvalidatorjson").text();var b={};b[h]=c;b.fedid=a;if(a!==0){$.ajax({type:"POST",url:f,timeout:2500,cache:true,data:b,dataType:"json",success:function(e){$("#spinner").hide();if(e){var i=$("ul.validatorbuttons");$.each(e,function(k,j){i.append('<li><button  value="'+f+"/"+j.fedid+"/"+j.id+'" class="small">'+j.name+"</button></li>")});$("div.validaronotice").show()}},beforeSend:function(){$("#spinner").show()},error:function(){$("#spinner").hide();$("#fvform").hide();$("#fvresult").hide()}}).done(function(){BINIT.initFvalidators()})}});$("#showhelps").click(function(b){b.preventDefault();var a=$(this).attr("href");var c="n";if($("#showhelps").hasClass("helpactive")){c="n"}else{c="y"}$.ajax({type:"GET",url:a+"/"+c,success:function(){$("#showhelps").toggleClass("helpinactive").toggleClass("helpactive").toggleClass("active");$(".dhelp").toggle()}})});$("div.section").parent().addClass("section");$("#notificationupdateform").on("submit",function(h){h.preventDefault();var c=$(this).serializeArray();var a=$(this).attr("action");var b=parseInt($("input[name=noteid]").val());var g=$('button[type="button"][value="'+b+'"]');var d=$(g).closest("tr");var f=d.find("div.subscrstatus:first");$.ajax({type:"POST",url:a,data:c,dataType:"json",success:function(e){if(e){var i=false;$.each(e,function(k,j){if(i===false&&parseInt(j.id)===b){i=true;f.text(j.langstatus)}if(i===false){d.hide()}})}$("#notificationupdatemodal").foundation("reveal","close");location.reload()},error:function(e,j,i){window.alert("Error occured: "+i)}})});$(document).on("submit","div#loginform form",function(f){f.preventDefault();var c=$("#loginform");var a=$(c).find(":submit").first();var j=$(c).find("div.secondfactorrow").first();var h=$("div#loginform form").attr("action");var g=$(this).serializeArray();var b=new Date();var i=-b.getTimezoneOffset();g.push({name:"browsertimeoffset",value:""+i+""});var d=$("[name='baseurl']").val();$.ajax({type:"POST",cache:false,timeout:3500,url:h,data:g,beforeSend:function(){$("#loginresponse").html("").hide()},success:function(e){if(e){if(e.success===true&&e.result==="OK"){$("#loginform").foundation("reveal","close");setTimeout(function(){window.location.href=d},1000)}else{if(e.result==="secondfactor"){$("#password").val("");j.empty();j.append(e.html).show();a.prop("disabled",true)}}}else{$("#loginresponse").html(e).show()}},error:function(e,l,k){$("#loginresponse").html(e.responseText).show()}});return false});$("button.advancedmode").click(function(){var a=$("span.modalnotice").text();var c=$("textarea#metadatabody").val().trim();if(c.length<20){window.alert(a)}var d=$(this);var e=d.val();var f=$("[name='csrfname']").val();var b=$("[name='csrfhash']").val();$(this).closest("form").attr("action",e)});$(".afilter").click(function(){var a=$(this).attr("href");var b;if($(this).hasClass("filterext")){b=1}else{if($(this).hasClass("filterlocal")){b=2}else{b=0}}$("a.initiated").removeClass("initiatied");$.ajax({type:"GET",url:a,timeout:9500,cache:true,dataType:"json",success:function(r){$("#spinner").hide();if(b===1){$("dd.filterext").addClass("active")}else{if(b===2){$("dd.filterlocal").addClass("active")}else{$("dd.filterall").addClass("active")}}if(r){var p=$("<table/>");p.attr("id","details");p.addClass("filterlist");var k=$("<thead/>");p.append(k);var f=$("<tr/>");k.append(f);var q=[];var o=r.columns;var n;var d=0;$.each(o,function(u,t){n=t.status;if(n){var s=[];$.each(t.cols,function(v,w){s.push(w)});q.push(s);f.append("<th>"+t.colname+"</th>")}});var h=$("<tbody/>");p.append(h);var g=r.data;var e=new Date();var l=[];var m=0;$.each(g,function(t,s){if((s.plocal===1&&(b===2||b===0))||(s.plocal===0&&b<2)){l[m++]="<tr>";$.each(q,function(v,w){var u="";$.each(w,function(y,x){if(s[x]!==null){if(x==="pname"){u=u+'<a href="'+r.baseurl+"providers/detail/show/"+s.pid+'">'+s[x]+"</a><br />"}else{if(x==="phelpurl"){u=u+'<a href="'+s.phelpurl+'">'+s.phelpurl+"</a>"}else{if(x==="plocked"||x==="pactive"||x==="plocal"||x==="pstatic"||x==="pvisible"||x==="pavailable"){if(r.statedefs[x][s[x]]!==undefined){u=u+' <span class="lbl lbl-'+x+"-"+s[x]+'">'+r.statedefs[x][s[x]]+"</span>"}}else{u=u+"  "+s[x]}}}}});l[m++]="<td>"+u+"</td>"});d++;l[m++]="</tr>"}});h.append(l.join(""));var j=new Date();var c=j-e;console.log("Providerlist table gen time: "+c);var i=$("div.subtitleprefix").text();$("div.subtitle").empty().append(i+": "+d);$("div#providerslistresult").append(p);if(d>1){p.tablesorter({sortList:[[0,0]]});$("#filter").keyup(function(){$.uiTableFilter(p,this.value)});$("#filter-form").submit(function(){p.find("tbody > tr:visible > td:eq(1)").mousedown();return false}).focus()}}},beforeSend:function(){$("dd.afilter").removeClass("active");$("div#providerslistresult").empty();$("div.alert-box").empty().hide();$("#spinner").show()},error:function(e,c,d){$("#spinner").hide();$("div.subtitle").empty();$("div.alert-box").append(d).show()}});return false});$("a.initiated").trigger("click");$('button[name="mrolebtn"]').click(function(b){var a=$(this).attr("value");$.ajax({type:"GET",url:a,timeout:2500,cache:false,dataType:"json",success:function(c){var d=[];$.each(c,function(f,e){d.push(e)});$("input[name='checkrole[]']").each(function(){var e=$(this).attr("value");var f=$(this).attr("checked");if($.inArray(e,d)===-1){$(this).prop("checked",false)}else{$(this).prop("checked",true)}})}})});$('button[name="update2f"]').click(function(d){d.preventDefault();var c=$(this).parents("form:first");var a=c.find("div.alert-box");var b=c.attr("action");$.ajax({type:"POST",url:b,cache:false,data:c.serializeArray(),dataType:"json",success:function(e){a.hide();if(e){var f="";$.each(e,function(h,g){f=f+g+","});$("span#val2f").empty().append(f.substring(0,f.length-1))}$("#m2f").foundation("reveal","close")},error:function(e,g,f){a.html(f).show()}})});var checkRegpol;$('input[type="radio"].withuncheck').hover(function(){checkRegpol=$(this).is(":checked")});$('input[type="radio"].withuncheck').click(function(){checkRegpol=!checkRegpol;$(this).attr("checked",checkRegpol)});$(document).on("click","#resetloginform",function(a){a.preventDefault();var b=$("[name='baseurl']").val();$.ajax({type:"GET",url:b+"authenticate/resetloginform",cache:false,success:function(c){$(".secondfactorrow").empty();$("#loginform").foundation("reveal","close");return false}})});$(document).on("submit","#duo_form",function(c){c.preventDefault();var a=$(this).attr("action");var b=$(".secondfactorrow");$.ajax({type:"POST",url:a,cache:false,data:$(this).serializeArray(),beforeSend:function(){$("#loginresponse").html("").hide()},success:function(d){if(d){if(d.success===true&&d.result==="OK"){$("#loginform").foundation("reveal","close");setTimeout(function(){go_to_private_page()},1000)}else{if(d.result==="secondfactor"){b.append(d.html).show()}}}else{$("#loginresponse").html(d).show()}},error:function(d,f,e){$("#loginresponse").html(d.responseText).show()}})});$(document).ready(function(){var a=$("a.autoclick");if(a!==undefined){a.click()}});$(".oidclink").on("click",function(d){d.preventDefault();var a=$(this).attr("href");var g=$("[name='csrfname']").val();var b=$("[name='csrfhash']").val();var f=$(this).attr("data-jagger-oidc");var c=[{name:g,value:b},{name:"op",value:f}];$.ajax({type:"POST",url:a,data:c,cache:false,dataType:"json",success:function(e){window.location.href=e.redirect}})});$("#updateprefsmodal").on("submit",function(d){d.preventDefault();var c=$(this).attr("data-jagger-link");var a=$(this).find("div.alert").first();var b=$(this).find("form").first();$.ajax({url:c,type:"POST",cache:false,data:b.serializeArray(),success:function(i){if(i){if(i.result==="OK"){var g=$(document).find('[data-jagger-record="'+i.confname+'"]').first();var h=g.closest("tr");var f=i.type;if(f==="text"){h.find('span[data-jagger-name="vtext"]').first().html(nl2br(i.vtext,false))}var e=h.find('span[data-jagger-name="status"]').first();if(i.status){e.removeClass("alert").html(i.statusstring)}else{e.addClass("alert").html(i.statusstring)}$(document).foundation("reveal","close")}else{if(i.error){a.html(i.error).show()}}}else{a.html("No data").show()}},error:function(e,g,f){a.html(f).show()}})});$(document).on("click","a.updateprefs",function(f){f.preventDefault();var j=$("#updateprefsmodal");var g=$(this).attr("href");if(j===undefined||g===undefined){return false}var c=j.find('span[data-jagger-name="displayname"]').first();var i=j.find('input[name="confname"]').first();var h=j.find('div[data-jagger-name="desc"]').first();var b=j.find('input[name="status"]').first();var d=j.find('textarea[data-jagger-name="vtext"]').first();var a=j.find("div.alert").first();a.html("").hide();if(d===null){window.alert("d")}$.ajax({url:g,type:"GET",cache:false,success:function(k){if(k){c.html('"'+k.displayname+'"');i.val(k.confname);h.html("<b>"+k.displayname+":</b> "+k.desc);var e=k.type;if(e==="text"){d.val(k.vtext);d.closest("div.row").show()}else{d.closest("div.row").hide()}if(k.status===true){b.prop("checked",true)}else{b.prop("checked",false)}}}});j.foundation("reveal","open");return false});$(".select2").select2();$("#itestcombo").select2();